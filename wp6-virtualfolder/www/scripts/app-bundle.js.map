{"version":3,"sources":["app.js","behavior.js","environment.js","main.js","navitem.js","autocomplete/vfAutocompleteSearch.js","dataset/app.js","dataset/environment.js","dataset/main.js","editor/fileeditor.js","filemanager2/app.js","filemanager2/environment.js","filemanager2/fmsettings.js","filemanager2/main.js","filemanager2/panel.js","filepicker/app.js","filepicker/environment.js","filepicker/filepanel.js","filepicker/main.js","filepicker/messages.js","filepicker/pdbpanel.js","filepicker/pdbresource.js","filepicker/uniprotpanel.js","filepicker/uniprotresource.js","pdbcomponents/checkurl.js","pdbcomponents/dataitem.js","pdbcomponents/dataset.js","pdbcomponents/entry-id.js","pdbcomponents/hideable.js","pdbcomponents/pdb-id.js","pdbcomponents/pdb-ids.js","pdbcomponents/sasclient.js","pdbcomponents/viewpanel.js","resources/index.js","tabs/messages.js","tabs/tabs.js","uploaddirpicker/app.js","uploaddirpicker/main.js","uploaddirpicker/uploaddirpanel.js","utils/vfstorage.js","virtualfolderhome/app.js","virtualfolderhome/main.js","virtualfoldermodules/app.js","virtualfoldermodules/ccp4control.js","virtualfoldermodules/main.js","virtualfoldermodules/modulecontrol.js","virtualfoldermodules/modulesetting.js","virtualfoldermodules/scipioncontrol.js","virtualfoldermodules/virtuosocontrol.js","virtualfoldersetting/aliastable.js","virtualfoldersetting/app.js","virtualfoldersetting/clouddeployment.js","virtualfoldersetting/dropboxcontrol.js","virtualfoldersetting/genericcontrol.js","virtualfoldersetting/main.js","virtualfoldersetting/messages.js","virtualfoldersetting/storageprovider.js","virtualfoldersetting/taskcontrol.js"],"names":["App","_singleton","Symbol","RedirectLogin","rurl","window","location","pathname","redirectUrl","handlelogin","ShowLoginButton","loginb","document","getElementById","logoutb","removeAttribute","className","ShowLogoutButton","HandleLogin","contructor","senderid","debug","testing","configure","Promise","config","longStackTraces","warnings","wForgottenReturn","aurelia","use","standardConfiguration","feature","developmentLogging","plugin","start","then","setRoot","Navitem","VfAutocompleteSearch","httpclient","http","resultBoxAlign","redirectOnClick","searchUrl","fields","group","groupLimit","sort","additionalParams","hideSuggestions","showing","blurSuggestions","evt","relatedTarget","startsWith","showSuggestions","focusSuggestions","value","search","term","url","fetch","response","json","resultGroups","data","grouped","category","groups","catch","console","log","err","keypressed","key","keyCode","originalTarget","submit","item","Name","target","clicked","clickvalue","Type","var_name","valueChanged","newValue","oldValue","length","searchMore","filter","fqVal","inject","CodeMirror","Fileeditor","el","ea","client","subscribe","selectFile","msg","file","isimage","filename","attached","editor","querySelector","codemirror","fromTextArea","cmTextarea","lineNumbers","mode","lineWrapping","theme","refresh","that","pid","imageurl","webdavuri","getValue","name","endsWith","credentials","text","setValue","alert","error","Element","dialogService","handler","closeviewer","setupFileManager","open","viewModel","model","wasCancelled","Prompt","controller","answer","settings","centerHorizontalOnly","activate","message","visualizepdb","checkDefault","visualizeimg","close","Storage","ok","method","localStorage","getItem","Panel","selectTab","tabid","selectedView","selectedVisual","selectedDataset","selectedList","bind","ids","selectedTab","paneltabs","id","label","showpdb","publish","opener","postMessage","protocol","hostname","publicwebdavuri","Filepanel","pdbresource","uniprotresource","files","path","lastpath","dynatable","serviceurl","getBaseUrl","withHeader","getpublicwebdavurl","sorted","none","reverse","byname","bydate","bysize","byext","wassorted","baseresources","info","resources","filescount","isPdb","isUniprot","isFiles","selectedResources","panelid","sortByX","sortflag","sortfunction","shift","addUpDir","unshift","nicesize","date","available","sortByName","a","b","sortBySize","size","sortByDate","extension","re","exec","sortByExt","ext","get","populateFiles","statusCode","dateTimeReviver","Date","parseInt","toLocaleDateString","navigator","language","cdup","sepIndex","lastIndexOf","substring","cddown","subdir","cdroot","goroot","changefolder","folder","lock","statusText","dataresponse","JSON","parse","forEach","index","arr","alias","attributes","filetype","nicedate","fileurl","head","mypath2","mypath","signed_url","slice","selectResource","resource","replace","appendResources","push","escape","SelectedFile","VisualizeFile","EditFile","DatasetFile","PopulateResources","Pdbpanel","currentpath","impl","populateResource","Pdbresource","requesturlpdbid","requesturlnums","requesturlfiles","pdbredourl","pdbredosuffixes","myresource","link","callback","push1_9","i","push0_9a_z","prefix","resources2","numFound","responseHeader","params","q","charCodeAt","String","fromCharCode","check0_9a_z","queryurl","docs","pdb_id","title","getlisttodownload","pdbid","Object","keys","key2","downloads","substr","pdbredourlfiles","suffix","Uniprotpanel","Uniprotresource","Checkurl","showit","status","Dataitem","entityids","selectedid","showitem","itemPDBEntry","isPDBEntry","itemUniprotEntry","isUniprotEntry","entryname","molecule_type","entity_id","selectedValueChanged","stemel1","el1","cloneNode","stemel2","el2","newel","parent","parentNode","removeChild","setAttribute","appendChild","angular","bootstrap","hideitem","test","entry","Dataset","addDatasetFile","baseurl","dataseturl","showlist","pdbdataset","pdbdataitem","pdblinkset","submitdisabled2","createnewdataset","getFullYear","getMonth","getDate","datasetlist","unselectdataset","selectdataset","Id","submitdataset","Entries","removedataset","additem","confirm","Url","removeitem","itemtodelete","put","stringify","myitem","post","EntryIdCustomAttribute","element","Hideable","defaulthide","changeshowit","PdbIdCustomAttribute","PdbIdsCustomAttribute","bootstrapped","pdbids","split","pdbidsfilter","obj","pdbidsjson","myclone","elementclone","children","Sasclient","searchParams","Viewpanel","viewfile","sourceurl","sourceformat","pdbentry","pdbredoentry","pdburl","pdblitemol","replacepdblitemol","loadfromredo","loadpdb","pdbviewer","parentnode","insertAdjacentHTML","SelectedTab","Tabs","selectVisualize","selectEdit","tabs","activeid","active","opentab","Uploaddirpanel","selectThisDir","myfile","mydir","Vfstorage","propertyName","defaultvalue","setItem","virtualfolderbaseurl","parseQueryString","str","ret","create","trim","param","parts","val","join","undefined","decodeURIComponent","Array","isArray","islocalhost","webdavurl","requestpublicurl","generateurl","result","port","cookie","match","Ccp4control","posturl","Modulecontrol","href","enabled","okcallback","failcallback","res","enable","Modulesetting","Scipioncontrol","Virtuosocontrol","Aliastable","submitSettings","providers","temporary","removeProvider","delete","Clouddeployment","Dropbox","DropboxControl","accesstoken","hash","access_token","isAuthenticated","CLIENTIDENC","dbx","clientId","map","c","currentUrl","authurl","getAuthenticationUrl","e","initialize","type","securetoken","Genericcontrol","dropboxcontrol","heading","editing","providerspath","filespath","knowtoken","dropboxauthurl","selectedProvider","selectSettings","myHeaders","Headers","append","clear","username","filesystempath","accessurl","headers","addProvider","selectedDropbox","selectedFileSystem","selectedB2Drop","password","selectedWebDav","body","doneCallback","ResponseStatus","ErrorCode","Message","errorCallback","knownSecureToken","checked","SettingsSubmitted","SettingsSelected","SettingsRemoved","Storageprovider","showprovider","newProvider","Taskcontrol","userprocessurl","tasks","descriptions","task","Description","Updating","starttask","task1","updatetask","setTimeout","Running","LocalUrl","reason","stoptask","resolve","reject","updatedtask"],"mappings":";;;;;;;;;;;;;MAAaA,cAAAA,MACX,eAAc;AAAA;AAEb;;;;;;;;;;;;;;;ACEH,MAAIC,aAAaC,QAAjB;;MAEaC,wBAAAA;AAEX,6BAA8D;AAAA,UAAlDC,IAAkD,uEAA3C,iBAAiBC,OAAOC,QAAP,CAAgBC,QAAU;;AAAA;;AAC5D,WAAKC,WAAL,GAAmBJ,IAAnB;AACD;;4BAEDK,qCAAa;AAEXJ,aAAOC,QAAP,GAAkB,KAAKE,WAAvB;AACD;;;;;MAIUE,0BAAAA;AAEX,+BAAc;AAAA;AACb;;8BAEDD,qCAAa;AAEX,UAAIE,SAASC,SAASC,cAAT,CAAwB,aAAxB,CAAb;AACA,UAAIC,UAAUF,SAASC,cAAT,CAAwB,cAAxB,CAAd;;AAEAC,cAAQC,eAAR,CAAwB,OAAxB;AACAJ,aAAOI,eAAP,CAAuB,OAAvB;AACAJ,aAAOK,SAAP,GAAmB,SAAnB;AACAF,cAAQE,SAAR,GAAoB,SAApB;AACD;;;;;MAIUC,2BAAAA;AAEX,gCAAc;AAAA;AACb;;+BAEDR,qCAAa;AAEX,UAAIE,SAASC,SAASC,cAAT,CAAwB,aAAxB,CAAb;AACA,UAAIC,UAAUF,SAASC,cAAT,CAAwB,cAAxB,CAAd;;AAEAC,cAAQC,eAAR,CAAwB,OAAxB;AACAJ,aAAOI,eAAP,CAAuB,OAAvB;AACAJ,aAAOK,SAAP,GAAmB,SAAnB;AACAF,cAAQE,SAAR,GAAoB,SAApB;AACD;;;;;MAKUE,sBAAAA;;;;;0BACXC,iCAAWC,UAAU;AACnB,WAAKA,QAAL,GAAcA,QAAd;AACD;;;;;;;;;;;oBC5DY;AACbC,WAAO,IADM;AAEbC,aAAS;AAFI;;;;;;;;UCUCC,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCjBYC,kBAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCKAC,+BAAAA,+BAgEX,oCAAa,cAAb;AAxDA,kCAAYC,UAAZ,EAAwB;AAAA;;AAAA;;AAAA;;AAAA;;AAAA;;AACtB,WAAKC,IAAL,GAAYD,UAAZ;AACA,WAAKf,MAAL,GAAc;AACZiB,wBAAgB,MADJ;AAEZC,yBAAiB,KAFL;AAGZC,mBAAW,qDAHC;AAIZC,gBAAQ,gCAJI;AAKZC,eAAO,iCALK;AAMZC,oBAAY,IANA;AAOZC,cAAM,mCAPM;AAQZC,0BAAkB;AARN,OAAd;AAUD;;mCAGDC,6CAAkB;AACd,WAAKC,OAAL,GAAa,KAAb;AACH;;mCAGDC,2CAAgBC,KAAK;AACnB,UAAIA,IAAIC,aAAJ,IAAqBD,IAAIC,aAAJ,CAAkBtC,SAAlB,CAA4BuC,UAA5B,CAAuC,kBAAvC,CAAzB,EAAqF;AACrF,WAAKL,eAAL;AACD;;mCAGDM,6CAAkB;AAChB,WAAKL,OAAL,GAAa,IAAb;AACD;;mCAGDM,+CAAmB;AACjB,WAAKC,KAAL,GAAW,EAAX;AACA,WAAKF,eAAL;AACD;;mCAKDG,2BAAQ;AAAA;;AACN,UAAIC,OAAO,KAAKF,KAAhB;AACA,UAAIjC,SAAS,KAAKA,MAAlB;AACA,UAAIoC,MAASpC,OAAOmB,SAAhB,SAA6BnB,OAAOwB,gBAApC,SAAwDxB,OAAOqB,KAA/D,YAA2ErB,OAAOoB,MAAlF,cAAiGpB,OAAOuB,IAAxG,qBAA4HvB,OAAOsB,UAAnI,iBAAyJa,IAAzJ,SAAJ;AACA,aAAO,KAAKnB,IAAL,CACJqB,KADI,CACED,GADF,EAEJzB,IAFI,CAEC;AAAA,eAAY2B,SAASC,IAAT,EAAZ;AAAA,OAFD,EAGJ5B,IAHI,CAGC,gBAAQ;AAGZ,cAAK6B,YAAL,GAAmBC,KAAKC,OAAL,CAAaC,QAAb,CAAsBC,MAAzC;AAED,OARI,EASJC,KATI,CASG,eAAO;AAACC,gBAAQC,GAAR,CAAY,gBAAZ,EAA8BD,QAAQC,GAAR,CAAYC,GAAZ;AAAiB,OAT1D,CAAP;AAUD;;mCAYFC,iCAAWrB,KAAI;AACb,UAAIsB,MAAMtB,IAAIuB,OAAd;AACA,UAAID,QAAQ,EAAZ,EAAgB;AAKd,YAAItB,IAAIwB,cAAR,EAAwB,KAAKC,MAAL,CAAY,EAACC,MAAM,EAACC,MAAK3B,IAAIwB,cAAJ,CAAmBnB,KAAzB,EAAP,EAAZ,EAAxB,KACK,IAAIL,IAAI4B,MAAR,EAAgB,KAAKH,MAAL,CAAY,EAACC,MAAM,EAACC,MAAK3B,IAAI4B,MAAJ,CAAWvB,KAAjB,EAAP,EAAZ;AACrB,aAAKR,eAAL;AACD,OARD,MASE,IAAIyB,QAAM,EAAV,EAAc,KAAKzB,eAAL,GAAd,KAEA,KAAKM,eAAL;;AAEF,aAAO,IAAP;AACD;;mCAMA0B,2BAAQC,YAAY;AAGlB,WAAKzB,KAAL,GAAayB,WAAWzB,KAAxB;AACA,WAAKoB,MAAL,CAAY,EAACC,MAAK,EAACC,MAAKG,WAAWzB,KAAjB,EAAuB0B,MAAKD,WAAWE,QAAvC,EAAN,EAAZ;AACA,WAAKnC,eAAL;AACD;;mCAKDoC,qCAAaC,UAASC,UAAS;AAC7B,UAAI,KAAK9B,KAAL,IAAc,KAAKA,KAAL,CAAW+B,MAAX,GAAkB,CAApC,EAAuC;AACrC,aAAK9B,MAAL;AAED;AACF;;mCAMD+B,iCAAWC,QAAQ;AAAA;;AACjB,UAAI/B,OAAO,KAAKF,KAAhB;AACE,UAAIkC,QAAQD,MAAZ;AACE,UAAIlE,SAAO,KAAKA,MAAhB;AACJ,UAAIoC,MAASpC,OAAOmB,SAAhB,SAA6BnB,OAAOwB,gBAApC,SAAwDxB,OAAOqB,KAA/D,YAA2ErB,OAAOoB,MAAlF,cAAiGpB,OAAOuB,IAAxG,gCAAuIY,IAAvI,yBAA+JgC,KAAnK;AACA,aAAO,KAAKnD,IAAL,CAEJqB,KAFI,CAEED,GAFF,EAGJzB,IAHI,CAGC;AAAA,eAAY2B,SAASC,IAAT,EAAZ;AAAA,OAHD,EAIJ5B,IAJI,CAIC,gBAAQ;AACZ,eAAK6B,YAAL,GAAmBC,KAAKC,OAAL,CAAaC,QAAb,CAAsBC,MAAzC;AACD,OANI,EAOJC,KAPI,CAOG,eAAO;AAACC,gBAAQC,GAAR,CAAY,oBAAZ,EAAmCD,QAAQC,GAAR,CAAYC,GAAZ;AAAkB,OAPhE,CAAP;AAQD;;;;0BAjEsB;AACtB,eAAO,KAAKtB,OAAL,IAAgB,KAAKc,YAArB,IAAqC,KAAKA,YAAL,CAAkBwB,MAAlB,IAA4B,CAAxE;AACD;;;;eA7DOI,SAAS;;;aALE;;;;;aACM;;;;;aACP;;;;;;;;;;;;;;;;;;;;MCXN7F,cAAAA,MAEX,eAAe;AAAA;AACd;;;;;;;;oBCPY;AACbqB,WAAO,KADM;AAEbC,aAAS;AAFI;;;;;;;;UCUCC,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;MCpBWyD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MAcCC,qBAAAA;AAIX,wBAAYC,EAAZ,EAAeC,EAAf,EAAkBzD,UAAlB,EAA8B;AAAA;;AAAA;;AAAA;;AAC5B,WAAKwD,EAAL,GAAUA,EAAV;AACA,WAAKC,EAAL,GAAUA,EAAV;AACA,WAAKC,MAAL,GAAc1D,UAAd;AACA,WAAKyD,EAAL,CAAQE,SAAR,qBAA4B;AAAA,eAAO,MAAKC,UAAL,CAAgBC,IAAIC,IAApB,EAAyBD,IAAIjF,QAA7B,CAAP;AAAA,OAA5B;AACA,WAAKmF,OAAL,GAAa,KAAb;AACA,WAAKC,QAAL,GAAc,EAAd;AACD;;yBAEDC,+BAAW;AACT,UAAIC,SAAS,KAAKV,EAAL,CAAQW,aAAR,CAAsB,aAAtB,CAAb;;AAEA,UAAID,UAAQ,IAAZ,EAAqB,KAAKE,UAAL,GAAkBd,WAAWe,YAAX,CAAwB,KAAKC,UAA7B,EAAyC;AAC9EC,qBAAa,IADiE;AAE9EC,cAAM,aAFwE;AAG9EC,sBAAc,IAHgE;AAI9EC,eAAO;AAJuE,OAAzC,CAAlB;AAMrB,WAAKN,UAAL,CAAgBO,OAAhB;AACD;;yBAEDf,iCAAWE,MAAKlF,UAAU;AACxB,UAAIgG,OAAM,IAAV;AACA,UAAIhG,YAAU,KAAKiG,GAAnB,EAAwB;AACtB,aAAKC,QAAL,GAAgBhB,KAAKiB,SAArB;;AAKA,aAAKhB,OAAL,GAAgB,qBAAUiB,QAAV,CAAmB,cAAnB,KAAsC,MAAvC,KACblB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CAAD,IACApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CADA,IAEApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CAFA,IAGApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CAHA,IAIApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CAJA,IAKApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CALA,IAMApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CANA,IAOApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CAPA,IAQApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CARA,IASApB,KAAKmB,IAAL,CAAUC,QAAV,CAAmB,MAAnB,CAVc,CAAf;;AAcA,YAAI,CAAC,KAAKnB,OAAV,EACE,KAAKL,MAAL,CAAYpC,KAAZ,CAAkBwC,KAAKiB,SAAvB,EAAkC,EAACI,aAAa,aAAd,EAAlC,EACGvF,IADH,CACQ;AAAA,iBAAY2B,SAAS6D,IAAT,EAAZ;AAAA,SADR,EAEGxF,IAFH,CAEQ,gBAAO;;AAEXmC,kBAAQC,GAAR,CAAY,qCAAqC8B,KAAKiB,SAAtD;AACAhD,kBAAQC,GAAR,CAAYN,IAAZ;AACAkD,eAAKR,UAAL,CAAgBiB,QAAhB,CAAyB3D,IAAzB;AACAkD,eAAKZ,QAAL,GAAcF,KAAKiB,SAAnB;AACD,SARH,EASEjD,KATF,CASQ,iBAAS;AACfwD,gBAAM,mCAAmCxB,KAAKiB,SAA9C;AACAhD,kBAAQC,GAAR,CAAYuD,KAAZ;AACD,SAZD;AAcH;AACF;;;eA9DMlC,SAAS,CAACmC,OAAD;;;;;;;;;;;;;;;;;;;;;MCRLhI,cAAAA;AAGX,iBAAYiG,EAAZ,EAAegC,aAAf,EAA8B;AAAA;;AAAA;;AAC5B,WAAKhC,EAAL,GAAUA,EAAV;AACA,WAAKiC,OAAL,GAAe,+BAAf;AACA,WAAKjC,EAAL,CAAQE,SAAR,yBAAgC;AAAA,eAAO,MAAKC,UAAL,CAAgBC,IAAIC,IAApB,EAAyBD,IAAIjF,QAA7B,CAAP;AAAA,OAAhC;AACA,WAAK6E,EAAL,CAAQE,SAAR,wBAA+B;AAAA,eAAO,MAAK+B,OAAL,CAAazH,WAAb,EAAP;AAAA,OAA/B;AACA,WAAKwH,aAAL,GAAmBA,aAAnB;AACD;;kBAED7B,iCAAWE,MAAKlF,UAAS,CAMxB;;kBAED+G,qCAAa,CACZ;;kBAEDC,+CAAkB;AAChB,WAAKH,aAAL,CAAmBI,IAAnB,CAAwB,EAACC,6BAAD,EAAoBC,OAAO,uBAA3B,EAAxB,EAA8EnG,IAA9E,CAAmF,oBAAY;;AAG7F,YAAI,CAAC2B,SAASyE,YAAd,EAA4B,CAE3B,CAFD,MAEO,CAEN;AAEF,OATD;AAUD;;;cAhCM3C,SAAS;;;;;;;;oBCZH;AACbxE,WAAO,IADM;AAEbC,aAAS;AAFI;;;;;;;;;;;;;;;;;;MCSFmH,iBAAAA,iBAFZ;AAIC,oBAAYC,UAAZ,EAAuB;AAAA;;AACrB,WAAKA,UAAL,GAAkBA,UAAlB;AACA,WAAKC,MAAL,GAAc,IAAd;AACAD,iBAAWE,QAAX,CAAoBC,oBAApB,GAA2C,IAA3C;AACD;;qBAEDC,6BAASC,SAAS;;AAEhB,WAAKC,YAAL,GAAoB,qBAAUC,YAAV,CAAuB,cAAvB,EAAsC,MAAtC,KAAiD,MAArE;AACA,WAAKC,YAAL,GAAoB,qBAAUD,YAAV,CAAuB,cAAvB,EAAsC,MAAtC,KAAiD,MAArE;;AAEA,WAAKF,OAAL,GAAeA,OAAf;AACA,WAAKvE,GAAL,CAAS,eAAT;AACD;;qBAED2E,yBAAO;AACL,UAAI,OAAOC,OAAP,KAAoB,WAAxB,EAAqC;AACnC,6BAAUvB,QAAV,CAAmB,cAAnB,EAAkC,KAAKmB,YAAvC;AACA,6BAAUnB,QAAV,CAAmB,cAAnB,EAAkC,KAAKqB,YAAvC;AACD;AACD,WAAK1E,GAAL,CAAS,OAAT;AACA,WAAKkE,UAAL,CAAgBW,EAAhB;AACD;;qBAED7E,mBAAI8E,QAAO;AACT/E,cAAQC,GAAR,CAAY,gBAAc8E,MAAd,GAAqB,gCAAjC;AACA/E,cAAQC,GAAR,CAAY,KAAKwE,YAAjB;AACAzE,cAAQC,GAAR,CAAY+E,aAAaC,OAAb,CAAqB,cAArB,CAAZ;AACAjF,cAAQC,GAAR,CAAY,KAAK0E,YAAjB;AACA3E,cAAQC,GAAR,CAAY+E,aAAaC,OAAb,CAAqB,cAArB,CAAZ;AAED;;;;;;;;;;;UChCajI,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGG,MAFH,CAEU,gBAFV,EAGGF,OAHH,CAGW,WAHX;;AAKA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCjBYoH,gBAAAA;AAIT,mBAAYxD,EAAZ,EAAgB;AAAA;;AAAA;;AAAA;;AACZ,WAAKA,EAAL,GAAUA,EAAV;;AAEA,WAAKA,EAAL,CAAQE,SAAR,yBAAgC;AAAA,eAAO,MAAKC,UAAL,CAAgBC,IAAIC,IAApB,EAAyBD,IAAIjF,QAA7B,CAAP;AAAA,OAAhC;AACA,WAAK6E,EAAL,CAAQE,SAAR,yBAA+B;AAAA,eAAO,MAAKuD,SAAL,CAAerD,IAAIsD,KAAnB,CAAP;AAAA,OAA/B;;AAGA,WAAKC,YAAL,GAAkB,KAAKC,cAAL,GAAoB,KAAKC,eAAL,GAAqB,KAA3D;AACA,WAAKC,YAAL,GAAkB,IAAlB;AACH;;oBAEDC,uBAAM;AACJ,WAAKC,GAAL,GAAS,CAAC,KAAK5C,GAAL,GAAS,OAAV,EAAkB,KAAKA,GAAL,GAAS,OAA3B,EAAmC,KAAKA,GAAL,GAAS,SAA5C,EAAsD,KAAKA,GAAL,GAAS,UAA/D,EAA0E,KAAKA,GAAL,GAAS,UAAnF,CAAT;;AAEA,WAAK6C,WAAL,GAAkB,KAAKD,GAAL,CAAS,CAAT,CAAlB;AACA,WAAKE,SAAL,GAAiB,CACf,EAAEC,IAAI,KAAKH,GAAL,CAAS,CAAT,CAAN,EAAmBI,OAAO,WAA1B,EADe,EAEf,EAAED,IAAI,KAAKH,GAAL,CAAS,CAAT,CAAN,EAAmBI,OAAO,WAA1B,EAFe,EAGf,EAAED,IAAI,KAAKH,GAAL,CAAS,CAAT,CAAN,EAAmBI,OAAO,WAA1B,EAHe,EAIf,EAAED,IAAI,KAAKH,GAAL,CAAS,CAAT,CAAN,EAAmBI,OAAO,SAA1B,EAJe,CAAjB;AAMD;;oBAEDX,+BAAUC,OAAM;AAEZ,UAAIA,MAAMpG,UAAN,CAAiB,KAAK8D,GAAtB,CAAJ,EAAgC;AAC5B,aAAK6C,WAAL,GAAmBP,KAAnB;AACA,aAAKI,YAAL,GAAoB,KAAKG,WAAL,IAAoB,KAAKD,GAAL,CAAS,CAAT,CAAxC;AACA,aAAKL,YAAL,GAAoB,KAAKM,WAAL,IAAoB,KAAKD,GAAL,CAAS,CAAT,CAAxC;AACA,aAAKJ,cAAL,GAAsB,KAAKK,WAAL,IAAoB,KAAKD,GAAL,CAAS,CAAT,CAA1C;AACA,aAAKH,eAAL,GAAuB,KAAKI,WAAL,IAAoB,KAAKD,GAAL,CAAS,CAAT,CAA3C;AACH;AACJ;;oBAED7D,iCAAWE,MAAKlF,UAAU;AAExB,UAAIkJ,UAAWhE,KAAKiB,SAAL,CAAeG,QAAf,CAAwB,KAAxB,KAAkCpB,KAAKiB,SAAL,CAAeG,QAAf,CAAwB,KAAxB,CAAlC,IAAoEpB,KAAKiB,SAAL,CAAeG,QAAf,CAAwB,KAAxB,CAArE,GAAwG,OAAO0B,OAAP,KAAoB,WAArB,GAAoCG,aAAaC,OAAb,CAAqB,cAArB,IAAuCD,aAAaC,OAAb,CAAqB,cAArB,MAAyC,MAAhF,GAAyF,IAA7H,GAAoI,IAA3O,GAAkP,KAAhQ;AACA,UAAIpI,YAAU,KAAKiG,GAAnB,EAAwB;AACtB,YAAI,KAAKyC,eAAT,EAA0B;AACxB,eAAK7D,EAAL,CAAQsE,OAAR,CAAgB,0BAAgBjE,IAAhB,EAAqBlF,QAArB,CAAhB;AACD,SAFD,MAIA,IAAIkJ,OAAJ,EAAa;AAEX,iBAAKZ,SAAL,CAAe,KAAKO,GAAL,CAAS,CAAT,CAAf;AACA,iBAAKhE,EAAL,CAAQsE,OAAR,CAAgB,4BAAkBjE,IAAlB,EAAuBlF,QAAvB,CAAhB;AACD,WAJD,MAIO;AAEL,iBAAKsI,SAAL,CAAe,KAAKO,GAAL,CAAS,CAAT,CAAf;AACA,iBAAKhE,EAAL,CAAQsE,OAAR,CAAgB,uBAAajE,IAAb,EAAkBlF,QAAlB,CAAhB;AACD;AACF;AACF;;;eAvDMyE,SAAS;;;;;;;;;;;;;;;;;;;;;MCJP7F,cAAAA;AAGX,iBAAYiG,EAAZ,EAAgB;AAAA;;AAAA;;AACd,WAAKA,EAAL,GAAUA,EAAV;AACA,WAAKiC,OAAL,GAAe,6BAAf;AACA,WAAKjC,EAAL,CAAQE,SAAR,yBAAgC;AAAA,eAAO,MAAKC,UAAL,CAAgBC,IAAIC,IAApB,CAAP;AAAA,OAAhC;AACA,WAAKL,EAAL,CAAQE,SAAR,wBAA+B;AAAA,eAAO,MAAK+B,OAAL,CAAazH,WAAb,EAAP;AAAA,OAA/B;AACD;;kBAED2F,iCAAWE,MAAK;AACdjG,aAAOmK,MAAP,CAAcC,WAAd,CAA0BpK,OAAOC,QAAP,CAAgBoK,QAAhB,GAAyB,IAAzB,GAA8BrK,OAAOC,QAAP,CAAgBqK,QAA9C,GAAuDrE,KAAKsE,eAAtF,EAAuG,GAAvG;AACAvK,aAAO8I,KAAP;AACD;;;cAZMtD,SAAS;;;;;;;;oBCNH;AACbxE,WAAO,IADM;AAEbC,aAAS;AAFI;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCgBFuJ,oBAAAA;AAIX,uBAAY5E,EAAZ,EAAezD,UAAf,EAA0BsI,WAA1B,EAAsCC,eAAtC,EAAuD;AAAA;;AAAA;;AACjD,WAAK9E,EAAL,GAAUA,EAAV;AACA,WAAKC,MAAL,GAAc1D,UAAd;AACA,WAAKwI,KAAL,GAAa,EAAb;AACA,WAAKC,IAAL,GAAW,EAAX;AACA,WAAKC,QAAL,GAAc,KAAKD,IAAnB;AACA,WAAKE,SAAL,GAAiB,EAAjB;;AAEA,WAAKC,UAAL,GAAkB,qBAAUC,UAAV,KAAwB,wBAA1C;;AAEA,WAAKnF,MAAL,CAAY3E,SAAZ,CAAsB,kBAAQ;AAC1BE,eAAO6J,UAAP,CAAkB,QAAlB,EAA2B,kBAA3B;AACA7J,eAAO6J,UAAP,CAAkB,cAAlB,EAAiC,kBAAjC;AACH,OAHD;;AAKA,WAAKC,kBAAL,GAAwB,gCAAxB;AACA,WAAKC,MAAL,GAAc,EAACC,MAAK,CAAN,EAAQC,SAAQ,CAAhB,EAAkBC,QAAO,CAAzB,EAA2BC,QAAO,CAAlC,EAAoCC,QAAO,CAA3C,EAA6CC,OAAM,EAAnD,EAAd;AACA,WAAKC,SAAL,GAAe,KAAKP,MAAL,CAAYC,IAA3B;AACA,WAAKO,aAAL,GAAmB,CAAC,EAACvE,MAAK,KAAN,EAAYwE,MAAK,qDAAjB,EAAuE7B,IAAG,KAA1E,EAAD,CAAnB;AACA,WAAK8B,SAAL,GAAgB,EAAhB;;AAEA,WAAKC,UAAL,GAAkB,KAAKnB,KAAL,CAAWvF,MAAX,GAAoB,KAAKyG,SAAL,CAAezG,MAArD;AACA,WAAK2G,KAAL,GAAW,KAAKC,SAAL,GAAe,KAA1B;AACA,WAAKvB,WAAL,GAAiBA,WAAjB;AACA,WAAKC,eAAL,GAAqBA,eAArB;AACA,WAAKuB,OAAL,GAAa,IAAb;AACA,WAAKC,iBAAL,GAAuB,EAAvB;AACH;;wBAEDvC,uBAAM;AACJ,WAAKiB,IAAL,GAAY,qBAAUzD,QAAV,CAAmB,cAAc,KAAKgF,OAAtC,EAA8C,EAA9C,CAAZ;AACA,UAAI,KAAKvB,IAAL,IAAW,EAAf,EAAmB,KAAKiB,SAAL,GAAe,KAAKF,aAApB;;AAEnB,WAAKd,QAAL,GAAc,EAAd;AACD;;wBAEDuB,2BAAQC,UAASC,cAAa;AAG5B,UAAI,KAAK1B,IAAL,CAAUxF,MAAV,GAAiB,CAArB,EAAwB;AACtB,aAAKuF,KAAL,CAAW4B,KAAX;AACD;;AAGD,UAAI,EAAE,KAAKb,SAAL,GAAiBW,QAAnB,CAAJ,EAAkC;AAChC,aAAK1B,KAAL,CAAWhI,IAAX,CAAgB2J,YAAhB;AACA,aAAKZ,SAAL,GAAiBW,QAAjB;AACD,OAHD,MAGO;AAEL,YAAI,KAAKX,SAAL,GAAiB,KAAKP,MAAL,CAAYE,OAAjC,EAA0C;AACxC,eAAKV,KAAL,CAAWU,OAAX;AACA,eAAKK,SAAL,GAAiBW,QAAjB;AACD,SAHD,MAGO;AACL,eAAK1B,KAAL,CAAWU,OAAX;AACA,eAAKK,SAAL,GAAiB,KAAKA,SAAL,GAAiB,KAAKP,MAAL,CAAYE,OAA9C;AACD;AACF;AACD,UAAI,KAAKT,IAAL,CAAUxF,MAAV,GAAiB,CAArB,EAAwB;AACtB,aAAKoH,QAAL;AACD;AAGF;;wBAEDA,+BAAU;AACR,WAAK7B,KAAL,CAAW8B,OAAX,CAAmB,EAACrF,MAAM,IAAP,EAAasF,UAAU,QAAvB,EAAgCC,MAAK,EAArC,EAAwCC,WAAU,IAAlD,EAAnB;AACD;;wBAEDC,mCAAY;AACV,WAAKT,OAAL,CAAa,KAAKjB,MAAL,CAAYG,MAAzB,EAAgC,UAASwB,CAAT,EAAWC,CAAX,EAAa;AAAC,eAAOD,EAAE1F,IAAF,GAAO2F,EAAE3F,IAAT,GAAc,CAAd,GAAgB,CAAC,CAAxB;AAA2B,OAAzE;AACD;;wBAED4F,mCAAY;AACV,WAAKZ,OAAL,CAAa,KAAKjB,MAAL,CAAYK,MAAzB,EAAgC,UAASsB,CAAT,EAAWC,CAAX,EAAa;AAAC,eAAOD,EAAEG,IAAF,GAAOF,EAAEE,IAAhB;AAAqB,OAAnE;AACD;;wBACDC,mCAAY;AACV,WAAKd,OAAL,CAAa,KAAKjB,MAAL,CAAYI,MAAzB,EAAgC,UAASuB,CAAT,EAAWC,CAAX,EAAa;AAAC,eAAOD,EAAEH,IAAF,GAAOI,EAAEJ,IAAT,GAAc,CAAd,GAAgB,CAAC,CAAxB;AAA2B,OAAzE;AACD;;wBAEDQ,+BAAUhH,UAAS;AACjB,UAAIiH,KAAK,iBAAT;AACA,aAAOA,GAAGC,IAAH,CAAQlH,QAAR,EAAkB,CAAlB,CAAP;AACD;;wBAEDmH,iCAAW;AACT,WAAKlB,OAAL,CAAa,KAAKjB,MAAL,CAAYM,KAAzB,EAA+B,UAASqB,CAAT,EAAWC,CAAX,EAAa;AAAC,eAAOD,EAAES,GAAF,GAAMR,EAAEQ,GAAR,GAAY,CAAZ,GAAc,CAAC,CAAtB;AAAyB,OAAtE;AACD;;wBAGDnH,+BAAW;AAAA;;AAGP,WAAKP,MAAL,CAAY2H,GAAZ,CAAgB,KAAKzC,UAAL,GAAgB,KAAKH,IAArC,EACK7I,IADL,CACU,gBAAQ;AACV,YAAI8B,KAAKH,QAAT,EAAmB;AACf,gBAAK+J,aAAL,CAAmB5J,KAAKH,QAAxB;AACH;AACJ,OALL,EAKOO,KALP,CAKa,iBAAS;AAEd,YAAIyD,MAAMgG,UAAN,IAAoB,GAAxB,EAA6B;AAG3B,gBAAK9H,EAAL,CAAQsE,OAAR,CAAgB,0BAAgB,MAAKiC,OAArB,CAAhB;AAGD,SAND,MAMO;AAIL,cAAI,MAAKvB,IAAL,IAAa,MAAKA,IAAL,CAAUxF,MAAV,GAAiB,CAAlC,EAAoC;AAClC,kBAAKwF,IAAL,GAAU,EAAV;AACA,kBAAK/E,MAAL,CAAY2H,GAAZ,CAAgB,MAAKzC,UAAL,GAAgB,MAAKH,IAArC,EACG7I,IADH,CACQ,gBAAQ;AACZ,kBAAI8B,KAAKH,QAAT,EAAmB;AACjB,sBAAK+J,aAAL,CAAmB5J,KAAKH,QAAxB;AACD;AACF,aALH,EAKKO,KALL,CAKW,iBAAS;AAClBC,sBAAQC,GAAR,CAAY,gDAA8C,MAAKyG,IAAnD,GAAwD,IAApE;AACA1G,sBAAQC,GAAR,CAAYuD,KAAZ;AACD,aARD;AASC;AACF;AAEN,OA/BL;AAiCH;;wBAGDiG,2CAAgBrJ,KAAKjB,OAAO;AACxB,UAAIyJ,CAAJ;AACA,UAAI,OAAOzJ,KAAP,KAAiB,QAArB,EAA+B;AAC3ByJ,YAAI,wBAAwBO,IAAxB,CAA6BhK,KAA7B,CAAJ;AACA,YAAIyJ,CAAJ,EAAO;AACH,iBAAO,IAAIc,IAAJ,CAASC,SAASf,EAAE,CAAF,CAAT,CAAT,EAAyBgB,kBAAzB,CAA4CC,UAAUC,QAAV,GAAmBD,UAAUC,QAA7B,GAAsC,OAAlF,CAAP;AACH;AACJ;AACD,aAAO3K,KAAP;AACH;;wBAGD4K,uBAAM;AACF,WAAKpD,QAAL,GAAe,KAAKD,IAApB;AACA,UAAIsD,WAAU,KAAKtD,IAAL,CAAUuD,WAAV,CAAsB,GAAtB,CAAd;AACA,WAAKvD,IAAL,GAAY,KAAKA,IAAL,CAAUwD,SAAV,CAAoB,CAApB,EAAsBF,QAAtB,CAAZ;AACF,UAAI,KAAKtD,IAAL,IAAW,EAAf,EAAmB,KAAKiB,SAAL,GAAe,KAAKF,aAApB;AACpB;;wBAGD0C,yBAAOC,QAAQ;AACb,WAAKzD,QAAL,GAAc,KAAKD,IAAnB;AACE,WAAKA,IAAL,IAAW,MAAI0D,MAAf;AACF,WAAKzC,SAAL,GAAe,EAAf;AACD;;wBAED0C,2BAAQ;AACN,WAAK1D,QAAL,GAAe,KAAKD,IAApB;AACA,WAAKA,IAAL,GAAY,EAAZ;AACA,WAAKiB,SAAL,GAAe,KAAKF,aAApB;AACA,WAAKM,OAAL,GAAa,IAAb;AACA,WAAKD,SAAL,GAAe,KAAf;AACA,WAAKD,KAAL,GAAW,KAAX;AACD;;wBAGDyC,2BAAQ;AACN,WAAKC,YAAL,CAAkB,GAAlB;AACD;;wBAIDA,qCAAaC,QAAO;AAAA;;AAChB,UAAI,CAAC,KAAKC,IAAV,EAAgB;AACZ,aAAKA,IAAL,GAAY,IAAZ;AACA,YAAID,MAAJ,EAAY;AACR,cAAIA,UAAU,IAAd,EAAoB,KAAKT,IAAL,GAApB,KACO,IAAIS,UAAU,GAAd,EAAmB,KAAKH,MAAL,GAAnB,KACF,KAAKF,MAAL,CAAYK,MAAZ;AACR;;AAEH,aAAK7I,MAAL,CAAY2H,GAAZ,CAAgB,KAAKzC,UAAL,GAAkB,KAAKH,IAAvC,EACO7I,IADP,CACY,gBAAQ;AACV,cAAI8B,KAAKH,QAAT,EAAmB;AACf,mBAAK+J,aAAL,CAAmB5J,KAAKH,QAAxB;AAEH;AACD,iBAAKiL,IAAL,GAAY,KAAZ;AACH,SAPP,EAOS1K,KAPT,CAOe,iBAAS;AACtB,cAAIyD,MAAMgG,UAAN,IAAoB,GAAxB,EAA6B;AAC3B,mBAAKiB,IAAL,GAAY,KAAZ;AACA,mBAAK/D,IAAL,GAAY,OAAKC,QAAjB;AACA,mBAAKjF,EAAL,CAAQsE,OAAR,CAAgB,0BAAgB,OAAKiC,OAArB,CAAhB;AACD,WAJD,MAIO;AACLjI,oBAAQC,GAAR,CAAY,OAAZ;AACAD,oBAAQC,GAAR,CAAYuD,KAAZ;AACAD,kBAAM,sBAAsBC,MAAMgG,UAA5B,GAAyC,GAAzC,GAA+ChG,MAAMkH,UAArD,GAAkE,uBAAlE,GAA4F,OAAK7D,UAAjG,GAA8G,OAAKH,IAAzH;AACA,mBAAK+D,IAAL,GAAY,KAAZ;AACA,mBAAK/D,IAAL,GAAY,OAAKC,QAAjB;AACD;AACA,SAnBH;AAoBD;AACJ;;wBAGD/D,6BAAU;AACN,WAAK2H,YAAL;AACH;;wBAGDhB,uCAAcoB,cAAa;AAEzB,2BAAUrH,QAAV,CAAmB,cAAc,KAAK2E,OAAtC,EAA8C,KAAKvB,IAAnD;;AAEE,WAAKD,KAAL,GAAamE,KAAKC,KAAL,CAAWF,YAAX,CAAb;AACA,WAAK/C,UAAL,GAAmB,KAAKnB,KAAL,CAAWvF,MAAX,GAAkB,KAAKyG,SAAL,CAAezG,MAApD;AACA,UAAI2B,OAAO,IAAX;AACA,WAAK4D,KAAL,CAAWqE,OAAX,CAAoB,UAAUtK,IAAV,EAAeuK,KAAf,EAAqBC,GAArB,EAAyB;AAC3C,YAAG,CAACA,IAAID,KAAJ,EAAW7H,IAAZ,IAAoB8H,IAAID,KAAJ,EAAWE,KAAlC,EAAyC;AACvCD,cAAID,KAAJ,EAAW7H,IAAX,GAAgB8H,IAAID,KAAJ,EAAWE,KAA3B;AACAD,cAAID,KAAJ,EAAWG,UAAX,GAAwB,EAAxB;AACAF,cAAID,KAAJ,EAAWtC,IAAX,GAAgB,EAAhB;AACAuC,cAAID,KAAJ,EAAWI,QAAX,GAAoB,CAApB;AACD;;AAEDH,YAAID,KAAJ,EAAW1B,GAAX,GAAexG,KAAKoG,SAAL,CAAe+B,IAAID,KAAJ,EAAW7H,IAA1B,CAAf;AACA8H,YAAID,KAAJ,EAAWK,QAAX,GAAoBvI,KAAK4G,eAAL,CAAqB,IAArB,EAA0BuB,IAAID,KAAJ,EAAWtC,IAArC,CAApB;AACA,YAAI,CAACuC,IAAID,KAAJ,EAAW1B,GAAhB,EAAqB2B,IAAID,KAAJ,EAAW1B,GAAX,GAAe,EAAf;AACrB2B,YAAID,KAAJ,EAAWrC,SAAX,GAAuB,CAAC,EAAEsC,IAAID,KAAJ,EAAWI,QAAX,GAAsB,CAAxB,CAAxB;AACA,YAAIH,IAAID,KAAJ,EAAWG,UAAX,GAAwB,EAA5B,EAAgCF,IAAID,KAAJ,EAAWvC,QAAX,GAAoB,KAApB,CAAhC,KAGEwC,IAAID,KAAJ,EAAWvC,QAAX,GAAoB,CAAC,EAAEwC,IAAID,KAAJ,EAAWhC,IAAX,GAAgB,UAAlB,CAAD,GAA+B,CAA/B,GAAiC,CAAC,EAAEiC,IAAID,KAAJ,EAAWhC,IAAX,GAAgB,UAAlB,CAAD,GAA+B,IAAhE,GAAsE,CAAC,EAAEiC,IAAID,KAAJ,EAAWhC,IAAX,GAAgB,OAAlB,CAAD,GAA4B,CAA5B,GAA8B,CAAC,EAAEiC,IAAID,KAAJ,EAAWhC,IAAX,GAAgB,OAAlB,CAAD,GAA4B,IAA1D,GAAgE,CAAC,EAAEiC,IAAID,KAAJ,EAAWhC,IAAX,GAAgB,IAAlB,CAAD,GAAyB,CAAzB,GAA2B,CAAC,EAAEiC,IAAID,KAAJ,EAAWhC,IAAX,GAAgB,IAAlB,CAAD,GAAyB,IAApD,GAAyDiC,IAAID,KAAJ,EAAWhC,IAAX,GAAgB,IAAnO;AACH,OAhBD;AAiBF,UAAI,KAAKrC,IAAL,CAAUxF,MAAV,GAAiB,CAArB,EAAwB;AACtB,aAAKoH,QAAL;AACD;AAEF;;wBAEDzG,iCAAWE,MAAK;AAAA;;AAEd,UAAIA,KAAKyG,QAAL,CAAcrF,QAAd,IAA0BpB,KAAKyG,QAAL,CAAcrF,QAAd,CAAuB,KAAvB,CAA9B,EAA6D,KAAKoH,YAAL,CAAkBxI,KAAKmB,IAAvB,EAA7D,KACK;AAGH,YAAImI,UAAQ,KAAKxE,UAAL,GAAkB,KAAKH,IAAvB,GAA8B,GAA9B,GAAoC3E,KAAKmB,IAArD;AACA,aAAKvB,MAAL,CAAY2J,IAAZ,CAAiBD,OAAjB,EACGxN,IADH,CACS,oBAAW,CAGjB,CAJH,EAKEkC,KALF,CAKQ,iBAAS;AACfC,kBAAQC,GAAR,CAAY,oDAAZ;AACAD,kBAAQC,GAAR,CAAYuD,KAAZ;AACD,SARD;;AAWA,aAAK7B,MAAL,CAAY2H,GAAZ,CAAgB,KAAKtC,kBAArB,EACGnJ,IADH,CACQ,gBAAQ;AACZ,cAAI8B,KAAKH,QAAT,EAAmB;AACjB,gBAAI+L,UAAQX,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAZ;AACA,gBAAIgM,SAASD,QAAQE,UAArB;AACAD,sBAAS,OAAK9E,IAAL,CAAU1H,UAAV,CAAqB,GAArB,IAA0B,OAAK0H,IAAL,CAAUgF,KAAV,CAAgB,CAAhB,CAA1B,GAA6C,OAAKhF,IAA3D;AACA3E,iBAAKsE,eAAL,GAAqBmF,SAAO,GAAP,GAAWzJ,KAAKmB,IAArC;AACA,mBAAKxB,EAAL,CAAQsE,OAAR,CAAgB,2BAAiBjE,IAAjB,EAAuB,OAAKkG,OAA5B,CAAhB;AAED;AACF,SAVH;AAWD;AACF;;wBAED0D,yCAAeC,UAAS;AACtB,UAAIA,SAAS/F,EAAT,IAAa,EAAjB,EAAqB;AAAC,aAAKyE,MAAL,GAAe;AAAQ;AAC7C,UAAIsB,SAAStM,GAAb,EAAkB;AAChBU,gBAAQC,GAAR,CAAY,iBAAZ;AACA,YAAI8B,OAAK6J,QAAT;;AAEA,YAAK9P,OAAOC,QAAP,CAAgBoK,QAAhB,IAA0B,QAA1B,IAAsCpE,KAAKzC,GAAL,CAASN,UAAT,CAAoB,OAApB,CAA3C,EAA0E+C,KAAKzC,GAAL,GAAWyC,KAAKzC,GAAL,CAASuM,OAAT,CAAiB,OAAjB,EAAyB,QAAzB,CAAX;;AAE1E9J,aAAKiB,SAAL,GAAejB,KAAKzC,GAApB;AACAyC,aAAKsE,eAAL,GAAqBtE,KAAKzC,GAA1B;AACA,aAAKoC,EAAL,CAAQsE,OAAR,CAAgB,2BAAiBjE,IAAjB,EAAuB,KAAKkG,OAA5B,CAAhB;AACA;AACD;AACD,WAAKJ,KAAL,GAAc+D,SAAS/F,EAAT,IAAa,KAA3B;AACA,WAAKiC,SAAL,GAAkB8D,SAAS/F,EAAT,IAAa,SAA/B;AACA,WAAKkC,OAAL,GAAa,EAAE,KAAKF,KAAL,IAAc,KAAKC,SAArB,CAAb;AACA,UAAIjF,OAAK,IAAT;;AAEA,UAAI,KAAKgF,KAAT,EAAgB,KAAKF,SAAL,GAAe,KAAKpB,WAAL,CAAiBoF,cAAjB,CAAgCC,QAAhC,EAAyC/I,IAAzC,CAAf;AAChB,UAAI,KAAKiF,SAAT,EAAoB,KAAKH,SAAL,GAAe,KAAKnB,eAAL,CAAqBmF,cAArB,CAAoCC,QAApC,EAA6C/I,IAA7C,CAAf;;AAEpB,UAAI,CAAC,KAAKkF,OAAV,EAAmB,KAAKtB,KAAL,GAAW,EAAX;AACnB,WAAKmB,UAAL,GAAmB,KAAKnB,KAAL,CAAWvF,MAAX,GAAkB,KAAKyG,SAAL,CAAezG,MAApD;AACD;;wBAED4K,2CAAgBnE,WAAU;AAAA;;AAExB,yBAAKA,SAAL,EAAeoE,IAAf,mBAAuBpE,SAAvB;AACA,WAAKC,UAAL,GAAmB,KAAKnB,KAAL,CAAWvF,MAAX,GAAkB,KAAKyG,SAAL,CAAezG,MAApD;AACD;;wBAIHf,iCAAWrB,KAAI;AACb,UAAIsB,MAAMtB,IAAIuB,OAAd;AACAL,cAAQC,GAAR,CAAY,gBAAcG,GAA1B;AACA,UAAIA,QAAQ,EAAZ,EAAgB;AAKd,YAAItB,IAAIwB,cAAR,EAAwB,KAAKC,MAAL,CAAY,EAACC,MAAM,EAACC,MAAK3B,IAAIwB,cAAJ,CAAmBnB,KAAzB,EAAP,EAAZ,EAAxB,KACK,IAAIL,IAAI4B,MAAR,EAAgB,KAAKH,MAAL,CAAY,EAACC,MAAM,EAACC,MAAK3B,IAAI4B,MAAJ,CAAWvB,KAAjB,EAAP,EAAZ;AAEtB,OARD,MASA,IAAIiB,QAAM,EAAV,EAAc,KAAK4L,MAAL;AACd,aAAO,IAAP;AACD;;;eAhUM1K,SAAS;;;;;;;;;;;UCPFtE,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;MCpBYmO,uBAAAA,eACX,sBAAYlK,IAAZ,EAAiBlF,QAAjB,EAA0B;AAAA;;AACxB,SAAKkF,IAAL,GAAYA,IAAZ;AACA,SAAKlF,QAAL,GAAgBA,QAAhB;AACD;;MAGUqP,wBAAAA,gBACX,uBAAYnK,IAAZ,EAAiBlF,QAAjB,EAA0B;AAAA;;AACxB,SAAKkF,IAAL,GAAYA,IAAZ;AACA,SAAKlF,QAAL,GAAgBA,QAAhB;AACD;;MAGUsP,mBAAAA,WACX,kBAAYpK,IAAZ,EAAiBlF,QAAjB,EAA0B;AAAA;;AACxB,SAAKkF,IAAL,GAAYA,IAAZ;AACA,SAAKlF,QAAL,GAAgBA,QAAhB;AACD;;MAGUuP,sBAAAA,cACX,qBAAYrK,IAAZ,EAAiBlF,QAAjB,EAA0B;AAAA;;AACxB,SAAKkF,IAAL,GAAYA,IAAZ;AACA,SAAKlF,QAAL,GAAgBA,QAAhB;AACD;;MAGUwP,4BAAAA,oBACX,2BAAY1E,SAAZ,EAAsB9K,QAAtB,EAA+B;AAAA;;AAC7B,SAAK8K,SAAL,GAAiBA,SAAjB;AACA,SAAK9K,QAAL,GAAcA,QAAd;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MC/BUyP,mBAAAA;AAIX,sBAAY/F,WAAZ,EAAyB;AAAA;;AAAA;;AACvB,WAAKoB,SAAL,GAAe,EAAf;AACA,WAAK4E,WAAL,GAAiB,EAAjB;AACA,WAAK1G,EAAL,GAAQ,KAAR;AACA,WAAK2G,IAAL,GAAUjG,WAAV;AACD;;uBAEDrE,+BAAU;AACR,WAAKyF,SAAL,GAAe,KAAK6E,IAAL,CAAUC,gBAAV,CAA2B,EAACvJ,MAAK,KAAKqJ,WAAX,EAAuB1G,IAAG,KAAKA,EAA/B,EAA3B,CAAf;AACD;;uBAGD8F,yCAAeC,UAAS;AACtB,UAAIA,SAAS1I,IAAT,IAAe,IAAnB,EAAyB;AACvB,YAAI,KAAKqJ,WAAL,CAAiBpJ,QAAjB,CAA0B,GAA1B,CAAJ,EAAoC,KAAKwE,SAAL,GAAe,KAAK6E,IAAL,CAAUC,gBAAV,CAA2B,EAACvJ,MAAK,KAAKqJ,WAAL,CAAiBb,KAAjB,CAAuB,CAAvB,EAAyB,CAAC,CAA1B,CAAN,EAAmC7F,IAAG,KAAKA,EAA3C,EAA3B,CAAf,CAApC,KACK,KAAK8B,SAAL,GAAe,KAAK6E,IAAL,CAAUC,gBAAV,CAA2B,EAACvJ,MAAK,KAAKqJ,WAAL,CAAiBb,KAAjB,CAAuB,CAAvB,EAAyB,CAAC,CAA1B,IAA6B,GAAnC,EAAwC7F,IAAG,KAAKA,EAAhD,EAA3B,CAAf;AACN,OAHD,MAIE,KAAK8B,SAAL,GAAe,KAAK6E,IAAL,CAAUC,gBAAV,CAA2Bb,QAA3B,CAAf;AACH;;;eApBMtK,SAAS;;;;;;;;;;;;;;;;;;;;;MCALoL,sBAAAA;AAGX,yBAAYzO,UAAZ,EAAwB;AAAA;;AACtB,WAAK0D,MAAL,GAAY1D,UAAZ;AACA,WAAK0O,eAAL,GAAqB,oFAArB;AACA,WAAKC,cAAL,GAAoB,kFAApB;AACA,WAAKC,eAAL,GAAqB,2CAArB;AACA,WAAKC,UAAL,GAAkB,mBAAlB;AACA,WAAKC,eAAL,GAAuB,CAAC,YAAD,EAAc,YAAd,EAA2B,iBAA3B,EAA6C,iBAA7C,EAA+D,iBAA/D,EAAiF,MAAjF,CAAvB;AACD;;gBAEMhD,qBAAK6B,UAAU;AAEpB,UAAIoB,aAAa,EAAjB;AACAA,iBAAW9J,IAAX,GAAiB0I,SAASqB,IAAT,CAAc9J,QAAd,CAAuB,GAAvB,IAA6ByI,SAASqB,IAAT,CAAcvB,KAAd,CAAoB,CAApB,EAAsB,CAAC,CAAvB,IAA0B,GAAvD,GAA2DE,SAASqB,IAAT,CAAcvB,KAAd,CAAoB,CAApB,EAAsB,CAAC,CAAvB,IAA0B,GAAtG;AACAsB,iBAAWnH,EAAX,GAAgB+F,SAAS/F,EAAzB;AACAmH,iBAAWC,IAAX,GAAiBD,WAAW9J,IAAX,CAAgBwI,KAAhB,CAAsB,CAAtB,EAAwB,CAAC,CAAzB,IAA4B,GAA7C;AACA,aAAOsB,UAAP;AACD;;0BAGDrB,yCAAeC,UAASsB,UAAS;AAC/BlN,cAAQC,GAAR,CAAY,qBAAZ;AACAD,cAAQC,GAAR,CAAY2L,QAAZ;;AAEA,UAAIA,SAAS1I,IAAT,IAAe,IAAnB,EAAyB;AACvBlD,gBAAQC,GAAR,CAAY,qBAAZ;AACAD,gBAAQC,GAAR,CAAY2L,QAAZ;;AAEA,eAAO,KAAKa,gBAAL,CAAsBC,YAAY3C,IAAZ,CAAiB6B,QAAjB,CAAtB,EAAiDsB,QAAjD,CAAP;AAMD,OAVD,MAWE,OAAO,KAAKT,gBAAL,CAAsBb,QAAtB,EAA+BsB,QAA/B,CAAP;AACH;;0BAGDT,6CAAiBb,UAASsB,UAAU;AAIlC,UAAIvF,YAAY,EAAhB;AACA,UAAI9E,OAAO,IAAX;;AAGA,eAASsK,OAAT,GAAmB;AACjBxF,kBAAUoE,IAAV,CAAe,EAAC7I,MAAM,IAAP,EAAawE,MAAM,QAAnB,EAA6B7B,IAAI,EAAjC,EAAf;AACA,aAAK,IAAIuH,IAAI,CAAb,EAAgBA,IAAI,EAApB,EAAwBA,GAAxB,EAA6B;AAC3BzF,oBAAUoE,IAAV,CAAe,EAAC7I,MAAMkK,IAAI,GAAX,EAAgB1F,MAAM,gCAAgC0F,CAAhC,GAAoC,GAA1D,EAA+DvH,IAAI+F,SAAS/F,EAA5E,EAAf;AACD;AACF;;AAGD,eAASwH,UAAT,CAAoBC,MAApB,EAA4B;AAC1B;AACE3F,oBAAUoE,IAAV,CAAe,EAAC7I,MAAM,IAAP,EAAawE,MAAM,QAAnB,EAA6B7B,IAAI+F,SAAS/F,EAA1C,EAA6CoH,MAAKrB,SAAS1I,IAA3D,EAAf;;AAIA,eAAK,IAAIkK,IAAI,CAAb,EAAgBA,KAAK,CAArB,EAAwBA,GAAxB,EAA4B;;AAE1BvK,iBAAKlB,MAAL,CAAYpC,KAAZ,CAAkBsD,KAAK+J,cAAL,GAAqBU,MAArB,GAA8BF,CAA9B,GAAkC,GAApD,EACGvP,IADH,CACQ;AAAA,qBAAY2B,SAASC,IAAT,EAAZ;AAAA,aADR,EAEG5B,IAFH,CAEQ,gBAAQ;AAEZ,kBAAI0P,aAAa,EAAjB;AACA,kBAAI5N,KAAKH,QAAL,IAAiBG,KAAKH,QAAL,CAAcgO,QAAnC,EAA6C;AAC3CD,2BAAWxB,IAAX,CAAgB,EAAC7I,MAAKvD,KAAK8N,cAAL,CAAoBC,MAApB,CAA2BC,CAA3B,CAA6BjC,KAA7B,CAAmC,CAAnC,CAAN,EAA4ChE,MAAK,MAAI/H,KAAKH,QAAL,CAAcgO,QAAlB,GAA2B,GAA5E,EAAgF3H,IAAG+F,SAAS/F,EAA5F,EAAhB;AACD;;AAEDqH,uBAASpB,eAAT,CAAyByB,UAAzB;AACD,aAVH;AAWD;;AAED,eAAK,IAAIH,KAAI,IAAIQ,UAAJ,CAAe,CAAf,CAAb,EAAgCR,MAAK,IAAIQ,UAAJ,CAAe,CAAf,CAArC,EAAwDR,IAAxD,EAA6D;;AAE3DvK,iBAAKlB,MAAL,CAAYpC,KAAZ,CAAkBsD,KAAK+J,cAAL,GAAqBU,MAArB,GAA8BO,OAAOC,YAAP,CAAoBV,EAApB,CAA9B,GAAuD,GAAzE,EACGvP,IADH,CACQ;AAAA,qBAAY2B,SAASC,IAAT,EAAZ;AAAA,aADR,EAEG5B,IAFH,CAEQ,gBAAQ;AAEZ,kBAAI0P,aAAa,EAAjB;AACA,kBAAI5N,KAAKH,QAAL,IAAiBG,KAAKH,QAAL,CAAcgO,QAAd,GAAuB,CAA5C,EAA+C;AAC7CD,2BAAWxB,IAAX,CAAgB,EAAC7I,MAAKvD,KAAK8N,cAAL,CAAoBC,MAApB,CAA2BC,CAA3B,CAA6BjC,KAA7B,CAAmC,CAAnC,CAAN,EAA4ChE,MAAK,MAAI/H,KAAKH,QAAL,CAAcgO,QAAlB,GAA2B,GAA5E,EAAgF3H,IAAG+F,SAAS/F,EAA5F,EAAhB;AACD;;AAEDqH,uBAASpB,eAAT,CAAyByB,UAAzB;AACD,aAVH;AAWD;AACF;AACF;;AAGD,eAASQ,WAAT,CAAqBT,MAArB,EAA6B;AAC3B;AACEtN,kBAAQC,GAAR,CAAY,aAAZ;AACA0H,oBAAUoE,IAAV,CAAe,EAAC7I,MAAM,IAAP,EAAawE,MAAM,QAAnB,EAA6B7B,IAAI+F,SAAS/F,EAA1C,EAA6CoH,MAAKrB,SAAS1I,IAA3D,EAAf;AACA,cAAI8K,WAAWnL,KAAK8J,eAAL,GAAqBf,SAAS1I,IAA7C;AACAL,eAAKlB,MAAL,CAAYpC,KAAZ,CAAkByO,QAAlB,EACGnQ,IADH,CACQ;AAAA,mBAAY2B,SAASC,IAAT,EAAZ;AAAA,WADR,EAEG5B,IAFH,CAEQ,gBAAQ;AAEV,gBAAI0P,aAAa,EAAjB;AACA,gBAAI5N,KAAKH,QAAL,IAAiBG,KAAKH,QAAL,CAAcyO,IAAnC,EAAyC;;AAErC,mCAAiBtO,KAAKH,QAAL,CAAcyO,IAA/B,mHAAqC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,oBAA5BzN,IAA4B;;AACnCA,qBAAKqF,EAAL,GAAQ+F,SAAS/F,EAAjB,CAAoBrF,KAAK0C,IAAL,GAAW1C,KAAK0N,MAAhB,CAAwB1N,KAAKkH,IAAL,GAAYlH,KAAK2N,KAAjB,CAAuBZ,WAAWxB,IAAX,CAAgBvL,IAAhB;AACpE;AACJ;;AAED0M,qBAASpB,eAAT,CAAyByB,UAAzB;AACD,WAbL;AAcD;AACF;;AAED,eAASa,iBAAT,CAA2BC,KAA3B,EAAiC;AAC/BrO,gBAAQC,GAAR,CAAY,mBAAZ;AACA0H,kBAAUoE,IAAV,CAAe,EAAC7I,MAAM,IAAP,EAAawE,MAAM,QAAnB,EAA6B7B,IAAI+F,SAAS/F,EAA1C,EAA6CoH,MAAKrB,SAAS1I,IAA3D,EAAf;AACA,YAAI8K,WAAWnL,KAAKgK,eAAL,GAAqBwB,KAApC;;AAEAxL,aAAKlB,MAAL,CAAYpC,KAAZ,CAAkByO,QAAlB,EACGnQ,IADH,CACQ;AAAA,iBAAY2B,SAASC,IAAT,EAAZ;AAAA,SADR,EAEG5B,IAFH,CAEQ,gBAAQ;AACZmC,kBAAQC,GAAR,CAAYN,IAAZ;AACA,cAAI4N,aAAa,EAAjB;AACAe,iBAAOC,IAAP,CAAY5O,IAAZ,EAAkBmL,OAAlB,CAA0B,eAAM;AAC9BwD,mBAAOC,IAAP,CAAY5O,KAAKS,GAAL,CAAZ,EAAuB0K,OAAvB,CAA+B,gBAAQ;AACrC,oCAAiBnL,KAAKS,GAAL,EAAUoO,IAAV,EAAgBC,SAAjC,yHAA4C;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,oBAAnCjO,IAAmC;;AAC1CA,qBAAKqF,EAAL,GAAU+F,SAAS/F,EAAnB;AACArF,qBAAK0C,IAAL,GAAY1C,KAAKlB,GAAL,CAASoP,MAAT,CAAgBlO,KAAKlB,GAAL,CAAS2K,WAAT,CAAqB,GAArB,IAA0B,CAA1C,CAAZ;AACAzJ,qBAAKkH,IAAL,GAAY8G,OAAK,GAAL,GAAShO,KAAKsF,KAA1B;AACAyH,2BAAWxB,IAAX,CAAgBvL,IAAhB;AACD;AACF,aAPD;AAQD,WATD;;AAWA0M,mBAASpB,eAAT,CAAyByB,UAAzB;AACD,SAjBH;;AAoBAS,mBAAWnL,KAAK8L,eAAL,GAAqBN,KAAhC;;AAEAxL,aAAKlB,MAAL,CAAYpC,KAAZ,CAAkByO,QAAlB,EAA4B,EAACjJ,QAAO,MAAR,EAA5B,EACGlH,IADH,CACQ,oBAAY;AAChBmC,kBAAQC,GAAR,CAAYT,QAAZ;AACA,cAAI+N,aAAa,EAAjB;AACA,gCAAmB1K,KAAKkK,eAAxB,yHAAyC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,gBAAhC6B,MAAgC;;AACnC,gBAAIpO,OAAO,EAAX;;AAEAA,iBAAKlB,GAAL,GAASuD,KAAKiK,UAAL,GAAgBuB,KAAhB,IAAuBO,UAAU,MAAV,GAAkB,EAAlB,GAAsB,MAAIP,KAAjD,IAAwDO,MAAjE;AACApO,iBAAKqF,EAAL,GAAU+F,SAAS/F,EAAnB;AACArF,iBAAK0C,IAAL,GAAY1C,KAAKlB,GAAL,CAASoP,MAAT,CAAgBlO,KAAKlB,GAAL,CAAS2K,WAAT,CAAqB,GAArB,IAA0B,CAA1C,CAAZ;AACAzJ,iBAAKkH,IAAL,GAAY,oBAAkBkH,MAA9B;AACArB,uBAAWxB,IAAX,CAAgBvL,IAAhB;AACD;AACL0M,mBAASpB,eAAT,CAAyByB,UAAzB;AACD,SAdH;AAiBD;;AAED,UAAI3B,SAAS1I,IAAT,IAAiB,EAAjB,IAAuB0I,SAAS1I,IAAT,IAAiB,KAAxC,IAAiD0I,SAAS1I,IAAT,IAAe,GAApE,EAAyEiK,UAAzE,KAEK,IAAIvB,SAAS1I,IAAT,CAAcC,QAAd,CAAuB,GAAvB,CAAJ,EAAiC;AACpC,YAAIyI,SAAS1I,IAAT,CAAchC,MAAd,GAAqB,CAAzB,EAA4BmM,WAAWzB,SAAS1I,IAAT,CAAcwI,KAAd,CAAoB,CAApB,EAAuB,CAAC,CAAxB,CAAX,EAA5B,KACKqC,YAAYnC,SAAS1I,IAAT,CAAcwI,KAAd,CAAoB,CAApB,EAAuB,CAAC,EAAxB,CAAZ;AACN,OAHI,MAGE0C,kBAAkBxC,SAAS1I,IAA3B;;AAEP,aAAOyE,SAAP;AACD;;;cA3KMrG,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCJLuN,uBAAAA,yBAEX,wBAAc;AAAA;;AAAA;AACb;;;;;;;;;;;;;;;;;;MCHUC,0BAAAA,kBACX,2BAAc;AAAA;AAEb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCKUC,mBAAAA;AAIX,sBAAY9Q,UAAZ,EAAuB;AAAA;;AAAA;;AAAA;;AACrB,WAAK0D,MAAL,GAAc1D,UAAd;AACA,WAAK+Q,MAAL,GAAY,KAAZ;AAED;;uBAED9M,+BAAU;AAAA;;AAGR,WAAKP,MAAL,CAAYpC,KAAZ,CAAkB,KAAKD,GAAvB,EAA4B,EAACyF,QAAQ,MAAT,EAA5B,EACGlH,IADH,CACQ,oBAAY;AAGhB,YAAI2B,SAASyP,MAAT,IAAiB,GAArB,EAA0B,MAAKD,MAAL,GAAY,IAAZ;AAE3B,OANH,EAOGjP,KAPH,CAOS,iBAAQ;AACb,cAAKiP,MAAL,GAAY,KAAZ;AACAhP,gBAAQC,GAAR,CAAY,oBAAkBuD,KAA9B;AAED,OAXH;AAYD;;;eAxBMlC,SAAS;;;aACM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCJX4N,mBAAAA;AAKX,sBAAYjR,UAAZ,EAAwB;AAAA;;AAAA;;AAGtB,WAAK4I,UAAL,GAAkB,+CAAlB;AACA,WAAKlF,MAAL,GAAc1D,UAAd;;AAEA,WAAKkR,SAAL,GAAiB,CAAC,CAAD,CAAjB;AACA,WAAKC,UAAL,GAAkB,KAAKD,SAAL,CAAe,CAAf,CAAlB;AACA,WAAKE,QAAL,GAAgB,KAAhB;AACA,UAAItT,WAAWD,OAAOC,QAAP,CAAgBoK,QAA/B;AAGD;;uBAEDV,uBAAO;AAAA;;AAGL,WAAK6J,YAAL,GAAoB,KAAKC,UAAL,EAApB;;AAKA,WAAKC,gBAAL,GAAwB,KAAKC,cAAL,EAAxB;AACA,UAAI,KAAKH,YAAT,EAAuB;;AAErB,aAAK3N,MAAL,CAAYpC,KAAZ,CAAkB,KAAKsH,UAAL,GAAkB,KAAKrG,IAAL,CAAUC,IAA9C,EACG5C,IADH,CACQ;AAAA,iBAAY2B,SAASC,IAAT,EAAZ;AAAA,SADR,EAEG5B,IAFH,CAEQ,gBAAQ;AAIZ,gBAAKsR,SAAL,GAAe,EAAf;AACA,eAAK,IAAIO,SAAT,IAAsB/P,IAAtB,EAA4B;AAC1B,iCAAiBA,KAAK+P,SAAL,CAAjB,kHAAkC;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,kBAAzBlP,IAAyB;;AAEhC,kBAAIA,KAAKmP,aAAL,CAAmB3Q,UAAnB,CAA8B,aAA9B,CAAJ,EACE,MAAKmQ,SAAL,CAAepD,IAAf,CAAoBvL,KAAKoP,SAAzB;AACH;AACF;AACD,gBAAKR,UAAL,GAAgB,MAAKD,SAAL,CAAe,CAAf,CAAhB;AAED,SAhBH,EAgBKpP,KAhBL,CAgBW,iBAAS;;AAElBC,kBAAQC,GAAR,CAAY,kCAAgC,MAAK4G,UAArC,GAAkD,MAAKrG,IAAL,CAAUC,IAA5D,GAAiE,GAA7E;AACAT,kBAAQC,GAAR,CAAYuD,KAAZ;AACD,SApBD;AAqBD;AAEF;;uBAEDtB,+BAAW,CAGV;;uBAED2N,uDAAuB;AAErB,UAAI,CAAC,KAAKC,OAAN,IAAiB,KAAKR,YAA1B,EAAwC;AACtC,aAAKQ,OAAL,GAAe,KAAKC,GAAL,CAASC,SAAT,EAAf;AACA,aAAKC,OAAL,GAAe,KAAKC,GAAL,CAASF,SAAT,EAAf;AACD;;AAGD,UAAIG,QAAM,KAAKL,OAAL,CAAaE,SAAb,EAAV;;AAGA,UAAII,SAAS,KAAKL,GAAL,CAASM,UAAtB;;AAEAD,aAAOE,WAAP,CAAmB,KAAKP,GAAxB;;AAEAI,YAAMI,YAAN,CAAmB,WAAnB,EAA+B,KAAKnB,UAApC;AACA,WAAKW,GAAL,GAAWK,OAAOI,WAAP,CAAmBL,KAAnB,CAAX;AACAM,cAAQC,SAAR,CAAkBP,KAAlB,EAAyB,CAAC,uBAAD,CAAzB;;AAGAA,cAAM,KAAKF,OAAL,CAAaD,SAAb,EAAN;;AAEAI,eAAS,KAAKF,GAAL,CAASG,UAAlB;;AAEAD,aAAOE,WAAP,CAAmB,KAAKJ,GAAxB;;AAEAC,YAAMI,YAAN,CAAmB,WAAnB,EAA+B,KAAKnB,UAApC;;AAEA,WAAKc,GAAL,GAAUE,OAAOI,WAAP,CAAmBL,KAAnB,CAAV;AACAM,cAAQC,SAAR,CAAkBP,KAAlB,EAAyB,CAAC,uBAAD,CAAzB;AACD;;uBAEDQ,+BAAW;AACP,WAAKtB,QAAL,GAAgB,CAAC,KAAKA,QAAtB;AACH;;uBAEDE,mCAAa;AAIX,aAAQ,KAAK/O,IAAL,CAAUK,IAAV,KAAiB,QAAlB,IAAgC,wBAAwB+P,IAAxB,CAA6B,KAAKpQ,IAAL,CAAUC,IAAvC,CAAvC;AACD;;uBAEDgP,yCAAeoB,OAAO;AACpB,aAAQ,KAAKrQ,IAAL,CAAUK,IAAV,KAAiB,mBAAlB,IAA2C,mCAAmC+P,IAAnC,CAAwC,KAAKpQ,IAAL,CAAUC,IAAlD,CAAlD;AACD;;;eAvGMa,SAAS;;;aACC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCINwP,kBAAAA;AAIX,qBAAa7S,UAAb,EAAwByD,EAAxB,EAA4B;AAAA;;AAAA;;AAAA;;AAC1B,WAAKC,MAAL,GAAc1D,UAAd;AACA,WAAK0D,MAAL,CAAY3E,SAAZ,CAAsB,kBAAS;AAC7BE,eAAO6J,UAAP,CAAkB,QAAlB,EAA4B,kBAA5B;AACA7J,eAAO6J,UAAP,CAAkB,cAAlB,EAAkC,kBAAlC;AACD,OAHD;AAIA,WAAKrF,EAAL,GAAUA,EAAV;AACA,WAAKA,EAAL,CAAQE,SAAR,wBAA+B;AAAA,eAAO,MAAKmP,cAAL,CAAoBjP,IAAIC,IAAxB,EAA6BD,IAAIjF,QAAjC,CAAP;AAAA,OAA/B;;AAEA,WAAKwS,QAAL,GAAc,IAAd;AACA,WAAK2B,OAAL,GACA,KAAKC,UAAL,GAAgB,qBAAUnK,UAAV,KAAuB,0BADvC;AAEA,WAAKoK,QAAL,GAAc,IAAd;AACA,WAAKC,UAAL,GAAkB,EAAlB;AACA,WAAKC,WAAL,GAAmB,EAAnB;AACA,WAAKC,UAAL,GAAkB,EAAlB;AACA,WAAKD,WAAL,GAAmB,EAAnB;AACA,WAAKE,eAAL,GAAuB,IAAvB;AACA,WAAKzL,EAAL,GAAQ,CAAR;AACD;;sBAED0L,+CAAkB;AAChB,WAAKJ,UAAL,GAAkB,EAAlB;AACA,WAAKC,WAAL,GAAmB,EAAnB;AACA,WAAKC,UAAL,GAAkB,EAAlB;AACA,WAAKD,WAAL,GAAmB,EAAnB;AACA,WAAKE,eAAL,GAAuB,IAAvB;AACA,UAAI7I,OAAO,IAAIiB,IAAJ,EAAX;AACA,WAAKxG,IAAL,GAAU,aAAWuF,KAAK+I,WAAL,EAAX,GAA8B,GAA9B,IAAmC/I,KAAKgJ,QAAL,KAAgB,CAAnD,IAAsD,GAAtD,GAA0DhJ,KAAKiJ,OAAL,EAApE;AACA,WAAK7L,EAAL,GAAU,CAAV;AACA,WAAKqL,QAAL,GAAc,KAAd;AACD;;sBAaDhP,+BAAU;AAAA;;AACR,WAAKP,MAAL,CAAY2H,GAAZ,CAAgB,KAAK2H,UAArB,EAAiCpT,IAAjC,CAAsC,gBACtC;AAGE,eAAK8T,WAAL,GAAmB/G,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAnB;AAGD,OAPD;AAQD;;sBAEDoS,2CAAgBpR,MAAK;AACnB,WAAK0Q,QAAL,GAAc,IAAd;AACD;;sBAEDW,uCAAcrR,MAAK;AAAA;;AAGjB,WAAKmB,MAAL,CAAY2H,GAAZ,CAAgB,KAAK2H,UAAL,GAAgB,GAAhB,GAAoBzQ,KAAKsR,EAAzC,EAA6CjU,IAA7C,CAAkD,gBAClD;AAGE,eAAKkU,aAAL,GAAmBnH,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAnB;;AAEA,eAAK2R,UAAL,GAAkB,OAAKY,aAAL,CAAmBC,OAArC;AACA,eAAK9O,IAAL,GAAY,OAAK6O,aAAL,CAAmBtR,IAA/B;AACA,eAAKoF,EAAL,GAAU,OAAKkM,aAAL,CAAmBD,EAA7B;AACA,eAAKZ,QAAL,GAAgB,KAAhB;AACD,OAVD;AAWD;;sBAEDe,uCAAczR,MAAK;AACjB+C,YAAM,qCAAN;AAED;;sBAED2O,2BAAQ1R,MAAK;AAGX,WAAK2Q,UAAL,CAAgB5I,OAAhB,CAAwB/H,IAAxB;AAGD;;sBAEDuQ,yCAAehP,MAAKlF,UAAU;AAC5B,UAAIA,aAAY,KAAKoL,OAArB,EAA8B;AAG5B,YAAInM,OAAOqW,OAAP,CAAe,cAAcpQ,KAAKmB,IAAnB,GAA0B,4BAAzC,CAAJ,EAA4E;AAC1E,cAAI1C,OAAO,EAACC,MAAMsB,KAAKmB,IAAZ,EAAkBkP,KAAKrQ,KAAKsE,eAA5B,EAA6CxF,MAAM,MAAnD,EAAX;AACA,eAAKsQ,UAAL,CAAgB5I,OAAhB,CAAwB/H,IAAxB;AACD;AACF;AACF;;sBAED6R,iCAAWC,cAAa;AACtB,WAAKnB,UAAL,GAAkB,KAAKA,UAAL,CAAgB/P,MAAhB,CAAuB;AAAA,eAAQZ,SAAQ8R,YAAhB;AAAA,OAAvB,CAAlB;AACD;;sBAID3B,+BAAW;AACT,WAAKtB,QAAL,GAAgB,CAAE,KAAKA,QAAvB;AACD;;sBAGD9O,2BAAQ;AAAA;;AAEN,WAAKwR,aAAL,GAAqB,EAArB;AACA,WAAKA,aAAL,CAAmBD,EAAnB,GAAwB,KAAKjM,EAA7B;AACA,WAAKkM,aAAL,CAAmBtR,IAAnB,GAA0B,KAAKyC,IAA/B;AACA,WAAK6O,aAAL,CAAmBC,OAAnB,GAA6B,KAAKb,UAAlC;;AAKA,UAAI,KAAKtL,EAAL,GAAQ,CAAZ,EACE,KAAKlE,MAAL,CAAY4Q,GAAZ,CAAgB,KAAKtB,UAAL,GAAgB,GAAhB,GAAoB,KAAKpL,EAAzC,EAA4C+E,KAAK4H,SAAL,CAAe,KAAKT,aAApB,CAA5C,EACGlU,IADH,CACQ,gBAAO;AAGX,YAAI4U,SAAS7H,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAb;;AAEA,eAAK0R,QAAL,GAAc,IAAd;AACD,OAPH,EAQGnR,KARH,CAQS,iBAAQ;AACbC,gBAAQC,GAAR,CAAYuD,KAAZ;AACAD,cAAM,sCAAoC,OAAKsD,UAAzC,GAAoD,SAApD,GAA8DrD,MAAMhE,QAApE,GAA6E,UAA7E,GAAwFgE,MAAMkH,UAApG;AACD,OAXH,EADF,KAcE,KAAK/I,MAAL,CAAY+Q,IAAZ,CAAiB,KAAKzB,UAAtB,EAAiCrG,KAAK4H,SAAL,CAAe,KAAKT,aAApB,CAAjC,EACGlU,IADH,CACQ,gBAAO;AAGX,YAAI4U,SAAS7H,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAb;AACA,eAAKmS,WAAL,CAAiB5F,IAAjB,CAAsB,EAAC+F,IAAGW,OAAOX,EAAX,EAAerR,MAAKgS,OAAOhS,IAA3B,EAAtB;AACA,eAAKyQ,QAAL,GAAc,IAAd;AACD,OAPH,EAQGnR,KARH,CAQS,iBAAQ;AACbC,gBAAQC,GAAR,CAAYuD,KAAZ;AACAD,cAAM,sCAAoC,OAAKsD,UAAzC,GAAoD,SAApD,GAA8DrD,MAAMhE,QAApE,GAA6E,UAA7E,GAAwFgE,MAAMkH,UAApG;AACD,OAXH;AAYH;;;;0BA9Ge;AAEd,YAAI,KAAKyG,UAAL,CAAgBjQ,MAAhB,GAAuB,CAA3B,EACE,OAAO,IAAP,CADF,KAGE,OAAO,KAAP;AACH;;;;eA7CMI,SAAS;;;;;;;;;;;;;;;;;;;;MCdLqR,iCAAAA;AAGX,oCAAaC,OAAb,EAAsB;AAAA;;AACpB,WAAKA,OAAL,GAAeA,OAAf;AACD;;qCAOD7R,qCAAaC,UAASC,UAAS;AAC7B,WAAK2R,OAAL,CAAarC,YAAb,CAA0B,UAA1B,EAAqC,KAAKpR,KAA1C;AACD;;qCAGD+C,+BAAU;AACRuO,cAAQC,SAAR,CAAkB,KAAKkC,OAAvB,EAAgC,CAAC,uBAAD,CAAhC;AACD;;;cAlBMtR,SAAS,CAACmC,OAAD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCGLoP,mBAAAA;AAGX,wBAAa;AAAA;;AAAA;;AAAA;;AACX,WAAK7D,MAAL,GAAY,IAAZ;AACD;;uBAEDvJ,uBAAM;AACJ,UAAI,KAAKqN,WAAT,EAAsB;AACpB,aAAK9D,MAAL,GAAY,KAAZ;AACD;AACF;;uBAED+D,uCAAc;AACZ,WAAK/D,MAAL,GAAY,CAAC,KAAKA,MAAlB;AACD;;;;;;;;;aAbqB;;;;;;;;;;;;;;;;;;;MCDXgE,+BAAAA;AAGX,kCAAaJ,OAAb,EAAsB;AAAA;;AACpB,WAAKA,OAAL,GAAeA,OAAf;AACD;;mCAOD7R,qCAAaC,UAASC,UAAS;AAG9B,WAAK2R,OAAL,CAAarC,YAAb,CAA0B,QAA1B,EAAmC,KAAKpR,KAAxC;AAIA;;mCAKD+C,+BAAU;AAGRuO,cAAQC,SAAR,CAAkB,KAAKkC,OAAvB,EAAgC,CAAC,uBAAD,CAAhC;AACD;;;cA3BMtR,SAAS,CAACmC,OAAD;;;;;;;;;;;;;;;;;MCFLwP,gCAAAA;AAGX,mCAAaL,OAAb,EAAsB;AAAA;;AAEpB,WAAKA,OAAL,GAAeA,OAAf;AACA,WAAKM,YAAL,GAAkB,KAAlB;AACD;;oCAMDnS,qCAAaC,UAASC,UAAU;AAI9B,UAAI,KAAK9B,KAAL,CAAW+B,MAAX,GAAkB,CAAtB,EAAyB;;AAEvB,aAAKiS,MAAL,GAAc,KAAKhU,KAAL,CAAWiU,KAAX,CAAiB,GAAjB,CAAd;;AAGA,aAAKC,YAAL,GAAoB,KAAKF,MAAL,CAAY/R,MAAZ,CAAmB,UAAUkS,GAAV,EAAe;AACpD,iBAAO,yBAAwB1C,IAAxB,CAA6B0C,GAA7B;AAAP;AACD,SAFmB,CAApB;;AAIA,aAAKC,UAAL,GAAkB3I,KAAK4H,SAAL,CAAe,KAAKa,YAApB,CAAlB;;AAEA,YAAI,KAAKF,MAAL,CAAYjS,MAAZ,GAAqB,CAAzB,EAA4B;AAC1B,cAAI,KAAKgS,YAAT,EAAuB;AAErB,gBAAIM,UAAU,KAAKC,YAAL,CAAkBzD,SAAlB,EAAd;;AAGA,iBAAKI,MAAL,GAAc,KAAKwC,OAAL,CAAavC,UAA3B;;AAEA,iBAAKD,MAAL,CAAYE,WAAZ,CAAwB,KAAKsC,OAA7B;;AAEA,iBAAKxC,MAAL,CAAYI,WAAZ,CAAwBgD,OAAxB;AACA,iBAAKZ,OAAL,GAAe,KAAKxC,MAAL,CAAYsD,QAAZ,CAAqB,CAArB,CAAf;AACD,WAXD,MAWO;AACL,iBAAKD,YAAL,GAAoB,KAAKb,OAAL,CAAa5C,SAAb,EAApB;AAED;AACD,eAAK4C,OAAL,CAAarC,YAAb,CAA0B,SAA1B,EAAqC,KAAKgD,UAA1C;AACA9C,kBAAQC,SAAR,CAAkB,KAAKkC,OAAvB,EAAgC,CAAC,uBAAD,CAAhC;AACA,eAAKM,YAAL,GAAoB,IAApB;AACD;AACF;AACF;;;cAhDM5R,SAAS,CAACmC,OAAD;;;;;;;;;;;;;;;MCLLkQ,oBAAAA;AAEX,uBAAY1V,UAAZ,EAAuB;AAAA;;AACrB,WAAK0D,MAAL,GAAc1D,UAAd;AACA,WAAKf,MAAL,GAAc;AACZiB,wBAAgB,MADJ;AAEZC,yBAAiB,KAFL;AAGZC,mBAAW,qDAHC;AAIZC,gBAAQ,gCAJI;AAKZC,eAAO,iCALK;AAMZC,oBAAY,IANA;AAOZC,cAAM,mCAPM;AAQZmV,sBAAc;AARF,OAAd;AAUD;;wBAEDxU,yBAAOC,MAAK;AAIV,UAAIC,MAAM,KAAKpC,MAAL,CAAYmB,SAAZ,GAAsB,GAAtB,GAA0B,KAAKnB,MAAL,CAAY0W,YAAtC,GAAmD,MAAnD,GAA0D,KAAK1W,MAAL,CAAYoB,MAAtE,GAA8E,GAA9E,GAAkF,KAAKpB,MAAL,CAAYqB,KAA9F,GAAoG,QAApG,GAA6G,KAAKrB,MAAL,CAAYuB,IAAzH,GAA8H,eAA9H,GAA8I,KAAKvB,MAAL,CAAYsB,UAA1J,GAAqK,WAArK,GAAiLa,IAAjL,GAAsL,MAAhM;;AAEA,WAAKsC,MAAL,CAAY2H,GAAZ,CAAgBhK,GAAhB,EACGzB,IADH,CACQ,gBAAQ;AACZ,YAAI8B,KAAKH,QAAT,EAAmB;;AAEjB,iBAAOG,KAAKH,QAAL,CAAcI,OAAd,CAAsBC,QAAtB,CAA+BC,MAAtC;AACD;AACF,OANH,EAMKC,KANL,CAMW,iBAAS;;AAElBC,gBAAQC,GAAR,CAAY,OAAZ;AACAD,gBAAQC,GAAR,CAAYuD,KAAZ;AACD,OAVD;AAWD;;wBAEDrC,iCAAW9B,MAAM,CAEhB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MC7BWwU,oBAAAA;AAIV,uBAAYpS,EAAZ,EAAeC,EAAf,EAAmB;AAAA;;AAAA;;AAAA;;AACf,WAAKkR,OAAL,GAAenR,EAAf;AACA,WAAKC,EAAL,GAAUA,EAAV;AACF,WAAKA,EAAL,CAAQE,SAAR,0BAAiC;AAAA,eAAO,MAAKkS,QAAL,CAAchS,IAAIC,IAAlB,EAAuBD,IAAIjF,QAA3B,CAAP;AAAA,OAAjC;;AAEE,WAAKkX,SAAL,GAAe,EAAf;AACA,WAAKC,YAAL,GAAkB,KAAlB;AACF,WAAKC,QAAL,GAAgB,EAAhB;AACA,WAAKC,YAAL,GAAkB,EAAlB;AACA,WAAKC,MAAL,GAAa,EAAb;AACD;;wBAEDjS,+BAAW;AAET,UAAI,OAAOuO,OAAP,IAAmB,WAAvB,EAAoCA,QAAQC,SAAR,CAAkB,KAAKkC,OAAL,CAAaxQ,aAAb,CAA2B,YAA3B,CAAlB,EAA4D,CAAC,uBAAD,CAA5D;AACrC;;wBAED0R,6BAAS/R,MAAKlF,UAAU;AAEpB,UAAIA,YAAU,KAAKiG,GAAnB,EAAwB;AAEtB,aAAKqR,MAAL,GAAYpS,KAAKiB,SAAjB;AACA,YAAIgR,eAAa,KAAjB;AACA,YAAI,KAAKG,MAAL,CAAYhR,QAAZ,CAAqB,KAArB,CAAJ,EAAiC6Q,eAAa,OAAb;AACjC,YAAII,aAAa,mDAAmD,KAAKD,MAAxD,GAAiE,gCAAjE,GAAkGH,YAAlG,GAA+G,kBAAhI;AACA,aAAKK,iBAAL,CAAuBD,UAAvB;AACD;AACJ;;wBAEHE,uCAAe;AAEb,WAAKH,MAAL,GAAc,sBAAoB,KAAKD,YAAzB,GAAsC,GAAtC,GAA0C,KAAKA,YAA/C,GAA4D,YAA1E;AACA,UAAIE,aAAa,mDAAmD,KAAKD,MAAxD,GAAiE,qDAAlF;AACA,WAAKE,iBAAL,CAAuBD,UAAvB;AACD;;wBAGDG,6BAAU;AAER,WAAKJ,MAAL,GAAY,KAAKF,QAAjB;AACA,UAAIG,aAAa,iDAA+C,KAAKH,QAApD,GAA6D,qBAA9E;AACA,WAAKI,iBAAL,CAAuBD,UAAvB;AACD;;wBAEDC,+CAAkBD,YAAY;AAE1B,UAAII,YAAY,KAAK5B,OAAL,CAAaxQ,aAAb,CAA2B,YAA3B,CAAhB;AACA,UAAIqS,aAAa,KAAK7B,OAAL,CAAaxQ,aAAb,CAA2B,aAA3B,CAAjB;AACAqS,iBAAWnE,WAAX,CAAuBkE,SAAvB;;AAEAC,iBAAWC,kBAAX,CAA8B,YAA9B,EAA4C,6EAA2EN,UAA3E,GAAsF,QAAlI;;AAGA3D,cAAQC,SAAR,CAAkB,KAAKkC,OAAL,CAAaxQ,aAAb,CAA2B,YAA3B,CAAlB,EAA4D,CAAC,uBAAD,CAA5D;AACD;;;eAzDMd,SAAS,CAACmC,OAAD;;;;;;;;;;;UCbJzG,YAAAA;AAAT,WAASA,SAAT,CAAmBE,MAAnB,EAA2B,CAEjC;;;;;;;;;;;;;;;MCEYyX,sBAAAA,cACX,qBAAYvP,KAAZ,EAAkB;AAAA;;AAChB,SAAKA,KAAL,GAAaA,KAAb;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCIUwP,eAAAA;AAKT,kBAAYnT,EAAZ,EAAeC,EAAf,EAAmB;AAAA;;AAAA;;AAAA;;AACf,WAAKmE,EAAL,GAAUpE,GAAGoE,EAAb;AACA,WAAK+M,OAAL,GAAcnR,EAAd;AACA,WAAKC,EAAL,GAAQA,EAAR;AACA,WAAKA,EAAL,CAAQE,SAAR,2BAAiC;AAAA,eAAO,MAAKiT,eAAL,CAAqB/S,IAAIC,IAAzB,EAA8BD,IAAIjF,QAAlC,CAAP;AAAA,OAAjC;AACA,WAAK6E,EAAL,CAAQE,SAAR,sBAA4B;AAAA,eAAO,MAAKkT,UAAL,CAAgBhT,IAAIC,IAApB,EAAyBD,IAAIjF,QAA7B,CAAP;AAAA,OAA5B;AACH;;mBAED4I,uBAAO;AACLzF,cAAQC,GAAR,CAAY,0BAAwB,KAAK8U,IAAzC;AACA,WAAKC,QAAL,GAAc,KAAKD,IAAL,CAAU,CAAV,CAAd;AACA,WAAKC,QAAL,CAAcC,MAAd,GAAuB,IAAvB;AAED;;mBAEDJ,2CAAgB9S,MAAKlF,UAAS;AAE5BmD,cAAQC,GAAR,CAAY,8BAA4BpD,QAA5B,GAAsC,WAAtC,GAAkD,KAAKgJ,EAAnE;AACA,UAAI,CAAC,KAAKmP,QAAL,CAAcnP,EAAd,CAAiB7G,UAAjB,CAA4BnC,QAA5B,CAAL,EAA4C;AAC1C,aAAKmY,QAAL,CAAcC,MAAd,GAAuB,KAAvB;;AAEA,aAAKD,QAAL,GAAc,KAAKD,IAAL,CAAU,CAAV,CAAd;;AAEA,aAAKC,QAAL,CAAcC,MAAd,GAAqB,IAArB;AACD;AACF;;mBAEDH,iCAAW/S,MAAKlF,UAAU;AACxBmD,cAAQC,GAAR,CAAY,yBAAuBpD,QAAvB,GAAiC,WAAjC,GAA6C,KAAKgJ,EAA9D;AACA7F,cAAQC,GAAR,CAAY,KAAK8U,IAAjB;AACA/U,cAAQC,GAAR,CAAY,KAAK+U,QAAjB;AACA,UAAI,CAAC,KAAKA,QAAL,CAAcnP,EAAd,CAAiB7G,UAAjB,CAA4BnC,QAA5B,CAAL,EAA4C;AAC1C,aAAKmY,QAAL,CAAcC,MAAd,GAAuB,KAAvB;;AAEA,aAAKD,QAAL,GAAc,KAAKD,IAAL,CAAU,CAAV,CAAd;;AAEA,aAAKC,QAAL,CAAcC,MAAd,GAAqB,IAArB;AACD;AAEF;;mBAEDC,2BAAQ9P,OAAM;AAEZ,WAAK4P,QAAL,CAAcC,MAAd,GAAuB,KAAvB;;AAEA,WAAKD,QAAL,GAAc5P,KAAd;;AAEA,WAAK4P,QAAL,CAAcC,MAAd,GAAqB,IAArB;;AAEE,WAAKvT,EAAL,CAAQsE,OAAR,CAAgB,0BAAgB,KAAKgP,QAAL,CAAcnP,EAA9B,CAAhB;AACH;;;eArDMvE,SAAS,CAACmC,OAAD;;;;;;;;;;;;;;;;;;;;;MCVPhI,cAAAA;AAGX,iBAAYiG,EAAZ,EAAgB;AAAA;;AAAA;;AACd,WAAKA,EAAL,GAAUA,EAAV;AACA,WAAKA,EAAL,CAAQE,SAAR,yBAAgC;AAAA,eAAO,MAAKC,UAAL,CAAgBC,IAAIC,IAApB,CAAP;AAAA,OAAhC;AACD;;kBAEDF,iCAAWE,MAAK;AACdjG,aAAOmK,MAAP,CAAcC,WAAd,CAA0BpK,OAAOC,QAAP,CAAgBoK,QAAhB,GAAyB,IAAzB,GAA8BrK,OAAOC,QAAP,CAAgBqK,QAA9C,GAAuDrE,KAAKiB,SAAtF,EAAiG,GAAjG;;AAEAlH,aAAO8I,KAAP;AACD;;;cAXMtD,SAAS;;;;;;;;UCMFtE,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCdYqX,yBAAAA;;;AAIX,4BAAYzT,EAAZ,EAAgBzD,UAAhB,EAA4B;AAAA;;AAAA,mDAC1B,sBAAMyD,EAAN,EAASzD,UAAT,CAD0B;;AAAA;;AAAA;AAE3B;;6BAED4D,iCAAWE,MAAK;AAEd,UAAI,CAACA,KAAKgH,IAAN,IAAehH,KAAKgH,IAAL,CAAU5F,QAAV,IAAsBpB,KAAKgH,IAAL,CAAU5F,QAAV,CAAmB,KAAnB,CAAzC,EAAqE,KAAKoH,YAAL,CAAkBxI,KAAKmB,IAAvB;AACtE;;6BAGDkS,yCAAgB;AAAA;;AAEd,UAAIC,SAAQ,EAAZ;AACAA,aAAOnS,IAAP,GAAc,KAAKwD,IAAnB;AACA,WAAK/E,MAAL,CAAY2H,GAAZ,CAAgB,KAAKtC,kBAArB,EACGnJ,IADH,CACQ,gBAAQ;AACZ,YAAI8B,KAAKH,QAAT,EAAmB;AACjB,cAAI+L,UAAQX,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAZ;AACA,cAAIgM,SAASD,QAAQE,UAArB;AACAD,oBAAS,OAAK9E,IAAL,CAAU1H,UAAV,CAAqB,GAArB,IAA0B,OAAK0H,IAAL,CAAUgF,KAAV,CAAgB,CAAhB,CAA1B,GAA6C,OAAKhF,IAA3D;AACA,cAAI4O,QAAQ,EAAZ;AACAA,gBAAMtS,SAAN,GAAkBwI,MAAlB;AACA,iBAAK9J,EAAL,CAAQsE,OAAR,CAAgB,2BAAiBsP,KAAjB,EAAwB,OAAKrN,OAA7B,CAAhB;AACD;AACF,OAVH;AAWD;;;mCA5BM3G,SAAS;;;;;;;;;;;;;;;;;;MCPLiU,oBAAAA;AAEX,yBAAc;AAAA;AAAE;;cAQT7Q,qCAAa8Q,cAAaC,cAAa;AAC5C,aAAQ,OAAO5Q,OAAP,KAAoB,WAArB,GACJG,aAAaC,OAAb,CAAqBuQ,YAArB,MAAqC,WAAtC,GAAoD,KAAKvS,QAAL,CAAcuS,YAAd,CAApD,GAAiF,KAAKlS,QAAL,CAAckS,YAAd,EAA2BC,YAA3B,CAD5E,GAEJA,YAFH;AAGD;;cAQMxS,6BAASuS,cAAiC;AAAA,UAApBC,YAAoB,uEAAP,MAAO;;AAC/C,aAAQ,OAAO5Q,OAAP,KAAoB,WAArB,GAAqCG,aAAaC,OAAb,CAAqBuQ,YAArB,IAAmCxQ,aAAaC,OAAb,CAAqBuQ,YAArB,CAAnC,GAAsEC,YAA3G,GAA0HA,YAAjI;AAAiJ;;cAS5InS,6BAASkS,cAAarW,OAAM;AACjC,aAAQ,OAAO0F,OAAP,KAAoB,WAArB,GAAoCG,aAAa0Q,OAAb,CAAqBF,YAArB,EAAkCrW,KAAlC,CAApC,GAA6EA,KAApF;AACD;;cAOM2H,mCAAY;AAGjB,aAAQ,0BAA0BhL,MAA3B,GAAqC6Z,oBAArC,GAA4D,EAAnE;AACD;;cAEMC,6CAAiBC,KAAK;AAC3B,UAAIC,MAAMxH,OAAOyH,MAAP,CAAc,IAAd,CAAV;;AAEA,UAAI,OAAOF,GAAP,KAAe,QAAnB,EAA6B;AAC3B,eAAOC,GAAP;AACD;;AAEDD,YAAMA,IAAIG,IAAJ,GAAWnK,OAAX,CAAmB,WAAnB,EAAgC,EAAhC,CAAN;;AAEA,UAAI,CAACgK,GAAL,EAAU;AACR,eAAOC,GAAP;AACD;;AAEDD,UAAIzC,KAAJ,CAAU,GAAV,EAAetI,OAAf,CAAuB,UAAUmL,KAAV,EAAiB;AACtC,YAAIC,QAAQD,MAAMpK,OAAN,CAAc,KAAd,EAAqB,GAArB,EAA0BuH,KAA1B,CAAgC,GAAhC,CAAZ;;AAGA,YAAIhT,MAAM8V,MAAM7N,KAAN,EAAV;AACA,YAAI8N,MAAMD,MAAMhV,MAAN,GAAe,CAAf,GAAmBgV,MAAME,IAAN,CAAW,GAAX,CAAnB,GAAqCC,SAA/C;;AAEAjW,cAAMkW,mBAAmBlW,GAAnB,CAAN;;AAIA+V,cAAMA,QAAQE,SAAR,GAAoB,IAApB,GAA2BC,mBAAmBH,GAAnB,CAAjC;;AAEA,YAAIL,IAAI1V,GAAJ,MAAaiW,SAAjB,EAA4B;AAC1BP,cAAI1V,GAAJ,IAAW+V,GAAX;AACD,SAFD,MAEO,IAAII,MAAMC,OAAN,CAAcV,IAAI1V,GAAJ,CAAd,CAAJ,EAA6B;AAClC0V,cAAI1V,GAAJ,EAAS2L,IAAT,CAAcoK,GAAd;AACD,SAFM,MAEA;AACLL,cAAI1V,GAAJ,IAAW,CAAC0V,IAAI1V,GAAJ,CAAD,EAAW+V,GAAX,CAAX;AACD;AACF,OApBD;;AAsBA,aAAOL,GAAP;AACD;;;;;;;;;;;;;;;;;;;;;MClFUra,cAAAA;AAGb,iBAAYiG,EAAZ,EAAezD,UAAf,EAA0B;AAAA;;AAAA;;AACxB,WAAKyD,EAAL,GAAUA,EAAV;AACE,WAAK3F,QAAL,GAAgBD,OAAOC,QAAP,CAAgBoK,QAAhC;AACA,WAAKsQ,WAAL,GAAkB,KAAK1a,QAAL,CAAciD,UAAd,CAAyB,OAAzB,CAAlB;AACA,WAAK2C,MAAL,GAAY1D,UAAZ;AACA,WAAKyY,SAAL,GAAe,EAAf;AACA,WAAKC,gBAAL,GAAsB,gCAAtB;;AAEF,WAAKhT,OAAL,GAAe,+BAAf;AACA,WAAKjC,EAAL,CAAQE,SAAR,wBAA+B;AAAA,eAAO,MAAK+B,OAAL,CAAazH,WAAb,EAAP;AAAA,OAA/B;AACC;;kBAED0a,qCAAc;AAAA;;AACZ,UAAI,KAAKF,SAAL,IAAgB,EAApB,EAAwB;AACtB,aAAK/U,MAAL,CAAY2H,GAAZ,CAAgB,KAAKqN,gBAArB,EACG9Y,IADH,CACQ,gBAAQ;AACZ,cAAI8B,KAAKH,QAAT,EAAmB;AACjB,gBAAIqX,SAASjM,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAb;AACA,gBAAI1D,OAAOC,QAAP,CAAgB+a,IAAhB,IAAwB,IAAxB,IAAgChb,OAAOC,QAAP,CAAgB+a,IAAhB,IAAuB,EAA3D,EACE,OAAKJ,SAAL,GAAiB5a,OAAOC,QAAP,CAAgBoK,QAAhB,GAAyB,IAAzB,GAA8BrK,OAAOC,QAAP,CAAgBqK,QAA9C,GAAuDyQ,OAAOpL,UAA/E,CADF,KAGE,OAAKiL,SAAL,GAAiB5a,OAAOC,QAAP,CAAgBoK,QAAhB,GAAyB,IAAzB,GAA8BrK,OAAOC,QAAP,CAAgBqK,QAA9C,GAAuD,GAAvD,GAA2DtK,OAAOC,QAAP,CAAgB+a,IAA3E,GAAgFD,OAAOpL,UAAxG;AAEH;AACF,SAVH;AAWD;AACF;;kBAEDvJ,+BAAU;AACR,UAAI,CAAE7F,SAAS0a,MAAT,CAAgBC,KAAhB,CAAsB,wCAAtB,CAAN,EAAuE,KAAKrT,OAAL,CAAazH,WAAb;AACxE;;;cAhCMoF,SAAS;;;;;;;;UCIFtE,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;MCvBYrC,cAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCKAwb,sBAAAA;;;AAGX,2BAAa;AAAA;;AAAA,mDACX,yBADW;;AAAA;;AAEX,YAAKC,OAAL,GAAa,sCAAb;AACA,YAAK5X,GAAL,GAAS,sCAAT;AAHW;AAIZ;;;;;;aALmB;;;;;;;;;;UCENtC,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;;MCfYqZ,wBAAAA;AAEX,6BAAe;AAAA;;AACb,WAAKxV,MAAL,GAAY,mCAAZ;AACA,WAAKrC,GAAL,GAASxD,OAAOC,QAAP,CAAgBqb,IAAzB;AACA,WAAKpG,OAAL,GAAa,qBAAUlK,UAAV,EAAb;AACA,WAAKuQ,OAAL,GAAa,KAAb;AACA,WAAK1V,MAAL,CAAY3E,SAAZ,CAAsB,kBAAS;AAC7BE,eAAO6J,UAAP,CAAkB,QAAlB,EAA4B,kBAA5B;AACA7J,eAAO6J,UAAP,CAAkB,cAAlB,EAAkC,kBAAlC;AACD,OAHD;AAKD;;4BAED7E,+BAAU;AAAA;;AAER,WAAKP,MAAL,CAAY2H,GAAZ,CAAgB,KAAK0H,OAAL,GAAa,KAAK1R,GAAlC,EACGzB,IADH,CACQ;AAAA,eAAY,MAAKyZ,UAAL,CAAgB9X,QAAhB,CAAZ;AAAA,OADR,EAEGO,KAFH,CAES;AAAA,eAAS,MAAKwX,YAAL,CAAkB/T,KAAlB,CAAT;AAAA,OAFT;AAGD;;4BAED8T,iCAAW9X,UAAS;AAElB,UAAIgY,MAAK5M,KAAKC,KAAL,CAAWrL,SAASA,QAApB,CAAT;;AAEA,WAAK6X,OAAL,GAAcG,IAAIH,OAAlB;AACD;;4BAEDE,qCAAa/T,OAAM;AACjB,WAAK6T,OAAL,GAAa,KAAb;AACArX,cAAQC,GAAR,CAAY,yDAAuD,KAAKX,GAA5D,GAAgE,SAAhE,GAA0EkE,MAAMhE,QAAhF,GAAyF,UAAzF,GAAoGgE,MAAMkH,UAAtH;AACD;;4BAED+M,2BAAQ;AAAA;;AACN,WAAK9V,MAAL,CAAY+Q,IAAZ,CAAiB,KAAK1B,OAAL,GAAa,KAAK1R,GAAnC,EACGzB,IADH,CACQ;AAAA,eAAY,OAAKyZ,UAAL,CAAgB9X,QAAhB,CAAZ;AAAA,OADR,EAEGO,KAFH,CAES;AAAA,eAAS,OAAKwX,YAAL,CAAkB/T,KAAlB,CAAT;AAAA,OAFT;AAGD;;;;;;;;;;;;;;;;;;MC1CUkU,wBAAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCEAC,yBAAAA;;;AAEX,8BAAa;AAAA;;AAAA,mDACZ,yBADY;;AAAA;;AAEZ,YAAKrY,GAAL,GAAS,oCAAT;AACA,YAAK4X,OAAL,GAAa,oCAAb;AAHY;AAIb;;;;;;aALoB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCDTU,0BAAAA;;;AAGX,+BAAa;AAAA;;AAAA,mDACX,yBADW;;AAAA;;AAEX,YAAKtY,GAAL,GAAS,qCAAT;AAFW;AAGZ;;;;;;aAJmB;;;;;;;;;;;;;;;;;;;;MCMTuY,qBAAAA;AAGX,wBAAYnW,EAAZ,EAAezD,UAAf,EAA0B;AAAA;;AAAA;;AACxB,WAAK4I,UAAL,GAAkB,qBAAUC,UAAV,KAAuB,wBAAzC;AACApF,SAAGE,SAAH,8BAAgC;AAAA,eAAO,MAAKkW,cAAL,CAAoBhW,IAAIuC,QAAxB,CAAP;AAAA,OAAhC;AACA,WAAK1C,MAAL,GAAY1D,UAAZ;AACA,WAAK8Z,SAAL,GAAe,CAAC,EAAC9M,OAAM,iCAAP,EAAyC+M,WAAU,IAAnD,EAAD,CAAf;AACA,WAAKrW,MAAL,CAAY3E,SAAZ,CAAsB,kBAAS;AAC7BE,eAAO6J,UAAP,CAAkB,QAAlB,EAA4B,kBAA5B;AACA7J,eAAO6J,UAAP,CAAkB,cAAlB,EAAkC,kBAAlC;AACD,OAHD;AAID;;yBAED7E,+BAAW;AAAA;;AAET,WAAKP,MAAL,CAAY2H,GAAZ,CAAgB,KAAKzC,UAArB,EACGhJ,IADH,CACQ,gBAAQ;AAGZ,YAAI8B,KAAKH,QAAT,EAAmB;AACjB,iBAAKuY,SAAL,GAAiBnN,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAjB;AACD;AACF,OAPH,EAQGO,KARH,CAQS,iBAAQ;AACbC,gBAAQC,GAAR,CAAY,8BAAZ;AACAD,gBAAQC,GAAR,CAAYuD,KAAZ;;AAEE,YAAIA,MAAMgG,UAAN,IAAoB,GAAxB,EAA6B;AAE3BxJ,kBAAQC,GAAR,CAAY,aAAZ;AACAnE,iBAAOC,QAAP,GAAkB,iBAAiBD,OAAOC,QAAP,CAAgBC,QAAnD;AAED,SALD,MAMFuH,MAAM,yDAAuD,OAAKsD,UAA5D,GAAuE,SAAvE,GAAiFrD,MAAMhE,QAAvF,GAAgG,UAAhG,GAA2GgE,MAAMkH,UAAvH;AACD,OAnBH;AAoBD;;yBAEDoN,yCAAezT,UAAU;AACtB,WAAK0T,SAAL,GAAiB1T,QAAjB;AACF;;yBAED4T,yCAAe5T,UAAS;AAAA;;AAEtB,UAAI,CAAC8N,QAAQ,2DAAyD9N,SAAS4G,KAAlE,GAAwE,KAAhF,CAAL,EACE;AACF,WAAKtJ,MAAL,CAAYuW,MAAZ,CAAmB,KAAKrR,UAAL,GAAgB,GAAhB,GAAoBxC,SAAS4G,KAAhD,EACGpN,IADH,CACQ,gBAAO;AAGX,YAAI8B,KAAKH,QAAT,EAAmB;AACjB,iBAAKuY,SAAL,GAAiBnN,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAjB;AACD;AACF,OAPH,EAQGO,KARH,CAQS,iBAAQ;AACbC,gBAAQC,GAAR,CAAYuD,KAAZ;;AAEAD,cAAM,oCAAkC,OAAKsD,UAAvC,GAAkD,SAAlD,GAA4DrD,MAAMhE,QAAlE,GAA2E,UAA3E,GAAsFgE,MAAMkH,UAAlG;AACD,OAZH;AAaD;;;cA1DMpJ,SAAS;;;;;;;;;;;;;;;;;;MCXL7F,cAAAA,wBAGX,aAAYiG,EAAZ,EAAgB;AAAA;;AAAA;;AACd,SAAKA,EAAL,GAAUA,EAAV;AACA,QAAI3F,WAAWD,OAAOC,QAAP,CAAgBoK,QAA/B;AACA,SAAKsQ,WAAL,GAAkB1a,SAASiD,UAAT,CAAoB,OAApB,CAAlB;;AAEA,SAAK2E,OAAL,GAAe,6BAAf;AACA,SAAKjC,EAAL,CAAQE,SAAR,wBAA+B;AAAA,aAAO,MAAK+B,OAAL,CAAazH,WAAb,EAAP;AAAA,KAA/B;AAED,YAVMoF,SAAS;;;;;;;;;;;;;;;MCDL6W,0BAAAA;;;;mFC0Be,+EAAlBC;;;;;;;;;;;;;;;;MAfGC,yBAAAA;AAIX,4BAAY3W,EAAZ,EAAe;AAAA;;AAGb,WAAKA,EAAL,GAASA,EAAT;AACA,WAAK4W,WAAL,GAAiB,qBAAU1C,gBAAV,CAA2B9Z,OAAOC,QAAP,CAAgBwc,IAA3C,EAAiDC,YAAlE;AACA,WAAKC,eAAL,GAAuB,CAAC,CAAC,KAAKH,WAA9B;;AAIA,WAAKI,WAAL,GAAmB,kBAAnB;AACA,UAAI;AAGF,YAAIC,MAAM,IAAIP,OAAJ,CAAY;AACpBQ,oBAAU,KAAKF,WAAL,CAAiBtF,KAAjB,CAAuB,EAAvB,EAA2ByF,GAA3B,CAA+B,UAAUC,CAAV,EAAa;AACpD,mBAAOjL,OAAOC,YAAP,CAAoB,KAAKgL,EAAElL,UAAF,EAAzB,CAAP;AACD,WAFS,EAEPwI,IAFO,CAEF,EAFE;AADU,SAAZ,CAAV;AAKA,YAAI2C,aAAajd,OAAOC,QAAP,CAAgBqb,IAAjC;;AAEA,aAAK4B,OAAL,GAAeL,IAAIM,oBAAJ,CAAyBF,UAAzB,CAAf;AAGD,OAbD,CAaE,OAAMG,CAAN,EAAQ;AACRlZ,gBAAQC,GAAR,CAAY,6BAAZ;AACAD,gBAAQC,GAAR,CAAYiZ,CAAZ;AACD;;AAED,WAAKrT,EAAL,GAAQ,SAAR;AAGD;;6BAEDsT,mCAAY;AACV,UAAI,KAAKV,eAAT,EAA0B;AACxB,YAAIpU,WAAW,EAAf;AACAA,iBAAS+U,IAAT,GAAc,KAAKvT,EAAnB;;AAEAxB,iBAASgV,WAAT,GAAuB,KAAKf,WAA5B;;AAGA,aAAK5W,EAAL,CAAQsE,OAAR,CAAgB,+BAAqB3B,QAArB,CAAhB;AACD;AACF;;;cA7CM/C,SAAS;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;MCNLgY,yBAAAA,yBA2BV,oCAAa,kBAAb,WAKA,oCAAa,kBAAb,WAKA,oCAAa,kBAAb,WAIA,oCAAa,kBAAb;AApCD,4BAAY5X,EAAZ,EAAezD,UAAf,EAA0Bsb,cAA1B,EAA0C;AAAA;;AAAA;;AACxC,WAAKC,OAAL,GAAa,eAAb;AACA,WAAK9X,EAAL,GAASA,EAAT;AACA,WAAK6X,cAAL,GAAoBA,cAApB;AACA,WAAKE,OAAL,GAAa,IAAb;AACA,WAAKC,aAAL,GAAqB,WAArB;AACA,WAAKC,SAAL,GAAiB,OAAjB;AACA,WAAKC,SAAL,GAAe,KAAf;AACA,WAAKC,cAAL,GAAsB,EAAtB;AACA,WAAK9B,SAAL,GAAiB,EAAjB;AACA,WAAK+B,gBAAL,GAAsB,EAAtB;AACA,WAAKjT,UAAL,GAAkB,qBAAUC,UAAV,KAAuB,mBAAzC;;AAEA,WAAKnF,MAAL,GAAY1D,UAAZ;;AAEA,WAAKyD,EAAL,CAAQE,SAAR,6BAAoC;AAAA,eAAO,MAAKmY,cAAL,CAAoBjY,IAAIuC,QAAxB,CAAP;AAAA,OAApC;AACA,WAAK2V,SAAL,GAAiB,IAAIC,OAAJ,EAAjB;AACA,WAAKD,SAAL,CAAeE,MAAf,CAAsB,QAAtB,EAAgC,kBAAhC;AACA,WAAKF,SAAL,CAAeE,MAAf,CAAsB,cAAtB,EAAsC,kBAAtC;AAED;;6BAyBDC,yBAAO;AACL,WAAKL,gBAAL,GAAsB,EAAtB;AACA,WAAKM,QAAL,GAAc,EAAd;AACA,WAAKf,WAAL,GAAiB,EAAjB;AACA,WAAKgB,cAAL,GAAoB,EAApB;AACA,WAAKpP,KAAL,GAAW,EAAX;AACA,WAAKqP,SAAL,GAAe,EAAf;AACD;;6BAEDpY,+BAAW;AAAA;;AAMT,WAAK2X,cAAL,GAAsB,KAAKN,cAAL,CAAoBP,OAA1C;AACA,WAAKrX,MAAL,CAAYpC,KAAZ,CAAkB,KAAKsH,UAAL,GAAgB,KAAK6S,aAAvC,EAAqD,EAACa,SAAQ,KAAKP,SAAd,EAAwB5W,aAAY,SAApC,EAArD,EACGvF,IADH,CACQ;AAAA,eAAY2B,SAASC,IAAT,EAAZ;AAAA,OADR,EAEG5B,IAFH,CAEQ,gBAAO;AAGX,YAAI8B,IAAJ,EAAU;AACR,iBAAKoY,SAAL,GAAiBpY,IAAjB;AACD;AACF,OARH,EAQKI,KARL,CAQW,iBAAS;AAElB,YAAIyD,MAAMgG,UAAN,IAAoB,GAAxB,EAA6B;AAE3BxJ,kBAAQC,GAAR,CAAY,uCAAZ;AACAnE,iBAAOC,QAAP,GAAkB,iBAAiBD,OAAOC,QAAP,CAAgBC,QAAnD;AAED,SALD,MAKO,CAIN;AACF,OApBD;AAqBA,WAAKud,cAAL,CAAoBJ,UAApB;AACD;;6BAEDqB,qCAAc;AACX,UAAInW,WAAW,EAAf;AACAA,eAAS+U,IAAT,GAAc,KAAKU,gBAAnB;AACAzV,eAAS4G,KAAT,GAAiB,KAAKA,KAAtB;AACA,UAAI,KAAKwP,eAAT,EAA0BpW,SAASgV,WAAT,GAAuB,KAAKA,WAA5B;AAC1B,UAAI,KAAKqB,kBAAT,EAA6BrW,SAASgV,WAAT,GAAuB,KAAKgB,cAA5B;AAC7B,UAAI,KAAKM,cAAT,EAAyB;AACvBtW,iBAASgV,WAAT,GAAuB,KAAKuB,QAA5B;AACAvW,iBAAS+V,QAAT,GAAoB,KAAKA,QAAzB;AACD,OAHD,MAGO,IAAI,KAAKS,cAAT,EAAwB;AAC7BxW,iBAASiW,SAAT,GAAmB,KAAKA,SAAxB;AACAjW,iBAASgV,WAAT,GAAuB,KAAKuB,QAA5B;AACAvW,iBAAS+V,QAAT,GAAoB,KAAKA,QAAzB;AACD;AACF,WAAKtC,cAAL,CAAoBzT,QAApB;AACD;;6BAGDyT,yCAAezT,UAAU;AAAA;;AACvB,WAAK1C,MAAL,CAAYpC,KAAZ,CAAkB,KAAKsH,UAAL,GAAgB,KAAK8S,SAAvC,EAAiD;AAC/C5U,gBAAQ,KADuC;AAE/C+V,cAAM,8BAAKzW,QAAL,CAFyC;AAG/CkW,iBAAQ,KAAKP,SAHkC;AAI/C5W,qBAAY;AAJmC,OAAjD,EAMGvF,IANH,CAMQ;AAAA,eAAY2B,SAASC,IAAT,EAAZ;AAAA,OANR,EAOG5B,IAPH,CAOQ,gBAAO;AAGX,YAAI0Y,MAAMC,OAAN,CAAc7W,IAAd,CAAJ,EAAyB;AACvB,iBAAKob,YAAL,CAAkBpb,IAAlB;AAED,SAHD,MAGO;AAGL,cAAIA,KAAKqb,cAAT,EAAyBzX,MAAM,WAAS5D,KAAKqb,cAAL,CAAoBC,SAA7B,GAAuC,IAAvC,GAA6Ctb,KAAKqb,cAAL,CAAoBE,OAAjE,GAAyE,kDAA/E,EAAzB,KACK3X,MAAO,8EAAP;AACN;AAEJ,OApBD,EAqBGxD,KArBH,CAqBS,iBAAQ;AACbC,gBAAQC,GAAR,CAAYuD,KAAZ;AACAD,cAAM,uCAAqC,OAAKsD,UAA1C,GAAqD,SAArD,GAA+DrD,MAAMhE,QAArE,GAA8E,UAA9E,GAAyFgE,MAAMkH,UAArG;AACD,OAxBH;AA0BD;;6BAEDqQ,qCAAapb,MAAK;AAChB;AAEE,aAAK+B,EAAL,CAAQsE,OAAR,CAAgB,gCAAsBrG,IAAtB,CAAhB;AACA,aAAKwa,KAAL;AACD;AACF;;6BAEDgB,uCAAc3X,OAAM;AAClBxD,cAAQC,GAAR,CAAY,kCAAZ;AACAD,cAAQC,GAAR,CAAYuD,KAAZ;AACD;;6BAEDuW,yCAAe1V,UAAS;AACtB,WAAKyV,gBAAL,GAAsBzV,SAAS+U,IAA/B;AACA,WAAKnO,KAAL,GAAW5G,SAAS4G,KAApB;AACA,WAAKoO,WAAL,GAAiBhV,SAASgV,WAA1B;AACA,UAAI,CAAC,CAAC,KAAKA,WAAX,EAAwB;AAAE,aAAKI,OAAL,GAAa,KAAb,CAAoB,KAAK2B,gBAAL,CAAsBC,OAAtB,GAA8B,IAA9B;AAAqC;AACpF;;;;0BA/HqB;AACpB,eAAO,KAAKvB,gBAAL,IAAuB,KAAKP,cAAL,CAAoB1T,EAAlD;AACD;;;0BAGoB;AACnB,eAAO,KAAKiU,gBAAL,IAAuB,QAA9B;AACD;;;0BAGwB;AACvB,eAAO,KAAKA,gBAAL,IAAuB,YAA9B;AACD;;;0BAEoB;AACnB,eAAO,KAAKA,gBAAL,IAAuB,QAA9B;AACD;;;0BAEe;AACd,YAAI,KAAKsB,gBAAT,EAA2B,OAAO,KAAKA,gBAAL,CAAsBC,OAA7B;AAC5B;;;;eA9CM/Z,SAAS;;;;;;;;UCHFtE,YAAAA;;;;;;;;;;AAPhBC,UAAQC,MAAR,CAAe;AACbC,qBAAiB,sBAAYL,KADhB;AAEbM,cAAU;AACRC,wBAAkB;AADV;AAFG,GAAf;;AAOO,WAASL,SAAT,CAAmBM,OAAnB,EAA4B;AACjCA,YAAQC,GAAR,CACGC,qBADH,GAEGC,OAFH,CAEW,WAFX;;AAIA,QAAI,sBAAYX,KAAhB,EAAuB;AACrBQ,cAAQC,GAAR,CAAYG,kBAAZ;AACD;;AAED,QAAI,sBAAYX,OAAhB,EAAyB;AACvBO,cAAQC,GAAR,CAAYI,MAAZ,CAAmB,iBAAnB;AACD;;AAEDL,YAAQM,KAAR,GAAgBC,IAAhB,CAAqB;AAAA,aAAMP,QAAQQ,OAAR,EAAN;AAAA,KAArB;AACD;;;;;;;;;;;;;;;MCpBYwd,4BAAAA,oBACX,2BAAYjX,QAAZ,EAAqB;AAAA;;AACnB,SAAKA,QAAL,GAAgBA,QAAhB;AACD;;MAGUkX,2BAAAA,mBACX,0BAAYlX,QAAZ,EAAqB;AAAA;;AACnB,SAAKA,QAAL,GAAgBA,QAAhB;AACD;;MAGUmX,0BAAAA,kBACX,yBAAYnX,QAAZ,EAAqB;AAAA;;AACnB,SAAKA,QAAL,GAAgBA,QAAhB;AACD;;;;;;;;;;;;;;;;;;MCZUoX,0BAAAA;AAGX,6BAAY/Z,EAAZ,EAAgB;AAAA;;AAAA;;AACd,WAAKga,YAAL,GAAoB,KAApB;AACAha,SAAGE,SAAH,8BAAgC;AAAA,eAAO,MAAKkW,cAAL,CAAoBhW,IAAIuC,QAAxB,CAAP;AAAA,OAAhC;AACA3C,SAAGE,SAAH,6BAA+B;AAAA,eAAO,MAAKmY,cAAL,CAAoBjY,IAAIuC,QAAxB,CAAP;AAAA,OAA/B;AACD;;8BAEDsX,qCAAa;AACX,WAAKD,YAAL,GAAoB,IAApB;AACD;;8BAED5D,yCAAezT,UAAS;AAEtB,WAAKqX,YAAL,GAAoB,KAApB;AAED;;8BAED3B,yCAAe1V,UAAS;AAEtB,WAAKqX,YAAL,GAAoB,IAApB;AAED;;;cAtBMpa,SAAS;;;;;;;;;;;;;;;;;;MCGLsa,sBAAAA;AAGX,yBAAY3d,UAAZ,EAAuB;AAAA;;AACrB,WAAK4I,UAAL,GAAkB,qBAAUC,UAAV,KAAuB,iCAAzC;AACA,WAAK+U,cAAL,GAAsB,qBAAU/U,UAAV,KAAuB,+BAA7C;AACA,WAAKnF,MAAL,GAAY1D,UAAZ;AACA,WAAK6d,KAAL,GAAa,EAAb;AACA,WAAKna,MAAL,CAAY3E,SAAZ,CAAsB,kBAAS;AAC7BE,eAAO6J,UAAP,CAAkB,QAAlB,EAA4B,kBAA5B;AACA7J,eAAO6J,UAAP,CAAkB,cAAlB,EAAkC,kBAAlC;AACD,OAHD;AAIA,WAAKgV,YAAL,GAAkB,EAAlB;AACA,WAAKA,YAAL,CAAkB,SAAlB,IAA6B,2CAA7B;AACA,WAAKA,YAAL,CAAkB,SAAlB,IAA6B,0CAA7B;AACD;;0BAED7Z,+BAAW;AAAA;;AAET,WAAKP,MAAL,CAAY2H,GAAZ,CAAgB,KAAKzC,UAArB,EACGhJ,IADH,CACQ,gBAAQ;AACZ,YAAI8B,KAAKH,QAAT,EAAmB;AACjB,gBAAKsc,KAAL,GAAalR,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAb;AACA,cAAIqD,YAAJ;AACA,gBAAKiZ,KAAL,CAAWhR,OAAX,CAAmB,UAASkR,IAAT,EAAc;AAC/BA,iBAAKC,WAAL,GAAmBpZ,KAAKkZ,YAAL,CAAkBC,KAAKvb,IAAvB,KAAgC,EAAnD;AACAub,iBAAKE,QAAL,GAAc,KAAd;AACD,WAHD;AAID;AACF,OAVH,EAWGnc,KAXH,CAWS,iBAAQ;AACbC,gBAAQC,GAAR,CAAY,+BAAZ;AACAD,gBAAQC,GAAR,CAAYuD,KAAZ;AACD,OAdH;AAeD;;0BAED2Y,+BAAUC,OAAO;AACf,UAAIJ,OAAOI,KAAX;AACAJ,WAAKE,QAAL,GAAc,IAAd;AACA,WAAKG,UAAL,CAAgBL,IAAhB,EAAsBne,IAAtB,CAA2B,UAACiE,GAAD,EAAS;AAElCwa,mBAAY,YAAM;AACdN,eAAKE,QAAL,GAAgB,KAAhB;AACAF,eAAKO,OAAL,GAAe,IAAf;AACAP,eAAKQ,QAAL,GAAgB1a,GAAhB;AACA9B,kBAAQC,GAAR,CAAY,mBAAmB+b,KAAKQ,QAApC;AACD,SALH,EAKK,IALL;AAKY,OAPd,EASCzc,KATD,CASO,UAAC0c,MAAD,EAAY;AACfT,aAAKE,QAAL,GAAc,KAAd;AACAlc,gBAAQC,GAAR,CAAY,cAAZ;AACAD,gBAAQC,GAAR,CAAYwc,MAAZ;AACD,OAbH;AAcD;;0BAEDC,6BAASN,OAAM;AACb,UAAIJ,OAAOI,KAAX;AACAJ,WAAKE,QAAL,GAAc,IAAd;AACA,WAAKG,UAAL,CAAgBL,IAAhB,EAAsBne,IAAtB,CAA2B,UAACiE,GAAD,EAAS;AAElCwa,mBAAY,YAAM;AAChBN,eAAKE,QAAL,GAAgB,KAAhB;AACAF,eAAKO,OAAL,GAAe,KAAf;AACD,SAHD,EAGG,IAHH;AAID,OAND,EAOGxc,KAPH,CAOS,UAAC0c,MAAD,EAAY;AACjBT,aAAKE,QAAL,GAAc,KAAd;AACAlc,gBAAQC,GAAR,CAAY,aAAZ;AACAD,gBAAQC,GAAR,CAAYwc,MAAZ;AACD,OAXH;AAYD;;0BAEDJ,iCAAWL,MAAK;AAAA;;AACd,aAAO,IAAI/e,OAAJ,CAAY,UAAC0f,OAAD,EAAUC,MAAV,EAAqB;AACtC,YAAIZ,KAAKO,OAAT,EAAkB;AACf,iBAAK5a,MAAL,CAAYuW,MAAZ,CAAmB,OAAK2D,cAAL,GAAoBG,KAAKvb,IAA5C,EACG5C,IADH,CACQ,gBAAO;AACX8e,oBAAQ,SAAR;AACH,WAHD,EAIG5c,KAJH,CAIS,iBAAO;AACZ6c,mBAAOpZ,KAAP;AACD,WANH;AAOF,SARD,MAQO;AACJ,iBAAK7B,MAAL,CAAY+Q,IAAZ,CAAiB,OAAKmJ,cAAL,GAAoBG,KAAKvb,IAA1C,EACG5C,IADH,CACQ,gBAAM;AACV,gBAAIgf,cAAYjS,KAAKC,KAAL,CAAWlL,KAAKH,QAAhB,CAAhB;AACAmd,oBAAQE,YAAYL,QAApB;AACD,WAJH,EAMGzc,KANH,CAMS,iBAAO;AACZ6c,mBAAOpZ,KAAP;AACD,WARH;AASF;AACF,OApBM,CAAP;AAqBD;;;cA7FMlC,SAAS","file":"app-bundle.js","sourcesContent":["export class App {\n  constructor() {\n\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 10/9/17.\n */\n\n\nlet _singleton = Symbol();\n\nexport class RedirectLogin {\n\n  constructor(rurl = \"/login?next=\" + window.location.pathname) {\n    this.redirectUrl = rurl;\n  }\n\n  handlelogin(){\n    //redirect to another url - presumably with login feature - should redirect back\n    window.location = this.redirectUrl;\n  }\n\n}\n\nexport class ShowLoginButton {\n\n  constructor() {\n  }\n\n  handlelogin(){\n    //show/hide login/logout button only\n    let loginb = document.getElementById(\"loginbutton\");\n    let logoutb = document.getElementById(\"logoutbutton\");\n    //removes style - by default style=display:none\n    logoutb.removeAttribute(\"style\");\n    loginb.removeAttribute(\"style\");\n    loginb.className = \"w3-sign\";\n    logoutb.className = \"w3-hide\";\n  }\n\n}\n\nexport class ShowLogoutButton {\n\n  constructor() {\n  }\n\n  handlelogin(){\n    //show/hide login/logout button only\n    let loginb = document.getElementById(\"loginbutton\");\n    let logoutb = document.getElementById(\"logoutbutton\");\n    //removes style - by default style=display:none\n    logoutb.removeAttribute(\"style\");\n    loginb.removeAttribute(\"style\");\n    loginb.className = \"w3-hide\";\n    logoutb.className = \"w3-sign\";\n  }\n\n}\n\n\nexport class HandleLogin {\n  contructor(senderid) {\n    this.senderid=senderid;\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 3/16/17.\n */\nimport {bindable} from 'aurelia-framework';\n\n/** Navitem component <navitem href=\"reference\">content</navitem> renders <a></a> with styling\n */\nexport class Navitem {\n  @bindable href;\n}\n","/**\n * Created by Tomas Kulhanek on 4/4/17.\n */\n\n\nimport {bindable} from 'aurelia-framework';\nimport {HttpClient} from 'aurelia-fetch-client';\nimport {computedFrom} from 'aurelia-framework';\n\n/** Virtual Folder Autocomplete Search client web component to work with API at ebi.ac.uk\n *\n */\nexport class VfAutocompleteSearch {\n  @bindable value = \"\"; // value of input\n  @bindable placeholder = \"\";\n  @bindable size = \"40\";\n  @bindable submit;\n\n  static inject = [HttpClient];\n\n  constructor(httpclient) {\n    this.http = httpclient;\n    this.config = {\n      resultBoxAlign: 'left',\n      redirectOnClick: false,\n      searchUrl: '//www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select',\n      fields: 'value,num_pdb_entries,var_name',\n      group: 'group=true&group.field=category',\n      groupLimit: '25',\n      sort: 'category+asc,num_pdb_entries+desc',\n      additionalParams: 'rows=20000&json.nl=map&wt=json'\n    }\n  }\n\n  /*hides the suggestion by setting the binded property to false*/\n  hideSuggestions() {\n      this.showing=false;\n  }\n\n  /* check if blured to related element, then no hiding, otherwise hide*/\n  blurSuggestions(evt) {\n    if (evt.relatedTarget && evt.relatedTarget.className.startsWith('result-card-item')) return;\n    this.hideSuggestions();\n  }\n\n  /* show the suggestions by setting the binded proparty to true*/\n  showSuggestions() {\n    this.showing=true;\n  }\n\n  /* reset the value in input field and shows */\n  focusSuggestions() {\n    this.value=\"\";\n    this.showSuggestions();\n  }\n\n  /**\n   * Method to search via AJAX call for the suggestion items which will be shown\n   */\n  search(){\n    let term = this.value;\n    let config = this.config;\n    let url = `${config.searchUrl}?${config.additionalParams}&${config.group}&fl=${config.fields}&sort=${config.sort}&group.limit=${config.groupLimit}&q=value:${term}*~10`\n    return this.http\n      .fetch(url)\n      .then(response => response.json())\n      .then(data => {\n        //console.log(\"search response:\")\n        //console.log(data);\n        this.resultGroups= data.grouped.category.groups\n        //console.log(this.resultGroups);\n      })\n      .catch( err => {console.log('error search()');console.log(err)});\n  }\n\n  /* just compute if the results group is empty */\n @computedFrom('resultGroups')\n get resultGroupsEmpty() {\n   return this.showing && this.resultGroups && this.resultGroups.length == 0;\n }\n\n /**\n  * Method triggered when a key is pressed,\n  * enter = submit, esc= hide suggestion\n  * @param {event} DOM event holding key pressed */\n keypressed(evt){\n   let key = evt.keyCode;\n   if (key === 13) {\n     /*may not be updated with input field as debounce has 750 ms this.submit({item:this.value});\n      */\n     //console.log(\"keypressed(): submitting()\")\n     //this.hideSuggestions();\n     if (evt.originalTarget) this.submit({item: {Name:evt.originalTarget.value}}) //in Firefox\n     else if (evt.target) this.submit({item: {Name:evt.target.value}}) //in IE\n     this.hideSuggestions();\n   } else\n     if (key===27) this.hideSuggestions();\n   else\n     this.showSuggestions();\n\n   return true;\n }\n\n  /**\n   * Method triggered when a suggestion item was clicked,\n   * therefore taking it's value, submit and hide\n   * @param {clickvalue} value which was clicked and will be submitted */\n  clicked(clickvalue) {\n    //console.log(\"clicked(): submitting()\")\n    //console.log(clickvalue);\n    this.value = clickvalue.value;\n    this.submit({item:{Name:clickvalue.value,Type:clickvalue.var_name}});\n    this.hideSuggestions();\n  }\n\n  /**\n   * Method triggered by AU when a value in input field is changed,\n   * using debounce - it is triggered only after some delay (750ms) */\n  valueChanged(newValue,oldValue){\n    if (this.value && this.value.length>0) {\n      this.search();\n\n    }\n  }\n\n /**\n  * Method to search for more suggestions api call\n  * @param {filter} a name of the group to be filtered\n  */\n  searchMore(filter) {\n    let term = this.value;\n      let fqVal = filter;\n        let config=this.config;\n    let url = `${config.searchUrl}?${config.additionalParams}&${config.group}&fl=${config.fields}&sort=${config.sort}&group.limit=-1&q=value:${term}*~10&fq=var_name:${fqVal}`\n    return this.http\n    //.get(`${this.pdbSolrUrl}&group.limit=-1&q=value:${term}*~10&fq=var_name:${fqVal}`)\n      .fetch(url)\n      .then(response => response.json())\n      .then(data => {\n        this.resultGroups= data.grouped.category.groups\n      })\n      .catch( err => {console.log('error searchMore()'); console.log(err);});\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 2/21/17.\n */\n\nexport class App {\n\n  constructor () {\n  }\n\n\n}\n","export default {\n  debug: false,\n  testing: false\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n/**\n * Created by root on 3/10/17.\n */\n","/**\n * Created by Tomas Kulhanek on 2/17/17.\n */\n\nimport * as CodeMirror from \"codemirror\";\nimport \"codemirror/mode/clike/clike\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/javascript/javascript\";\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {HttpClient} from 'aurelia-fetch-client';\nimport {EditFile} from '../filepicker/messages';\nimport {bindable} from 'aurelia-framework';\nimport {Vfstorage} from '../utils/vfstorage';\n\n//import $ from 'jquery';\n\n\nexport class Fileeditor {\n  static inject = [Element,EventAggregator, HttpClient];\n  @bindable pid;\n\n  constructor(el,ea,httpclient) {\n    this.el = el;\n    this.ea = ea;\n    this.client = httpclient;\n    this.ea.subscribe(EditFile, msg => this.selectFile(msg.file,msg.senderid));\n    this.isimage=false;\n    this.filename=\"\";\n  }\n\n  attached() {\n    let editor = this.el.querySelector(\".Codemirror\");\n    //prevent blured render if not shown before\n    if (editor==null)    this.codemirror = CodeMirror.fromTextArea(this.cmTextarea, {\n      lineNumbers: true,\n      mode: \"text/x-less\",\n      lineWrapping: true,\n      theme: \"eclipse\"\n    });\n    this.codemirror.refresh();\n  }\n\n  selectFile(file,senderid) {\n    let that =this\n    if (senderid!=this.pid) {\n      this.imageurl = file.webdavuri;\n      //visualizeimg is set & image extension is detected\n      //console.log(\"fileeditor.selectfile() visualizeimg: isimage:\")\n      //console.log(localStorage.getItem(\"visualizeimg\"));\n      //vfstorage returns string - should convert to boolean\n      this.isimage = (Vfstorage.getValue(\"visualizeimg\") == \"true\") &&\n      ((file.name.endsWith('.JPG'))||\n      (file.name.endsWith('.jpg'))||\n      (file.name.endsWith('.PNG'))||\n      (file.name.endsWith('.png'))||\n      (file.name.endsWith('.GIF'))||\n      (file.name.endsWith('.gif'))||\n      (file.name.endsWith('.BMP'))||\n      (file.name.endsWith('.bmp'))||\n      (file.name.endsWith('.SVG'))||\n      (file.name.endsWith('.svg')));\n\n      //console.log(\"fileeditor.selectfile() visualizeimg: isimage:\")\n      //console.log(this.isimage);\n      if (!this.isimage)\n        this.client.fetch(file.webdavuri, {credentials: 'same-origin'})\n          .then(response => response.text())\n          .then(data =>{\n\n            console.log(\"fileeditor.selectfile() loading:\" + file.webdavuri);\n            console.log(data);\n            that.codemirror.setValue(data);\n            that.filename=file.webdavuri;\n          }\n        ).catch(error => {\n          alert('Error retrieving content from ' + file.webdavuri);\n          console.log(error);\n        });\n\n    }\n  }\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from '../filepicker/messages';\nimport {computedFrom} from 'aurelia-framework';\nimport {DialogService} from 'aurelia-dialog';\nimport {inject} from 'aurelia-framework';\nimport {Prompt} from './fmsettings';\nimport {HandleLogin} from '../behavior';\nimport {ShowLoginButton} from '../behavior'\n\n//@inject(DialogService)\n\nexport class App {\n  static inject = [EventAggregator,DialogService];\n\n  constructor(ea,dialogService) {\n    this.ea = ea;\n    this.handler = new ShowLoginButton();\n    this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file,msg.senderid));\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n    this.dialogService=dialogService;\n  }\n\n  selectFile(file,senderid){\n    //console.log(\"selectFile()\")\n    //console.log(file);\n    //console.log(senderid);\n    //window.opener.postMessage(window.location.protocol+\"//\"+window.location.hostname+file.webdavuri, \"*\");\n    //window.close();\n  }\n\n  closeviewer(){\n  }\n\n  setupFileManager(){\n    this.dialogService.open({viewModel: Prompt, model: 'File Manager Settings' }).then(response => {\n      //console.log(response);\n\n      if (!response.wasCancelled) {\n        //console.log('dialog OK');\n      } else {\n        //console.log('dialog cancelled');\n      }\n      //console.log(response.output);\n    });\n  }\n\n}\n","export default {\n  debug: true,\n  testing: false\n};\n","/**\n * Created by Tomas Kulhanek on 6/16/17.\n */\nimport {inject} from 'aurelia-framework';\nimport {DialogController} from 'aurelia-dialog';\nimport {Vfstorage} from '../utils/vfstorage';\n\n@inject(DialogController)\n\nexport class Prompt {\n\n  constructor(controller){\n    this.controller = controller;\n    this.answer = null;\n    controller.settings.centerHorizontalOnly = true;\n  }\n\n  activate(message) {\n\n    this.visualizepdb = Vfstorage.checkDefault(\"visualizepdb\",\"true\") == \"true\"; //localstorage stores string instead of bool - convert to bool\n    this.visualizeimg = Vfstorage.checkDefault(\"visualizeimg\",\"true\") == \"true\";\n    //console.log(\"active visualizepdb:\"+this.visualizepdb);\n    this.message = message;\n    this.log(\"activate.post\");\n  }\n\n  close(){\n    if (typeof(Storage) !== \"undefined\") {\n      Vfstorage.setValue(\"visualizepdb\",this.visualizepdb);\n      Vfstorage.setValue(\"visualizeimg\",this.visualizeimg);\n    }\n    this.log(\"close\");\n    this.controller.ok()\n  }\n\n  log(method){\n    console.log(\"Fmsettings.\"+method+\"(), visualizepdb, visualizeimg\")\n    console.log(this.visualizepdb);\n    console.log(localStorage.getItem(\"visualizepdb\"));\n    console.log(this.visualizeimg);\n    console.log(localStorage.getItem(\"visualizeimg\"));\n\n  }\n\n}\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .plugin('aurelia-dialog')\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 2/10/17.\n */\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile,VisualizeFile,EditFile,DatasetFile} from '../filepicker/messages';\nimport {SelectedTab} from '../tabs/messages';\nimport {bindable} from 'aurelia-framework';\n\nexport class Panel {\n    static inject = [EventAggregator];\n    @bindable pid;\n\n    constructor(ea) {\n        this.ea = ea;\n\n        this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file,msg.senderid));\n        this.ea.subscribe(SelectedTab, msg => this.selectTab(msg.tabid));\n        //generate unique id from time\n        //this.pid = new Date().valueOf();\n        this.selectedView=this.selectedVisual=this.selectedDataset=false;\n        this.selectedList=true;\n    }\n\n    bind(){\n      this.ids=[this.pid+'.list',this.pid+'.view',this.pid+'.visual',this.pid+'.analyse',this.pid+'.dataset']; //prefix uid to tab ids\n\n      this.selectedTab= this.ids[0];\n      this.paneltabs = [\n        { id: this.ids[0], label: 'File List'},\n        { id: this.ids[1], label: 'View/Edit'},\n        { id: this.ids[2], label: 'Visualize'},\n        { id: this.ids[3], label: 'Dataset'}\n      ];\n    }\n\n    selectTab(tabid){\n        //if uid belongs to mine - change tab, otherwise ignore this message\n        if (tabid.startsWith(this.pid)) {\n            this.selectedTab = tabid;\n            this.selectedList = this.selectedTab == this.ids[0];\n            this.selectedView = this.selectedTab == this.ids[1];\n            this.selectedVisual = this.selectedTab == this.ids[2];\n            this.selectedDataset = this.selectedTab == this.ids[3];\n        }\n    }\n\n    selectFile(file,senderid) {\n      //default action, visualize pdb, if localStorage.getItem(\"visualizepdb\") is defined then it needs to be true,\n      let showpdb = (file.webdavuri.endsWith('pdb') || file.webdavuri.endsWith('ent') || file.webdavuri.endsWith('cif')) ? (typeof(Storage) !== \"undefined\") ? localStorage.getItem(\"visualizepdb\") ? localStorage.getItem(\"visualizepdb\") === \"true\" : true : true : false;\n      if (senderid!=this.pid) {\n        if (this.selectedDataset) { //add to dataset\n          this.ea.publish(new DatasetFile(file,senderid));\n        }\n        else //visualize/show file\n        if (showpdb) {\n          //visualize\n          this.selectTab(this.ids[2]);\n          this.ea.publish(new VisualizeFile(file,senderid));\n        } else {\n          //edit/raw view\n          this.selectTab(this.ids[1]);\n          this.ea.publish(new EditFile(file,senderid));\n        }\n      }\n    }\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from './messages';\nimport {HandleLogin} from '../behavior';\nimport {RedirectLogin} from '../behavior';\n\nexport class App {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.ea = ea;\n    this.handler = new RedirectLogin();\n    this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file));\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n  }\n\n  selectFile(file){\n    window.opener.postMessage(window.location.protocol+\"//\"+window.location.hostname+file.publicwebdavuri, \"*\");\n    window.close();\n  }\n\n}\n","export default {\n  debug: true,\n  testing: false\n};\n","/**\n * created by Tomas Kulhanek on 9/28/16.\n */\n\nimport 'whatwg-fetch';\nimport {HttpClient} from 'aurelia-http-client';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from './messages';\nimport {HandleLogin} from '../behavior';\n\nimport {bindable} from 'aurelia-framework';\nimport {Vfstorage} from '../utils/vfstorage';\n\nimport {Pdbresource} from './pdbresource';\nimport {Uniprotresource} from './uniprotresource';\n\nexport class Filepanel{\n  static inject = [EventAggregator,HttpClient,Pdbresource,Uniprotresource];\n  @bindable panelid;\n\n  constructor(ea,httpclient,pdbresource,uniprotresource) {\n        this.ea = ea;\n        this.client = httpclient;\n        this.files = [];\n        this.path= \"\";\n        this.lastpath=this.path;\n        this.dynatable = {};\n\n        this.serviceurl = Vfstorage.getBaseUrl()+ \"/metadataservice/files\";\n        //http to accept json\n        this.client.configure(config=>{\n            config.withHeader('Accept','application/json');\n            config.withHeader('Content-Type','application/json');\n        });\n        //console.log(\"filepanel tableid:\"+this.panelid);\n        this.getpublicwebdavurl=\"/api/authproxy/get_signed_url/\"\n        this.sorted = {none:0,reverse:1,byname:2,bydate:4,bysize:8,byext:16}\n        this.wassorted=this.sorted.none;\n        this.baseresources=[{name:\"PDB\",info:\"Protein Data Bank repository entries from ebi.ac.uk\",id:\"pdb\"}]\n        this.resources =[];\n        //this.ea.subscribe(PopulateResources, msg => this.populateResource(msg.resources,msg.senderid));\n        this.filescount = this.files.length + this.resources.length;\n        this.isPdb=this.isUniprot=false;\n        this.pdbresource=pdbresource;\n        this.uniprotresource=uniprotresource;\n        this.isFiles=true;\n        this.selectedResources=[];\n    }\n\n    bind(){\n      this.path = Vfstorage.getValue(\"filepanel\" + this.panelid,\"\");\n      if (this.path==\"\") this.resources=this.baseresources;\n        //localStorage && (localStorage.getItem(\"filepanel\" + this.panelid)) ? localStorage.getItem(\"filepanel\" + this.panelid) : \"\";\n      this.lastpath=\"\";\n    }\n\n    sortByX(sortflag,sortfunction){\n      //console.log(\"Filepanel sort\");\n      //console.log(this.files);\n      if (this.path.length>0) {//non root path\n        this.files.shift(); //take the first '..'\n      }\n\n      //sort by name if previously not this.sorted by name\n      if (!(this.wassorted & sortflag)) {\n        this.files.sort(sortfunction)\n        this.wassorted = sortflag;\n      } else {\n        //if previously reversed\n        if (this.wassorted & this.sorted.reverse) {\n          this.files.reverse(); //reverse again\n          this.wassorted = sortflag;\n        } else { //not reversed - reverse and set flag\n          this.files.reverse();\n          this.wassorted = this.wassorted | this.sorted.reverse;\n        }\n      }//sort(function(a,b){return a.name>b.name?-1:1;})\n      if (this.path.length>0) {//non root path add the first '..'\n        this.addUpDir()\n      }\n      //this.wassorted = this.wassorted | sortflag;\n      //console.log(this.files);\n    }\n\n    addUpDir(){\n      this.files.unshift({name: \"..\", nicesize: \"UP-DIR\",date:\"\",available:true}); //up dir item\n    }\n\n    sortByName(){\n      this.sortByX(this.sorted.byname,function(a,b){return a.name>b.name?1:-1;})\n    }\n\n    sortBySize(){\n      this.sortByX(this.sorted.bysize,function(a,b){return a.size-b.size})\n    }\n    sortByDate(){\n      this.sortByX(this.sorted.bydate,function(a,b){return a.date>b.date?1:-1;})\n    }\n\n    extension(filename){\n      var re = /(?:\\.([^.]+))?$/;\n      return re.exec(filename)[1];\n    }\n\n    sortByExt(){\n      this.sortByX(this.sorted.byext,function(a,b){return a.ext>b.ext?1:-1;})\n    }\n\n    //triggered after this object is placed to DOM\n    attached() {\n\n        //read the directory infos\n        this.client.get(this.serviceurl+this.path)\n            .then(data => {\n                if (data.response) {\n                    this.populateFiles(data.response);\n                }\n            }).catch(error => {\n                //handle 403 unauthorized\n                if (error.statusCode == 403) {\n                  //try to login\n                  //console.log(\"redirecting\");\n                  this.ea.publish(new HandleLogin(this.panelid));\n                  //window.location = \"/login?next=\" + window.location.pathname;\n                  //window.location =\n                } else {\n                  //console.log('Filepanel Error retrieving from \"'+this.path+'\":');\n                  //console.log(error);\n                  //try empty path\n                  if (this.path && this.path.length>0){\n                    this.path=\"\";\n                    this.client.get(this.serviceurl+this.path)\n                      .then(data => {\n                        if (data.response) {\n                          this.populateFiles(data.response);\n                        }\n                      }).catch(error => {\n                      console.log('Filepanel Error retrieving file info from \"'+this.path+'\":');\n                      console.log(error);\n                    });\n                    }\n                  }\n                  //alert('Sorry, response: ' + error.statusCode + ':' + error.statusText + ' when trying to get: ' + this.serviceurl);\n            });\n      //console.log(\"filepanel tableid:\"+this.panelid);\n    }\n\n    //parse .NET encoded Date in JSON\n    dateTimeReviver(key, value) {\n        var a;\n        if (typeof value === 'string') {\n            a = /\\/Date\\(([\\d\\+]*)\\)\\//.exec(value);\n            if (a) {\n                return new Date(parseInt(a[1])).toLocaleDateString(navigator.language?navigator.language:\"en-GB\");\n            }\n        }\n        return value;\n    }\n\n    //removes last subdirectory\n    cdup(){\n        this.lastpath= this.path;\n        let sepIndex= this.path.lastIndexOf('/');\n        this.path = this.path.substring(0,sepIndex);\n      if (this.path==\"\") this.resources=this.baseresources;\n    }\n\n    //adds subdirectory to the path\n    cddown(subdir) {\n      this.lastpath=this.path;\n        this.path+='/'+subdir;\n      this.resources=[];\n    }\n\n    cdroot(){\n      this.lastpath= this.path;\n      this.path = \"\";\n      this.resources=this.baseresources;\n      this.isFiles=true;\n      this.isUniprot=false;\n      this.isPdb=false;\n    }\n\n    //goes to the root\n    goroot(){\n      this.changefolder(\"/\");\n    }\n\n\n    //change folder, reads the folder content and updates the table structure\n    changefolder(folder){\n        if (!this.lock) {\n            this.lock = true;\n            if (folder) {\n                if (folder == '..') this.cdup();\n                  else if (folder == '/') this.cdroot();\n                else this.cddown(folder);\n            }\n\n          this.client.get(this.serviceurl + this.path)\n                .then(data => {\n                    if (data.response) {\n                        this.populateFiles(data.response);\n                        //update files in table view\n                    }\n                    this.lock = false;\n                }).catch(error => {\n            if (error.statusCode == 403) {\n              this.lock = false;\n              this.path = this.lastpath;\n              this.ea.publish(new HandleLogin(this.panelid));\n            } else {\n              console.log('Error');\n              console.log(error);\n              alert('Sorry, response: ' + error.statusCode + ':' + error.statusText + ' when trying to get: ' + this.serviceurl + this.path);\n              this.lock = false;\n              this.path = this.lastpath;\n            }\n            });\n        } //else doubleclick when the previous operation didn't finished\n    }\n\n    //refresh the file content\n    refresh() {\n        this.changefolder(); //changefolder with empty folder - just refresh\n    }\n\n    //parses response and fills file array with customization (DIRS instead of size number)\n    populateFiles(dataresponse){\n      //console.log(\"filepanel.populateFiles()\")\n      Vfstorage.setValue(\"filepanel\" + this.panelid,this.path);\n\n        this.files = JSON.parse(dataresponse);//,this.dateTimeReviver);//populate window list\n        this.filescount =  this.files.length+this.resources.length;\n        let that = this;\n        this.files.forEach (function (item,index,arr){\n          if(!arr[index].name && arr[index].alias) {\n            arr[index].name=arr[index].alias;\n            arr[index].attributes = 16;\n            arr[index].date=\"\";\n            arr[index].filetype=8;\n          }\n          //console.log(arr[index]);\n          arr[index].ext=that.extension(arr[index].name); //may return undefined\n          arr[index].nicedate=that.dateTimeReviver(null,arr[index].date);\n          if (!arr[index].ext) arr[index].ext=\"\";\n          arr[index].available = !!(arr[index].filetype & 8); //available if the filetype attribute contains flag 8\n          if (arr[index].attributes & 16) arr[index].nicesize=\"DIR\";\n          else\n            //convert to 4GB or 30MB or 20kB or 100b\n            arr[index].nicesize=~~(arr[index].size/1000000000)>0?~~(arr[index].size/1000000000)+\"GB\":(~~(arr[index].size/1000000)>0?~~(arr[index].size/1000000)+\"MB\":(~~(arr[index].size/1000)>0?~~(arr[index].size/1000)+\"kB\":arr[index].size+\" b\"));\n        });\n      if (this.path.length>0) {//non root path\n        this.addUpDir();\n      }\n\n    }\n\n    selectFile(file){\n      //console.log(\"selectFile(\"+file+\") panelid:\"+this.panelid);\n      if (file.nicesize.endsWith && file.nicesize.endsWith('DIR')) this.changefolder(file.name);\n      else {\n\n        //HEAD the file - so it can be obtained - cached by metadata service, fix #45\n        let fileurl=this.serviceurl + this.path + '/' + file.name\n        this.client.head(fileurl)\n          .then( response =>{\n            //console.log('file head'+fileurl);\n            //console.log(response);\n          }\n        ).catch(error => {\n          console.log(\"Error when geting metadata information about file:\")\n          console.log(error);\n        });\n\n        //constructs public url\n        this.client.get(this.getpublicwebdavurl)\n          .then(data => {\n            if (data.response) {\n              let mypath2=JSON.parse(data.response);\n              let mypath = mypath2.signed_url;\n              mypath+= this.path.startsWith('/')?this.path.slice(1):this.path;\n              file.publicwebdavuri=mypath+\"/\"+file.name;\n              this.ea.publish(new SelectedFile(file, this.panelid));\n              //this.ea.publish(new SelectedFile(file,this.panelid));\n            }\n          });\n      }\n    }\n\n    selectResource(resource){\n      if (resource.id==\"\") {this.goroot(); return;}\n      if (resource.url) {\n        console.log(\"select resource\");\n        let file=resource;\n        //fix: blocked content from http - origin page at https\n        if ( window.location.protocol==\"https:\" && file.url.startsWith(\"http:\"))  file.url = file.url.replace(\"http:\",\"https:\");\n\n        file.webdavuri=file.url;\n        file.publicwebdavuri=file.url;\n        this.ea.publish(new SelectedFile(file, this.panelid));\n        return\n      }\n      this.isPdb = (resource.id==\"pdb\");\n      this.isUniprot = (resource.id==\"uniprot\");\n      this.isFiles=!(this.isPdb || this.isUniprot);\n      let that=this;\n      //console.log(that);\n      if (this.isPdb) this.resources=this.pdbresource.selectResource(resource,that);\n      if (this.isUniprot) this.resources=this.uniprotresource.selectResource(resource,that);\n      //this.files = [];\n      if (!this.isFiles) this.files=[];\n      this.filescount =  this.files.length+this.resources.length;\n    }\n\n    appendResources(resources){\n      //append resources to existing array\n      this.resources.push(...resources);\n      this.filescount =  this.files.length+this.resources.length;\n    }\n//TODO introduce key based navigation - letter will highlight first file beginning on the letter pressed,\n// up, down left right keys will move cursor\n\n  keypressed(evt){\n    let key = evt.keyCode;\n    console.log(\"keypressed:\"+key);\n    if (key === 13) {\n      /*may not be updated with input field as debounce has 750 ms this.submit({item:this.value});\n       */\n      //console.log(\"keypressed(): submitting()\")\n      //this.hideSuggestions();\n      if (evt.originalTarget) this.submit({item: {Name:evt.originalTarget.value}}) //in Firefox\n      else if (evt.target) this.submit({item: {Name:evt.target.value}}) //in IE\n      //this.hideSuggestions();\n    } else\n    if (key===27) this.escape();\n    return true;\n  }\n}\n\n\n\n\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class SelectedFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class VisualizeFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class EditFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class DatasetFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class PopulateResources {\n  constructor(resources,senderid){\n    this.resources = resources;\n    this.senderid=senderid;\n  }\n}\n","/**\n * Created by vagrant on 9/12/17.\n */\nimport {bindable} from 'aurelia-framework';\nimport {Pdbresource} from './pdbresource';\nexport class Pdbpanel {\n  @bindable panelid;\n  static inject = [Pdbresource];\n\n  constructor(pdbresource) {\n    this.resources=[];\n    this.currentpath=\"\";\n    this.id=\"pdb\";\n    this.impl=pdbresource;\n  }\n\n  attached(){\n    this.resources=this.impl.populateResource({name:this.currentpath,id:this.id});//select root\n  }\n\n  //distinguishes what to do\n  selectResource(resource){\n    if (resource.name==\"..\") {\n      if (this.currentpath.endsWith(\"*\")) this.resources=this.impl.populateResource({name:this.currentpath.slice(0,-2),id:this.id})\n      else this.resources=this.impl.populateResource({name:this.currentpath.slice(0,-1)+\"*\", id:this.id})\n    } else\n      this.resources=this.impl.populateResource(resource)\n  }\n\n\n}\n\n","/**\n * Created by Tomas Kulhanek on 9/13/17.\n */\n\n//import {HttpClient} from 'aurelia-http-client';\nimport {HttpClient} from 'aurelia-fetch-client'; //fetch\n\nexport class Pdbresource {\n  static inject = [HttpClient];\n\n  constructor(httpclient) {\n    this.client=httpclient;\n    this.requesturlpdbid=\"//www.ebi.ac.uk/pdbe/search/pdb/select?rows=100&wt=json&sort=pdb_id+desc&q=pdb_id:\";\n    this.requesturlnums=\"//www.ebi.ac.uk/pdbe/search/pdb/select?rows=0&wt=json&sort=pdb_id+desc&q=pdb_id:\";\n    this.requesturlfiles=\"//www.ebi.ac.uk/pdbe/api/pdb/entry/files/\";\n    this.pdbredourl = \"//pdb-redo.eu/db/\";\n    this.pdbredosuffixes = [\"_final.pdb\",\"_final.mtz\",\"_besttls.pdb.gz\",\"_besttls.mtz.gz\",\"_scenes.tar.bz2\",\".zip\"]\n  }\n\n  static cdup(resource) {\n    //12* -> 1*\n    let myresource = {};\n    myresource.name= resource.link.endsWith(\"*\")? resource.link.slice(0,-2)+\"*\":resource.link.slice(0,-1)+\"*\";\n    myresource.id = resource.id;\n    myresource.link= myresource.name.slice(0,-2)+\"*\";\n    return myresource;\n  }\n\n  //distinguishes what to do\n  selectResource(resource,callback){\n    console.log(\"selectResource .. :\");\n    console.log(resource);\n\n    if (resource.name==\"..\") {\n      console.log(\"selectResource .. :\");\n      console.log(resource);\n      //go up one level\n      return this.populateResource(Pdbresource.cdup(resource),callback);\n      /*if (resource.link.endsWith(\"*\"))\n        return this.populateResource({name:resource.link,link:resource.link.slice(0,-2)+\"*\",id:resource.id})\n\n      else if (resource.link==\"PDB\" || resource.link==\"\")\n        return this.populateResource({name:resource.link,link:resource.link.slice(0,-1)+\"*\", id:resource.id})*/\n    } else\n      return this.populateResource(resource,callback)\n  }\n\n//populates level of virtual folders\n  populateResource(resource,callback) {\n    //console.log(\"populateResource():\");\n    //console.log(resource);\n    //console.log(this)\n    let resources = [];\n    let that = this;\n\n    //first level of pdb browsing generates 1* -9*\n    function push1_9() {\n      resources.push({name: \"..\", info: \"UP-DIR\", id: \"\"});\n      for (var i = 1; i < 10; i++) {\n        resources.push({name: i + \"*\", info: \"pdb entries begining with '\" + i + \"'\", id: resource.id});\n      }\n    }\n\n    //second and third level of browsing generates 10* -1z* and 5a0* -5az*\n    function push0_9a_z(prefix) {\n      {\n        resources.push({name: \"..\", info: \"UP-DIR\", id: resource.id,link:resource.name});\n\n        //let queryurl = that.requesturlpdbid+resource.name;\n\n        for (let i = 0; i <= 9; i++){\n\n          that.client.fetch(that.requesturlnums+ prefix + i + \"*\")\n            .then(response => response.json())\n            .then(data => {\n              //console.log(data)\n              let resources2 = [];\n              if (data.response && data.response.numFound) {\n                resources2.push({name:data.responseHeader.params.q.slice(7),info:\"(\"+data.response.numFound+\")\",id:resource.id})\n              }\n              //do callback\n              callback.appendResources(resources2);\n            });\n        }\n          //resources.push({name: prefix + i + \"*\", info: \"\", id: resource.id})\n        for (let i = 'a'.charCodeAt(0); i <= 'z'.charCodeAt(0); i++) {\n\n          that.client.fetch(that.requesturlnums+ prefix + String.fromCharCode(i) + \"*\")\n            .then(response => response.json())\n            .then(data => {\n              //console.log(data)\n              let resources2 = [];\n              if (data.response && data.response.numFound>0) {\n                resources2.push({name:data.responseHeader.params.q.slice(7),info:\"(\"+data.response.numFound+\")\",id:resource.id})\n              }\n              //do callback\n              callback.appendResources(resources2);\n            });\n        }\n      }\n    }\n\n    //generates last level e.g. 2hhd with\n    function check0_9a_z(prefix) {\n      {\n        console.log(\"check0_9a_z\");\n        resources.push({name: \"..\", info: \"UP-DIR\", id: resource.id,link:resource.name});\n        let queryurl = that.requesturlpdbid+resource.name;\n        that.client.fetch(queryurl)\n          .then(response => response.json())\n          .then(data => {\n              //console.log(data)\n              let resources2 = [];\n              if (data.response && data.response.docs) {\n\n                  for (let item of data.response.docs) {\n                    item.id=resource.id;item.name= item.pdb_id; item.info = item.title;resources2.push(item);\n                  }\n              }\n              //do callback\n              callback.appendResources(resources2);\n            });\n      }\n    }\n\n    function getlisttodownload(pdbid){\n      console.log(\"getlisttodownload\");\n      resources.push({name: \"..\", info: \"UP-DIR\", id: resource.id,link:resource.name});\n      let queryurl = that.requesturlfiles+pdbid;\n      //get links to pdb files\n      that.client.fetch(queryurl)\n        .then(response => response.json())\n        .then(data => {\n          console.log(data);\n          let resources2 = [];\n          Object.keys(data).forEach(key =>{ //traverse via pdb name e.g. \"2hhd\"\n            Object.keys(data[key]).forEach(key2 => { // traverse via \"PDB\",\"assembly\",\"validation\",\"SIFTS\",\"molecule\"\n              for (let item of data[key][key2].downloads) {\n                item.id = resource.id;\n                item.name = item.url.substr(item.url.lastIndexOf(\"/\")+1);\n                item.info = key2+\":\"+item.label;\n                resources2.push(item);\n              }\n            })\n          });\n          //loopNestedObj(data);\n          callback.appendResources(resources2);\n        });\n\n      //get link to pdb redo files\n      queryurl = that.pdbredourlfiles+pdbid;\n\n      that.client.fetch(queryurl, {method:'head'})\n        .then(response => {\n          console.log(response);\n          let resources2 = [];\n          for (let suffix of that.pdbredosuffixes) {\n                let item = {};\n                //all url except for (.zip) are /pdbid/pdbid.suffix\n                item.url=that.pdbredourl+pdbid+(suffix == \".zip\"? \"\": \"/\"+pdbid)+suffix;\n                item.id = resource.id;\n                item.name = item.url.substr(item.url.lastIndexOf(\"/\")+1);\n                item.info = \"PDB REDO files \"+suffix;\n                resources2.push(item);\n              }\n          callback.appendResources(resources2);\n        });\n\n      //TODO get links to BMRB files http://bmrb.cerm.unifi.it/search/simplesearch.php?dbname=PDB&pdbid=2hhd&show_bmrbid=on&output=html\n    }\n\n    if (resource.name == \"\" || resource.name == \"PDB\" || resource.name==\"*\") push1_9();\n\n    else if (resource.name.endsWith(\"*\")) {\n      if (resource.name.length<4) push0_9a_z(resource.name.slice(0, -1));\n      else check0_9a_z(resource.name.slice(0, -10))\n    } else getlisttodownload(resource.name);\n    //console.log(resources[1].name);\n    return resources;\n  }\n}\n","/**\n * Created by vagrant on 9/12/17.\n */\nimport {bindable} from 'aurelia-framework';\nexport class Uniprotpanel {\n  @bindable panelid;\n  constructor() {\n  }\n}\n\n","/**\n * Created by TomasKulhanek on 9/13/17.\n */\n\nexport class Uniprotresource {\n  constructor() {\n\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 5/19/17.\n */\nimport {bindable} from 'aurelia-framework';\nimport {HttpClient} from 'aurelia-fetch-client'; //fetch\n\n/** Checkurl component <checkurl url=\"some url\">content</checkurl>\n * checks the url provided in url attribute,\n * if the HEAD request returns HTTP 200, then the content inside the component is\n * added into the resulting DOM, otherwise no DOM is rendered and no further processing\n * performed -e.g. subsequent calls to the url etc.\n */\nexport class Checkurl {\n  static inject = [HttpClient];\n  @bindable failmessage=\"No data available for this structure.\";\n  @bindable url;\n  constructor(httpclient){\n    this.client = httpclient;\n    this.showit=false;\n    //this.message=\"\";\n  }\n\n  attached(){\n    //console.log(\"Checkurl component:\"+this.url+\" message:\"+this.failmessage);\n\n    this.client.fetch(this.url, {method: 'HEAD'})\n      .then(response => {\n        //console.log(\"checkurl response:\");\n        //console.log(response);\n        if (response.status==200) this.showit=true;\n        //this.message = this.failmessage;\n      })\n      .catch(error =>{\n        this.showit=false;\n        console.log('checkurl error:'+error);\n        //this.message = this.failmessage;\n      });\n  }\n\n}\n\n","/**\n * created by Tomas Kulhanek on 3/15/17.\n */\nimport {bindable} from 'aurelia-framework';\nimport {HttpClient} from 'aurelia-fetch-client'; //fetch\n\n/**\n * Dataitem is specifical integration of PDB, Uniprot or other type of item in a dataset\n * integrates pdb components of ebi.ac.uk\n */\nexport class Dataitem {\n\n  static inject = [HttpClient];\n  @bindable item = \"\";\n\n  constructor(httpclient) {\n    //console.log('dataitem()')\n    //console.log(this.item);\n    this.serviceurl = \"//www.ebi.ac.uk/pdbe/api/pdb/entry/molecules/\"\n    this.client = httpclient;\n\n    this.entityids = [1];\n    this.selectedid = this.entityids[0];\n    this.showitem = false;\n    let location = window.location.protocol;\n    //this.pdbred=\"cc\";\n//    this.httpsprotocol=location.startsWith('https'); //used to detect/hide buggy components\n  }\n\n  bind() {\n    //console.log(\"dataitem.bind()\");\n    //console.log(this.item);\n    this.itemPDBEntry = this.isPDBEntry();\n    //this.pdbredo = this.item[1]+this.item[2]; //2nd and 3rd character\n    //console.log(this.pdbredo);\n    //this.showitem = this.itemPDBEntry;\n    //this.showuniprotitem = !this.itemPDBEntry;\n    this.itemUniprotEntry = this.isUniprotEntry();\n    if (this.itemPDBEntry) {\n\n      this.client.fetch(this.serviceurl + this.item.Name)\n        .then(response => response.json())\n        .then(data => {\n\n          //console.log(\"ENTRY ID Fetch, data:\");\n          //console.log(data)\n          this.entityids=[];\n          for (var entryname in data) {  //data.2hhd data.4yg0 data.1cbs data.{ }   for (var ... in ...) { } //enumeration\n            for (let item of data[entryname]) { //data[{}] == data[2hhd] == data.2hhd, for (let ... of ...)  [ ]  //array\n              //only polypeptide molecules can be viewed by components\n              if (item.molecule_type.startsWith(\"polypeptide\"))\n                this.entityids.push(item.entity_id);\n            }\n          }\n          this.selectedid=this.entityids[0]; //first one\n\n        }).catch(error => {\n\n        console.log('Error dataitem().fetch() of \"'+this.serviceurl + this.item.Name+'\"');\n        console.log(error);\n      });\n    }\n\n  }\n\n  attached() {\n    //console.log(\"dataitem.attached()\");\n    //console.log(this.item);\n  }\n\n  selectedValueChanged() {\n    //create stem clones of element\n    if (!this.stemel1 && this.itemPDBEntry) {\n      this.stemel1 = this.el1.cloneNode(); //pure <pdb-topology\n      this.stemel2 = this.el2.cloneNode(); //pure <pdb-sequence\n    }\n\n    //replacing first element\n    let newel=this.stemel1.cloneNode();\n\n    //repleace old <pdb-topology with new pure <pdb-topology\n    let parent = this.el1.parentNode;\n    //remove the element - angular\n    parent.removeChild(this.el1);\n    //append the clean clone\n    newel.setAttribute(\"entity-id\",this.selectedid)\n    this.el1 = parent.appendChild(newel);\n    angular.bootstrap(newel, ['pdb.component.library']);\n\n    //replacing second element\n    newel=this.stemel2.cloneNode();\n\n    parent = this.el2.parentNode;\n    //remove the element - angular\n    parent.removeChild(this.el2);\n    //append the clean clone\n    newel.setAttribute(\"entity-id\",this.selectedid)\n\n    this.el2 =parent.appendChild(newel);\n    angular.bootstrap(newel, ['pdb.component.library']);\n  }\n\n  hideitem() {\n      this.showitem = !this.showitem;\n  }\n\n  isPDBEntry() {\n    //console.log(\"dataitem.ispdbentry()\")\n    //console.log(this.item.Type===\"pdb_id\");\n    //console.log(/^[0-9][A-Za-z0-9]{3}$/.test(this.item.Name));\n    return (this.item.Type===\"pdb_id\") || (/^[0-9][A-Za-z0-9]{3}$/.test(this.item.Name));\n  }\n\n  isUniprotEntry(entry) {\n    return (this.item.Type===\"uniprot_accession\") || (/^[A-Z][0-9][A-Z0-9]{4}[A-Z0-9]*$/.test(this.item.Name));\n  }\n\n}\n","/**\n * created by Tomas Kulhanek on 2/21/17.\n */\n\nimport 'whatwg-fetch';\nimport {HttpClient} from \"aurelia-http-client\";\nimport {bindable} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {DatasetFile} from '../filepicker/messages';\nimport {Vfstorage} from '../utils/vfstorage';\n\n//Model view controller\n//Model view viewmodel\n/** Dataset handles ViewModel of dataset view, performs AJAX call to dataset service,\n * holds dataset structure and includes dataitems\n *\n */\nexport class Dataset {\n  static inject = [HttpClient,EventAggregator];\n  @bindable panelid;\n\n  constructor (httpclient,ea) {\n    this.client = httpclient;\n    this.client.configure(config=> {\n      config.withHeader('Accept', 'application/json');\n      config.withHeader('Content-Type', 'application/json');\n    });\n    this.ea = ea;\n    this.ea.subscribe(DatasetFile, msg => this.addDatasetFile(msg.file,msg.senderid));\n\n    this.showitem=true;\n    this.baseurl =\n    this.dataseturl=Vfstorage.getBaseUrl()+\"/metadataservice/dataset\";\n    this.showlist=true;\n    this.pdbdataset = []; //structure could be {name:\"2hhd\", type:\"pdb|uniprot|file|dir\",url:\"https://pdbe.org/2hhd.pdb\",notes:\"\"}\n    this.pdbdataitem = \"\";\n    this.pdblinkset = [];\n    this.pdbdataitem = \"\";\n    this.submitdisabled2 = true;\n    this.id=0;\n  }\n\n  createnewdataset(){\n    this.pdbdataset = [];\n    this.pdbdataitem = \"\";\n    this.pdblinkset = [];\n    this.pdbdataitem = \"\";\n    this.submitdisabled2 = true;\n    let date = new Date();\n    this.name=\"dataset-\"+date.getFullYear()+\".\"+(date.getMonth()+1)+\".\"+date.getDate();\n    this.id = 0;\n    this.showlist=false;\n  }\n\n\n  //@computedFrom('submitdisabled2')\n  //TODO check,test to trigger only when pdbdataset is changed\n  get canSubmit() {\n    //console.log(\"disabled? \"+this.pdbdataset.length);\n    if (this.pdbdataset.length>0)\n      return true;\n    else\n      return false;\n  }\n\n  attached(){\n    this.client.get(this.dataseturl).then(data=>\n    {\n      //console.log(\"dataset.attached(), data:\")\n      //console.log(data)\n      this.datasetlist = JSON.parse(data.response);\n      //console.log('Dataset().datasetlist:')\n      //console.log(this.datasetlist)\n    })\n  }\n\n  unselectdataset(item){\n    this.showlist=true;\n  }\n\n  selectdataset(item){\n    //console.log(\"selectdataset()\");\n    //console.log(item)\n    this.client.get(this.dataseturl+\"/\"+item.Id).then(data=>\n    {\n      //console.log(\"selecteddataset(), data:\")\n      //console.log(data)\n      this.submitdataset=JSON.parse(data.response)\n      //console.log(this.submitdataset)\n      this.pdbdataset = this.submitdataset.Entries\n      this.name = this.submitdataset.Name\n      this.id = this.submitdataset.Id\n      this.showlist = false\n    })\n  }\n\n  removedataset(item){\n    alert(\"Remove dataset not yet implemented.\");\n    //console.log(item)\n  }\n\n  additem(item){\n    //console.log(\"additem()\");\n    //console.log(item);\n    this.pdbdataset.unshift(item);\n    //console.log(this.pdbdataset);\n    //this.canSubmit = this.pdbdataset.length>0?true:false;\n  }\n\n  addDatasetFile(file,senderid) {\n    if (senderid!== this.panelid) {\n      //console.log(\"dataset.adddatasetfile()\");\n      //console.log(file);\n      if (window.confirm(\"The file \" + file.name + \" will be added to dataset.\")) {\n        let item = {Name: file.name, Url: file.publicwebdavuri, Type: \"file\"}\n        this.pdbdataset.unshift(item);\n      }\n    }\n  }\n\n  removeitem(itemtodelete){\n    this.pdbdataset = this.pdbdataset.filter(item => item!== itemtodelete);\n  }\n\n\n  //model-view -viewmodel\n  hideitem() {\n    this.showitem = ! this.showitem;\n  }\n\n\n  submit(){\n    //console.log(\"submitting data:\");\n    this.submitdataset = {};\n    this.submitdataset.Id = this.id;\n    this.submitdataset.Name = this.name;\n    this.submitdataset.Entries = this.pdbdataset;\n    //this.submitdataset.Urls =\n    //console.log(this.submitdataset);\n    //console.log(JSON.stringify(this.submitdataset));\n    //PUT = UPDATE, POST = create new\n    if (this.id>0)\n      this.client.put(this.dataseturl+\"/\"+this.id,JSON.stringify(this.submitdataset))\n        .then(data =>{\n          //console.log(\"data response\");\n          //console.log(data);\n          let myitem = JSON.parse(data.response);\n          //this.datasetlist.push({Id:myitem.Id, Name:myitem.Name})\n          this.showlist=true;\n        })\n        .catch(error =>{\n          console.log(error);\n          alert('Sorry. Dataset not submitted  at '+this.serviceurl+' error:'+error.response+\" status:\"+error.statusText)\n        });\n    else\n      this.client.post(this.dataseturl,JSON.stringify(this.submitdataset))\n        .then(data =>{\n          //console.log(\"data response\");\n          //console.log(data);\n          let myitem = JSON.parse(data.response);\n          this.datasetlist.push({Id:myitem.Id, Name:myitem.Name})\n          this.showlist=true;\n        })\n        .catch(error =>{\n          console.log(error);\n          alert('Sorry. Dataset not submitted  at '+this.serviceurl+' error:'+error.response+\" status:\"+error.statusText)\n        });\n  }\n}\n","/**\n * Created by Nurul on 3/10/17.\n */\n\nexport class EntryIdCustomAttribute {\n  static inject = [Element]\n\n  constructor (element) {\n    this.element = element;\n  }\n\n  /* set's DOM atribute to the binded value.\n   valueChanged() is triggered by Aurelia,\n   when the value is bind - before attached()\n   this.value\n   */\n  valueChanged(newValue,oldValue){\n    this.element.setAttribute('entry-id',this.value);\n  }\n\n  /* bootstrap the pdb component library just from the element */\n  attached(){\n    angular.bootstrap(this.element, ['pdb.component.library']);\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 3/16/17.\n */\nimport {bindable} from 'aurelia-framework';\n\n/** Hideable component <hideable>content</hideable> renders additional title bar, when clicked\n * it is hidden/shown by aurelia show.bind feature\n */\nexport class Hideable {\n  @bindable title;\n  @bindable defaulthide=false;\n  constructor(){\n    this.showit=true;\n  }\n\n  bind(){\n    if (this.defaulthide) {\n      this.showit=false;\n    }\n  }\n\n  changeshowit(){\n    this.showit=!this.showit;\n  }\n}\n","/**\n * * Created by Tomas Kulhanek on 2/27/17.\n */\n\n/** adds functionality into pdb-id attribute, if used, then\n * it is integrated with ebi.ac.uk PDB components - which use\n * this attribute torender specific content\n *\n */\nexport class PdbIdCustomAttribute {\n  static inject = [Element]\n\n  constructor (element) {\n    this.element = element;\n  }\n\n  /* set's DOM atribute to the binded value.\n   valueChanged() is triggered by Aurelia,\n   when the value is bind - before attached()\n   this.value\n   */\n  valueChanged(newValue,oldValue){\n   //console.log('valueChanged() element:'+this.element.tagName+\" newvalue:\"+newValue+' this.value:'+this.value+' current.attribute.pdb-id:'+ this.element.getAttribute('pdb-id'));\n    // <pdb-redo pdb-id=\"item\"></pdb-redo> -> valueChange()\n   this.element.setAttribute('pdb-id',this.value);\n   //  <pdb-redo pdb-id=\"2sc3\">\n\n   //console.log(this.element.getAttribute('pdb-id'));\n  }\n\n\n\n  /* bootstrap the pdb component library just from the element */\n  attached(){\n    //console.log('attached element with custom attribute pdb-id:')\n    //console.log(this.element.getAttribute('pdb-id'));\n    angular.bootstrap(this.element, ['pdb.component.library']);\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 2/27/17.\n */\n\n/**\n * Custom atrribute pdb-ids contains comma separated set of pdb-id in string,\n * it is used to integrate with ebi.ac.uk PDB components using pdb-ids\n */\nexport class PdbIdsCustomAttribute {\n  static inject = [Element]\n\n  constructor (element) {\n    //console.log('pdbids()');\n    this.element = element;\n    this.bootstrapped=false;\n  }\n\n  /* set's DOM atribute to the binded value.\n     valueChanged() is triggered by Aurelia,\n     when the value is bind - before attached()\n  */\n  valueChanged(newValue,oldValue) {\n    //console.log('pdbids.valueChanged() element:'+this.element.tagName+\" newvalue:\"+newValue+' this.value:'+this.value+' current.attribute.pdb-ids:'+ this.element.getAttribute('pdb-ids'));\n    //console.log(this.value); // pdb-ids separated by coma -\n    // \"2hhd,1r6a,4yg0\"\n    if (this.value.length>0) {\n\n      this.pdbids = this.value.split(',');\n      // [ 2hhd, 1r6a, 4yg0 ] -> array()\n      //filter pdbids, uniprot and other entries are not included\n      this.pdbidsfilter = this.pdbids.filter(function (obj) {\n        return /^[0-9][A-Za-z0-9]{3}$/.test(obj);\n      });\n\n      this.pdbidsjson = JSON.stringify(this.pdbidsfilter);\n      // \"[ \"2hhd\", \"1r6a\", \"4yg0\" ]\"\n      if (this.pdbids.length > 0) {        //bootstrap only if something is in an array\n        if (this.bootstrapped) { //replace the angularized element with clean clone\n          //create clone from stem clone\n          var myclone = this.elementclone.cloneNode();\n          //console.log('angular element');\n          //console.log(this.element);\n          this.parent = this.element.parentNode;\n          //remove the element - angular\n          this.parent.removeChild(this.element);\n          //append the clean clone\n          this.parent.appendChild(myclone);\n          this.element = this.parent.children[0];\n        } else {\n          this.elementclone = this.element.cloneNode(); //stem clone\n\n        }\n        this.element.setAttribute('pdb-ids', this.pdbidsjson);\n        angular.bootstrap(this.element, ['pdb.component.library']);\n        this.bootstrapped = true;\n      }\n    }\n  }\n\n}\n\n","/**\n * created by Tomas Kulhanek on 2/27/17.\n */\n\nexport class Sasclient {\n\n  constructor(httpclient){\n    this.client = httpclient;\n    this.config = {\n      resultBoxAlign: 'left',\n      redirectOnClick: false,\n      searchUrl: '//www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select',\n      fields: 'value,num_pdb_entries,var_name',\n      group: 'group=true&group.field=category',\n      groupLimit: '25',\n      sort: 'category+asc,num_pdb_entries+desc',\n      searchParams: 'rows=20000&json.nl=map&wt=json'\n    }\n  }\n\n  search(term){\n    //http://www.ebi.ac.uk/pdbe/search/pdb/select?fl=pdb_id,organism_synonyms,number_of_bound_entities,+number_of_protein_chains,experimental_method,+experiment_data_available,expression_host_sci_name,+citation_year,+entry_organism_scientific_name,number_of_RNA_chains,number_of_DNA_chains,sample_preparation_method,emdb_id&group=true&group.field=pdb_id&group.limit=100&rows=1000&wt=json&q=pdb_id:(1cbs)\n    //http://www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select?rows=20000&json.nl=map&wt=json&group=true&group.field=category&fl=value,num_pdb_entries,var_name&sort=category+asc,num_pdb_entries+desc&group.limit=25&q=value:2hh*~10\n    //http://www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select?rows=20000&json.nl=map&wt=json&fl=value,num_pdb_entries,var_name&group=true&group.field=category&sort=category+asc,num_pdb_entries+desc&group.limit=25&q=value:2hh*~10\n    let url = this.config.searchUrl+\"?\"+this.config.searchParams+\"&fl=\"+this.config.fields+ \"&\"+this.config.group+\"&sort=\"+this.config.sort+\"&group.limit=\"+this.config.groupLimit+\"&q=value:\"+term+\"*~10\";\n\n    this.client.get(url)\n      .then(data => {\n        if (data.response) {\n\n          return data.response.grouped.category.groups\n        }\n      }).catch(error => {\n\n      console.log('Error');\n      console.log(error);\n    });\n  }\n\n  searchMore(term) {\n\n  }\n\n}\n","\n/**\n * Created by Tomas Kulhanek on 11/29/16.\n */\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {VisualizeFile} from '../filepicker/messages';\nimport {bindable} from 'aurelia-framework';\n\n/**\n * integrates pdb-lite-mol component into panel\n */\nexport class  Viewpanel {\n    static inject = [Element,EventAggregator];\n    @bindable pid;\n\n    constructor(el,ea) {\n        this.element = el;\n        this.ea = ea;\n      this.ea.subscribe(VisualizeFile, msg => this.viewfile(msg.file,msg.senderid));\n        //this.uid = new Date().valueOf().toString();\n        this.sourceurl=\"\";\n        this.sourceformat=\"pdb\";\n      this.pdbentry = \"\";\n      this.pdbredoentry=\"\";\n      this.pdburl= \"\";\n    }\n\n    attached() {\n      //bootstrap only if angular is defined - prevent error in offline mode\n      if (typeof(angular) != 'undefined') angular.bootstrap(this.element.querySelector('#pdbviewer'), ['pdb.component.library']);\n    }\n\n    viewfile(file,senderid) {\n      //view files from second panel\n        if (senderid!=this.pid) {\n          //console.log(\"viewfile \" + file.webdavuri);\n          this.pdburl=file.webdavuri;\n          let sourceformat='pdb'\n          if (this.pdburl.endsWith('cif')) sourceformat=\"mmcif\";\n          let pdblitemol = '<pdb-lite-mol load-ed-maps=\"true\" source-url=\"' + this.pdburl + '\" pdb-id=\"\\'\\'\" source-format='+sourceformat+'></pdb-lite-mol>';\n          this.replacepdblitemol(pdblitemol);\n        }\n    }\n\n  loadfromredo() {\n    //http://pdb-redo.eu/db/1r6a/1r6a_final.pdb;jsessionid=C2F739E5913AEA9460EDA0B9F024C471\n    this.pdburl = \"//pdb-redo.eu/db/\"+this.pdbredoentry+\"/\"+this.pdbredoentry+\"_final.pdb\";//'http://www.cmbi.ru.nl/pdb_redo/'+this.pdbredoentry.substring(1,3)+'/'+this.pdbredoentry+'/'+this.pdbredoentry+'_final.pdb';\n    var pdblitemol = '<pdb-lite-mol load-ed-maps=\"true\" source-url=\"' + this.pdburl + '\" pdb-id=\"\\'\\'\" source-format=\"pdb\"></pdb-lite-mol>';\n    this.replacepdblitemol(pdblitemol);\n  }\n\n\n  loadpdb() {\n    //console.log(\"loadpdb \"+this.pdbentry);\n    this.pdburl=this.pdbentry;\n    var pdblitemol = '<pdb-lite-mol load-ed-maps=\"true\" pdb-id=\"\\''+this.pdbentry+'\\'\"></pdb-lite-mol>'\n    this.replacepdblitemol(pdblitemol);\n  }\n\n  replacepdblitemol(pdblitemol) {\n      //remove pdblitemol\n      var pdbviewer = this.element.querySelector('#pdbviewer');\n      var parentnode = this.element.querySelector('#pdbwrapper');\n      parentnode.removeChild(pdbviewer);\n      //create pdblitemol\n      parentnode.insertAdjacentHTML('afterbegin', '<div style=\"position:relative;height:400px;width:800px;\" id=\"pdbviewer\">'+pdblitemol+'</div>');\n\n      //call angular bootstrap\n      angular.bootstrap(this.element.querySelector('#pdbviewer'), ['pdb.component.library']);\n    }\n\n}\n","export function configure(config) {\n  //config.globalResources([]);\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class SelectedTab {\n  constructor(tabid){\n    this.tabid = tabid;\n  }\n}\n","import {bindable, inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedTab} from './messages';\nimport {VisualizeFile,EditFile} from '../filepicker/messages';\n//import $ from 'jquery';\n//import {tabs} from 'jquery-ui';\n\n/**\n * <tabs></tabs>\n * adds tabs functionality into application filepanel\n */\nexport class Tabs {\n    @bindable tabs;\n    static inject = [Element,EventAggregator];\n\n\n    constructor(el,ea) {\n        this.id = el.id;\n        this.element= el;\n        this.ea=ea;\n        this.ea.subscribe(VisualizeFile, msg => this.selectVisualize(msg.file,msg.senderid));\n        this.ea.subscribe(EditFile, msg => this.selectEdit(msg.file,msg.senderid));\n    }\n\n    bind() {\n      console.log(\"tabs.atached() tabs: \"+this.tabs);\n      this.activeid=this.tabs[0];\n      this.activeid.active = true;\n      //this.tabs[]\n    }\n\n    selectVisualize(file,senderid){\n      //just switch the tab\n      console.log(\"selectVisualize senderid:\"+senderid+ \" this.id:\"+this.id)\n      if (!this.activeid.id.startsWith(senderid)) { //TODO presumes active.id = \"left.list\" \"left.view\" .. has suffix with senderid\n        this.activeid.active = false;\n\n        this.activeid=this.tabs[2];\n        //new active tab is active\n        this.activeid.active=true;\n      }\n    }\n\n    selectEdit(file,senderid) {\n      console.log(\"selectEdit senderid:\"+senderid+ \" this.id:\"+this.id)\n      console.log(this.tabs);\n      console.log(this.activeid);\n      if (!this.activeid.id.startsWith(senderid)) { //TODO presumes active.id = \"left.list\" \"left.view\" .. has suffix with senderid\n        this.activeid.active = false;\n\n        this.activeid=this.tabs[1];\n        //new active tab is active\n        this.activeid.active=true;\n      }\n\n    }\n\n    opentab(tabid){\n      //old active tab is not active anymore\n      this.activeid.active = false;\n\n      this.activeid=tabid;\n      //new active tab is active\n      this.activeid.active=true;\n        //console.log(\"Tabs selected:\"+this.activeid);\n        this.ea.publish(new SelectedTab(this.activeid.id));\n    }\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from '../filepicker/messages';\n\nexport class App {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.ea = ea;\n    this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file));\n  }\n\n  selectFile(file){\n    window.opener.postMessage(window.location.protocol+\"//\"+window.location.hostname+file.webdavuri, \"*\");\n      //+\" \"+window.location.protocol+\"//\"+window.location.hostname+file.publicwebdavuri, \"*\");\n    window.close();\n  }\n\n}\n","import environment from '../environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * created by Tomas Kulhanek on 4/11/17.\n */\n\nimport {HttpClient} from 'aurelia-http-client';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from '../filepicker/messages';\nimport {bindable} from 'aurelia-framework';\nimport {Filepanel} from '../filepicker/filepanel';\n\nexport class Uploaddirpanel extends Filepanel {\n  static inject = [EventAggregator, HttpClient];\n  @bindable panelid;\n\n  constructor(ea, httpclient) {\n    super(ea,httpclient)\n  }\n\n  selectFile(file){\n    //console.log(\"filepanel tableid:\"+this.panelid);\n    if (!file.size || (file.size.endsWith && file.size.endsWith('DIR'))) this.changefolder(file.name);\n  }\n\n\n  selectThisDir() {\n    //console.log(\"selected:\"+this.path);\n    let myfile= {};\n    myfile.name = this.path;\n    this.client.get(this.getpublicwebdavurl)\n      .then(data => {\n        if (data.response) {\n          let mypath2=JSON.parse(data.response);\n          let mypath = mypath2.signed_url;\n          mypath+= this.path.startsWith('/')?this.path.slice(1):this.path;\n          let mydir = {};\n          mydir.webdavuri = mypath;\n          this.ea.publish(new SelectedFile(mydir, this.panelid));\n        }\n      });\n  }\n}\n","/**\n * Created by vagrant on 6/30/17.\n */\n\nexport class Vfstorage{\n\n  constructor() {}\n\n  /**check existence of localstorage property, if undefined set to the value\n   *\n   * @param propertyName\n   * @param defaultvalue\n   * @returns {string}\n   */\n  static checkDefault(propertyName,defaultvalue){\n    return (typeof(Storage) !== \"undefined\")?\n      (localStorage.getItem(propertyName)!==\"undefined\")? this.getValue(propertyName): this.setValue(propertyName,defaultvalue)\n      :defaultvalue;\n  }\n\n  /**gets value, if storage is not supported by browser then default value string \"true\"\n   *\n   * @param propertyName\n   * @param defaultvalue\n   * @returns {string}\n   */\n  static getValue(propertyName,defaultvalue=\"true\"){\n    return (typeof(Storage) !== \"undefined\") ? (localStorage.getItem(propertyName)?localStorage.getItem(propertyName):defaultvalue): defaultvalue;  }\n\n  /** sets value to the property into localStorage,\n   * if not supported by browser, does nothing\n   *\n   * @param propertyName\n   * @param value\n   * @returns {*}\n   */\n  static setValue(propertyName,value){\n    return (typeof(Storage) !== \"undefined\") ? localStorage.setItem(propertyName,value):value;\n  }\n\n  /**returns base url set in global variable virtualfolderbaseurl e.g. 'https://portal.west-life.eu'\n   *\n   * @returns {string}\n   */\n\n  static getBaseUrl(){\n    //console.log(\"vfstorage.getbaseurl\");\n    //console.log((\"virtualfolderbaseurl\" in window));\n    return (\"virtualfolderbaseurl\" in window) ? virtualfolderbaseurl : \"\";\n  }\n\n  static parseQueryString(str) {\n    var ret = Object.create(null);\n\n    if (typeof str !== 'string') {\n      return ret;\n    }\n\n    str = str.trim().replace(/^(\\?|#|&)/, '');\n\n    if (!str) {\n      return ret;\n    }\n\n    str.split('&').forEach(function (param) {\n      var parts = param.replace(/\\+/g, ' ').split('=');\n      // Firefox (pre 40) decodes `%3D` to `=`\n      // https://github.com/sindresorhus/query-string/pull/37\n      var key = parts.shift();\n      var val = parts.length > 0 ? parts.join('=') : undefined;\n\n      key = decodeURIComponent(key);\n\n      // missing `=` should be `null`:\n      // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n      val = val === undefined ? null : decodeURIComponent(val);\n\n      if (ret[key] === undefined) {\n        ret[key] = val;\n      } else if (Array.isArray(ret[key])) {\n        ret[key].push(val);\n      } else {\n        ret[key] = [ret[key], val];\n      }\n    });\n\n    return ret;\n  }\n}\n","import {HttpClient} from 'aurelia-http-client';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {HandleLogin} from '../behavior';\nimport {ShowLoginButton} from '../behavior';\n\nexport class App {\n  static inject = [EventAggregator,HttpClient];\n\nconstructor(ea,httpclient){\n  this.ea = ea;\n    this.location = window.location.protocol;\n    this.islocalhost= this.location.startsWith('http:');\n    this.client=httpclient;\n    this.webdavurl=\"\";\n    this.requestpublicurl=\"/api/authproxy/get_signed_url/\";\n    // wait for assignement this.genericcontrol from children\n  this.handler = new ShowLoginButton();\n  this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n  }\n\n  generateurl() {\n    if (this.webdavurl==\"\") {\n      this.client.get(this.requestpublicurl)\n        .then(data => {\n          if (data.response) {\n            let result = JSON.parse(data.response);\n            if (window.location.port == \"80\" || window.location.port== \"\")\n              this.webdavurl = window.location.protocol+\"//\"+window.location.hostname+result.signed_url;\n            else\n              this.webdavurl = window.location.protocol+\"//\"+window.location.hostname+\":\"+window.location.port+result.signed_url;\n            //console.log(this.webdavurl)\n          }\n        });\n    }\n  }\n\n  attached(){\n    if (! document.cookie.match(/^(.*;)?\\s*sessionidl\\s*=\\s*[^;]+(.*)?$/)) this.handler.handlelogin();\n  }\n\n}\n","import environment from '../environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","\nexport class App {\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\nimport {Modulecontrol} from \"./modulecontrol\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Ccp4control extends Modulecontrol{\n//  @bindable classin = \"w3-sand\";\n  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor(){\n    super();\n    this.posturl=\"/metadataservice/sbservice/ccp4suite\";\n    this.url=\"/metadataservice/sbservice/ccp4suite\";\n  }\n\n\n}\n","import environment from '../environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\n\nimport {HttpClient} from 'aurelia-http-client';\nimport {Vfstorage} from '../utils/vfstorage';\n//import {bindable} from 'aurelia-framework';\n\n\nexport class Modulecontrol{\n//  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor () {\n    this.client=new HttpClient();\n    this.url=window.location.href;\n    this.baseurl=Vfstorage.getBaseUrl()\n    this.enabled=false;\n    this.client.configure(config=> {\n      config.withHeader('Accept', 'application/json');\n      config.withHeader('Content-Type', 'application/json');\n    });\n\n  }\n\n  attached(){\n    //console.log(\"attached() url:\"+this.url);\n    this.client.get(this.baseurl+this.url)\n      .then(response => this.okcallback(response))\n      .catch(error => this.failcallback(error))\n  }\n\n  okcallback(response){\n    //console.log(\"okcallback()\");\n    var res= JSON.parse(response.response);\n    //console.log(res.enabled);\n    this.enabled= res.enabled;\n  }\n\n  failcallback(error){\n    this.enabled=false;\n    console.log('Sorry, error when connecting backend web service at '+this.url+' error:'+error.response+\" status:\"+error.statusText);\n  }\n\n  enable(){\n    this.client.post(this.baseurl+this.url)\n      .then(response => this.okcallback(response))\n      .catch(error => this.failcallback(error))\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\n\nexport class Modulesetting {\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\nimport {Modulecontrol} from \"./modulecontrol\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Scipioncontrol extends Modulecontrol{\n  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor(){\n   super();\n   this.url=\"/metadataservice/sbservice/scipion\";\n   this.posturl=\"/metadataservice/sbservice/scipion\";\n }\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\nimport {Modulecontrol} from \"./modulecontrol\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Virtuosocontrol extends Modulecontrol {\n//  @bindable classin = \"w3-sand\";\n  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor(){\n    super();\n    this.url=\"/metadataservice/sbservice/virtuoso\";\n  }\n\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/6/17.\n */\nimport {HttpClient} from 'aurelia-http-client';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSubmitted} from './messages';\nimport {Vfstorage} from '../utils/vfstorage';\n\n//let client = new HttpClient();\n\n/**\n * Aliastable component gets the currently registered aliases for file providers\n * and shows them in a table, allows delete the alias or initiate dialog to create one.\n */\nexport class Aliastable {\n  static inject = [EventAggregator,HttpClient];\n\n  constructor(ea,httpclient){\n    this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/files\";\n    ea.subscribe(SettingsSubmitted, msg => this.submitSettings(msg.settings) );\n    this.client=httpclient;\n    this.providers=[{alias:\"Loading available providers ...\",temporary:true}];\n    this.client.configure(config=> {\n      config.withHeader('Accept', 'application/json');\n      config.withHeader('Content-Type', 'application/json');\n    });\n  }\n\n  attached() {\n    //gets the status of the b2drop connection\n    this.client.get(this.serviceurl)\n      .then(data => {\n        //console.log(\"data response\");\n        //console.log(data);\n        if (data.response) {\n          this.providers = JSON.parse(data.response);\n        }\n      })\n      .catch(error =>{\n        console.log(\"aliastable.attached() error:\")\n        console.log(error);\n          //handle 403 unauthorized\n          if (error.statusCode == 403) {\n            //try to login\n            console.log(\"redirecting\");\n            window.location = \"/login?next=\" + window.location.pathname;\n            //window.location =\n          } else\n        alert('Sorry, error when connecting backend web service at '+this.serviceurl+' error:'+error.response+\" status:\"+error.statusText)\n      });\n  }\n\n  submitSettings(settings) {\n     this.providers = settings;\n  }\n\n  removeProvider(settings){\n    //console.log(\"removeProvider() \"+alias);\n    if (!confirm('Do you really want to delete the provider with alias \"'+settings.alias+'\" ?'))\n      return;\n    this.client.delete(this.serviceurl+\"/\"+settings.alias)\n      .then(data =>{\n        //console.log(\"data response\");\n        //console.log(data);\n        if (data.response) {\n          this.providers = JSON.parse(data.response);\n        }\n      })\n      .catch(error =>{\n        console.log(error);\n\n        alert('Sorry. Settings not deleted at '+this.serviceurl+' error:'+error.response+\" status:\"+error.statusText)\n      });\n  }\n\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {RedirectLogin} from '../behavior';\nimport {HandleLogin} from '../behavior';\n\nexport class App {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.ea = ea;\n    let location = window.location.protocol;\n    this.islocalhost= location.startsWith('http:');\n\n    this.handler = new RedirectLogin();\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 5/24/17.\n */\n\nexport class Clouddeployment {\n}\n","/**\n * Created by Tomas Kulhanek on 1/10/17.\n */\n/**\n * Created by Tomas Kulhanek on 1/5/17.\n */\n\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSelected} from './messages';\nimport {Vfstorage} from '../utils/vfstorage';\nimport 'dropbox';\n\n//let client = new HttpClient();\n\nexport class DropboxControl {\n\n  static inject = [EventAggregator];\n\n  constructor(ea){\n    //this.dbx = dropbox;\n    // Parses the url and gets the access token if it is in the urls hash\n    this.ea= ea;\n    this.accesstoken=Vfstorage.parseQueryString(window.location.hash).access_token;\n    this.isAuthenticated = !!this.accesstoken;\n    //console.log('dropboxcontrol() accesstoken:'+this.accesstoken);\n\n    //instantiate dropboxclient - needed for getting URL to redirect\n    this.CLIENTIDENC = \"o\\\"csb%'{{{ze'ya\";\n    try {\n      var Dropbox = require(\"dropbox\");\n      //console.log(mdb)\n      var dbx = new Dropbox({\n        clientId: this.CLIENTIDENC.split('').map(function (c) {\n          return String.fromCharCode(23 ^ c.charCodeAt());\n        }).join(\"\")\n      });\n      var currentUrl = window.location.href;\n      //console.log('dropboxcontrol() current url:' + currentUrl);\n      this.authurl = dbx.getAuthenticationUrl(currentUrl);\n      //console.log('dropboxcontrol() auth url:' + this.authurl);\n      //console.log(this.dropBoxAuthUrl);\n    } catch(e){\n      console.log(\"Dropboxcontrol() exception:\")\n      console.log(e)\n    }\n\n    this.id=\"Dropbox\";\n\n\n  }\n  \n  initialize(){\n    if (this.isAuthenticated) {\n      var settings = {};\n      settings.type=this.id;\n      //settings.alias = this.alias;\n      settings.securetoken = this.accesstoken;\n      //else settings.username = this.username;\n      //if (this.password) settings.securetoken = this.password;\n      this.ea.publish(new SettingsSelected(settings));\n    }\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/5/17.\n */\nimport {HttpClient,json} from 'aurelia-fetch-client';\nimport {computedFrom} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSubmitted} from './messages';\nimport {DropboxControl} from './dropboxcontrol';\nimport {SettingsSelected} from './messages';\nimport {Vfstorage} from \"../utils/vfstorage\";\n\nexport class Genericcontrol {\n\n  static inject = [EventAggregator, HttpClient,DropboxControl];\n\n\n  constructor(ea,httpclient,dropboxcontrol) {\n    this.heading=\"File Provider\";\n    this.ea= ea;\n    this.dropboxcontrol=dropboxcontrol;\n    this.editing=true;\n    this.providerspath = \"providers\";\n    this.filespath = \"files\";\n    this.knowtoken=false;\n    this.dropboxauthurl = \"\";\n    this.providers = [];\n    this.selectedProvider=\"\";\n    this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/\";\n    //console.log('genericcontrol()');\n    this.client=httpclient;\n\n    this.ea.subscribe(SettingsSelected, msg => this.selectSettings(msg.settings) )\n    this.myHeaders = new Headers();\n    this.myHeaders.append('Accept', 'application/json');\n    this.myHeaders.append('Content-Type', 'application/json');\n\n  }\n\n  @computedFrom('selectedProvider')\n  get selectedDropbox() {\n    return this.selectedProvider==this.dropboxcontrol.id;\n  }\n\n  @computedFrom('selectedProvider')\n  get selectedB2Drop() {\n    return this.selectedProvider=='B2Drop';\n  }\n\n  @computedFrom('selectedProvider')\n  get selectedFileSystem() {\n    return this.selectedProvider=='FileSystem';\n  }\n  @computedFrom('selectedProvider')\n  get selectedWebDav() {\n    return this.selectedProvider=='WebDav';\n  }\n\n  get knowntoken(){\n    if (this.knownSecureToken) return this.knownSecureToken.checked;\n  }\n\n  clear(){\n    this.selectedProvider=\"\";\n    this.username=\"\";\n    this.securetoken=\"\";\n    this.filesystempath=\"\";\n    this.alias=\"\";\n    this.accessurl=\"\";\n  }\n\n  attached() {\n    //console.log('genericcontrol.attached()');\n    //console.log(\"dialogstate:\"+this.dialogstate);\n    //attach parent with the instance\n    //this.bindingContext.genericcontrol = this;\n    //gets the status of the b2drop connection\n    this.dropboxauthurl = this.dropboxcontrol.authurl;\n    this.client.fetch(this.serviceurl+this.providerspath,{headers:this.myHeaders,credentials:'include'})\n      .then(response => response.json())\n      .then(data=> {\n        //console.log(\"data response\");\n        //console.log(data);\n        if (data) {\n          this.providers = data;\n        }\n      }).catch(error => {\n      //handle 403 unauthorized\n      if (error.statusCode == 403) {\n        //try to login\n        console.log(\"genericcontrol.attached() redirecting\");\n        window.location = \"/login?next=\" + window.location.pathname;\n        //window.location =\n      } else {\n        //console.log('Error');\n        //console.log(error);\n        //alert('Sorry, response: ' + error.statusCode + ':' + error.statusText + ' when trying to get: ' + this.serviceurl);\n      }\n    });\n    this.dropboxcontrol.initialize();\n  }\n\n  addProvider() {\n     let settings = {};\n     settings.type=this.selectedProvider;\n     settings.alias = this.alias;\n     if (this.selectedDropbox) settings.securetoken = this.securetoken;\n     if (this.selectedFileSystem) settings.securetoken = this.filesystempath;\n     if (this.selectedB2Drop) {\n       settings.securetoken = this.password;\n       settings.username = this.username;\n     } else if (this.selectedWebDav){\n       settings.accessurl=this.accessurl;\n       settings.securetoken = this.password;\n       settings.username = this.username;\n     }\n    this.submitSettings(settings)\n  }\n\n\n  submitSettings(settings) {\n    this.client.fetch(this.serviceurl+this.filespath,{\n      method: 'put',\n      body: json(settings),\n      headers:this.myHeaders,\n      credentials:'include'\n    })\n      .then(response => response.json())\n      .then(data =>{\n        //console.log(\"genericcontrol: data response:\");\n        //console.log(data);\n        if (Array.isArray(data)) {\n          this.doneCallback(data);\n          //this.providers = data;\n        } else {\n\n          //console.log(data);\n          if (data.ResponseStatus) alert('Sorry.'+data.ResponseStatus.ErrorCode+\"\\n\"+ data.ResponseStatus.Message+\"\\nSubmit correct username and/or password again.\");\n          else alert ('Sorry. Settings not submitted. Check all items are correct and submit again.')\n        }\n\n    })\n      .catch(error =>{\n        console.log(error);\n        alert('Sorry. Settings not submitted  at '+this.serviceurl+' error:'+error.response+\" status:\"+error.statusText)\n      });\n\n  }\n\n  doneCallback(data){\n    {\n      //console.log(\"publishing\");\n      this.ea.publish(new SettingsSubmitted(data));\n      this.clear();\n    }\n  }\n\n  errorCallback(error){\n    console.log(\"GenericControl: Error retrieved:\");\n    console.log(error);\n  }\n\n  selectSettings(settings){\n    this.selectedProvider=settings.type;\n    this.alias=settings.alias;\n    this.securetoken=settings.securetoken;\n    if (!!this.securetoken) { this.editing=false; this.knownSecureToken.checked=true; }\n  }\n\n}\n","import environment from '../environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class SettingsSubmitted {\n  constructor(settings){\n    this.settings = settings;\n  }\n}\n\nexport class SettingsSelected {\n  constructor(settings){\n    this.settings = settings;\n  }\n}\n\nexport class SettingsRemoved {\n  constructor(settings){\n    this.settings = settings;\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 5/28/17.\n */\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSubmitted, SettingsSelected} from './messages';\n\n\nexport class Storageprovider {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.showprovider = false;\n    ea.subscribe(SettingsSubmitted, msg => this.submitSettings(msg.settings) )\n    ea.subscribe(SettingsSelected, msg => this.selectSettings(msg.settings) )\n  }\n\n  newProvider(){\n    this.showprovider = true;\n  }\n\n  submitSettings(settings){\n    //console.log('addProvider: not yet implemented');\n    this.showprovider = false;\n    //get provider info from subcomponent\n  }\n\n  selectSettings(settings){\n    //console.log('addProvider: not yet implemented');\n    this.showprovider = true;\n    //get provider info from subcomponent\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 7/21/17.\n */\nimport {HttpClient} from 'aurelia-http-client';\n\nimport {Vfstorage} from '../utils/vfstorage';\n\n/**\n * taskcontrol component gets available tasks and their status (running/not running)\n * may initiate to start/stop them and shows link to them\n */\nexport class Taskcontrol {\n  static inject = [HttpClient];\n\n  constructor(httpclient){\n    this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/availabletasks\";\n    this.userprocessurl = Vfstorage.getBaseUrl()+\"/metadataservice/userprocess/\";\n    this.client=httpclient;\n    this.tasks = [];\n    this.client.configure(config=> {\n      config.withHeader('Accept', 'application/json');\n      config.withHeader('Content-Type', 'application/json');\n    });\n    this.descriptions=[];\n    this.descriptions[\"jupyter\"]=\"Jupyter notebook web application instance\";\n    this.descriptions[\"scipion\"]=\"Scipion Cryo-em web application instance\";\n  }\n\n  attached() {\n    //gets the status of the b2drop connection\n    this.client.get(this.serviceurl)\n      .then(data => {\n        if (data.response) {\n          this.tasks = JSON.parse(data.response);\n          let that=this;\n          this.tasks.forEach(function(task){\n            task.Description = that.descriptions[task.Name] || \"\";\n            task.Updating=false;\n          })\n        }\n      })\n      .catch(error =>{\n        console.log(\"taskcontrol.attached() error:\")\n        console.log(error);\n      });\n  }\n\n  starttask(task1) {\n    var task = task1;\n    task.Updating=true;\n    this.updatetask(task).then((msg) => {\n      //sleep(2000); //sleep 2 seconds - just that the server has time to reload\n      setTimeout( () => {\n          task.Updating = false;\n          task.Running = true;\n          task.LocalUrl = msg;\n          console.log(\"task.LocalUrl:\" + task.LocalUrl);\n        }, 2000);}\n      )\n    .catch((reason) => {\n        task.Updating=false;\n        console.log('start failed');\n        console.log(reason)\n      })\n  }\n\n  stoptask(task1){\n    var task = task1;\n    task.Updating=true;\n    this.updatetask(task).then((msg) => {\n      //sleep(2000); //sleep 2 seconds - just that the server has time to reload\n      setTimeout( () => {\n        task.Updating = false;\n        task.Running = false;\n      }, 2000)\n    })\n      .catch((reason) => {\n        task.Updating=false;\n        console.log('stop failed');\n        console.log(reason)\n      })\n  }\n\n  updatetask(task){\n    return new Promise((resolve, reject) => {\n      if (task.Running) {//will try to stop\n         this.client.delete(this.userprocessurl+task.Name)\n           .then(data =>{\n             resolve('Deleted')\n         })\n           .catch(error=>{\n             reject(error)\n           })\n      } else {\n         this.client.post(this.userprocessurl+task.Name)\n           .then(data=>{\n             let updatedtask=JSON.parse(data.response);\n             resolve(updatedtask.LocalUrl)\n           }\n         )\n           .catch(error=>{\n             reject(error)\n           })\n      }\n    })\n  }\n\n}\n"],"sourceRoot":"../src"}