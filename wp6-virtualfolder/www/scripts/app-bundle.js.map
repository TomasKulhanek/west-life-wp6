{"version":3,"sources":["app.js","behavior.js","environment.js","main.js","navitem.js","advancedfilepicker/advancedfilepicker.js","advancedfilepicker/app.js","advancedfilepicker/environment.js","advancedfilepicker/main.js","advancedfilepicker/viewpanel2.js","autocomplete/vfAutocompleteSearch.js","components/projectapi.js","components/sharedheader.js","components/userinfo.js","editor/fileeditor.js","filemanager2/app.js","filemanager2/environment.js","filemanager2/fmsettings.js","filemanager2/main.js","filemanager2/panel.js","filepicker/app.js","filepicker/environment.js","filepicker/filepanel.js","filepicker/main.js","filepicker/messages.js","filepicker/pdbpanel.js","filepicker/pdbresource.js","filepicker/uniprotpanel.js","filepicker/uniprotresource.js","pages/filemanager.js","pages/filepicker.js","pages/virtualfolderhome.js","pages/virtualfoldersetting.js","pdbcomponents/checkurl.js","pdbcomponents/dataitem.js","pdbcomponents/dataset.js","pdbcomponents/entry-id.js","pdbcomponents/hideable.js","pdbcomponents/pdb-id.js","pdbcomponents/pdb-ids.js","pdbcomponents/sasclient.js","pdbcomponents/viewpanel.js","resources/icopy.js","resources/index.js","syncsetting/app.js","syncsetting/environment.js","syncsetting/main.js","tabs/messages.js","tabs/simpletab.js","tabs/simpletabs.js","tabs/tabs.js","uploaddirpicker/app.js","uploaddirpicker/main.js","uploaddirpicker/uploaddirpanel.js","utils/vfstorage.js","virtualfoldermodules/app.js","virtualfoldermodules/ccp4control.js","virtualfoldermodules/main.js","virtualfoldermodules/modulecontrol.js","virtualfoldermodules/modulesetting.js","virtualfoldermodules/scipioncontrol.js","virtualfoldermodules/virtuosocontrol.js","virtualfoldersetting/aliastable.js","virtualfoldersetting/app.js","virtualfoldersetting/clouddeployment.js","virtualfoldersetting/dropboxcontrol.js","virtualfoldersetting/genericcontrol.js","virtualfoldersetting/importprovider.js","virtualfoldersetting/main.js","virtualfoldersetting/messages.js","virtualfoldersetting/storageprovider.js","virtualfoldersetting/taskcontrol.js"],"names":["App","configureRouter","config","router","title","map","route","name","moduleId","nav","mapUnknownRoutes","_singleton","Symbol","RedirectLogin","rurl","window","location","pathname","redirectUrl","handlelogin","maylogout","loginb","document","getElementById","logoutb","removeAttribute","className","ShowLoginButton","HandleLogin","contructor","senderid","MayLogout","debug","testing","configure","Promise","warnings","wForgottenReturn","aurelia","use","standardConfiguration","plugin","feature","developmentLogging","start","then","setRoot","Navitem","Advancedfilepicker","ea","handler","subscribe","selectFile","msg","file","opener","postMessage","protocol","hostname","publicwebdavuri","close","inject","longStackTraces","Viewpanel2","VfAutocompleteSearch","httpclient","http","resultBoxAlign","redirectOnClick","searchUrl","fields","group","groupLimit","sort","additionalParams","hideSuggestions","showing","blurSuggestions","evt","relatedTarget","startsWith","showSuggestions","focusSuggestions","value","search","term","url","fetch","response","json","resultGroups","data","grouped","category","groups","catch","console","log","err","keypressed","key","keyCode","originalTarget","submit","item","Name","target","clicked","clickvalue","Type","var_name","valueChanged","newValue","oldValue","length","searchMore","filter","fqVal","ProjectApi","metadataapiurl","userinfourl","fileserviceurl","getpublicwebdavurl","dataseturl","taskurl","userprocessurl","settingsurl","providersurl","rejectErrorResponses","withBaseUrl","withDefaults","credentials","headers","putHeaders","Headers","append","emptyHeaders","fetchJsonLog","error","fetchTextLog","text","head","method","deleteJsonLog","postJsonLogNoBody","postTextLogNoBody","postJsonLog","datatosend","body","putJsonLog","mode","getUserInfo","getPublicWebDav","getFiles","path","getProviders","putProvider","settings","deleteProvider","alias","getDataset","id","context","addDataset","dataset","getExportedSettings","publickey","selectedaliases","queryurl","URL","href","params","PublicKey","SelectedAliases","Object","keys","forEach","searchParams","getPublicKey","putSettings","importmessage","getTask","stopTask","taskName","startTask","getFileHead","filepath","Sharedheader","projectapi","pa","showuserinfo","attached","userinfo","username","AccountLink","LogoutLink","endsWith","Userinfo","CodeMirror","Fileeditor","el","client","isimage","filename","editor","querySelector","codemirror","fromTextArea","cmTextarea","lineNumbers","lineWrapping","refresh","disablenextbuttons","offset","that","pid","imageurl","webdavuri","getValue","setValue","alert","fetchNext","replaceRange","Pos","lastLine","status","fetchRest","Element","dialogService","closeviewer","setupFileManager","open","viewModel","model","wasCancelled","Prompt","controller","answer","centerHorizontalOnly","activate","message","visualizepdb","checkDefault","visualizeimg","Storage","ok","localStorage","getItem","Panel","selectTab","tabid","selectedView","selectedVisual","selectedDataset","selectedList","bind","ids","selectedTab","paneltabs","label","showpdb","publish","host","Filepanel","pdbresource","uniprotresource","files","lastpath","dynatable","sorted","none","reverse","byname","bydate","bysize","byext","wassorted","baseresources","info","resources","filescount","isPdb","isUniprot","isFiles","selectedResources","panelid","sortByX","sortflag","sortfunction","shift","addUpDir","unshift","nicesize","date","available","sortByName","a","b","sortBySize","size","sortByDate","extension","re","exec","sortByExt","ext","handleError","serviceurl","statusCode","statusText","populateFiles","dateTimeReviver","Date","parseInt","toLocaleDateString","navigator","language","cdup","sepIndex","lastIndexOf","substring","cddown","subdir","cdroot","goroot","changefolder","folder","lock","dataresponse","currentdir","index","arr","attributes","filetype","nicedate","selectResource","resource","replace","checkResource","appendResources","push","escape","SelectedFile","CheckedFile","VisualizeFile","EditFile","DatasetFile","PopulateResources","Pdbpanel","currentpath","impl","populateResource","slice","Pdbresource","requesturlpdbid","requesturlnums","requesturlfiles","pdbredourl","pdbredosuffixes","myresource","link","callback","fetchLog","push1_9","i","push0_9a_z","prefix","resources2","numFound","responseHeader","q","charCodeAt","String","fromCharCode","check0_9a_z","docs","pdb_id","getlisttodownload","pdbid","key2","downloads","substr","suffix","Uniprotpanel","Uniprotresource","Filemanager","ds","Filepicker","popup","receiveMessage","innerHTML","event","setAttribute","addEventListener","detached","removeEventListener","openfilepickerwindow","_target","openwindow","openuploaddirpickerwindow","Virtualfolderhome","islocalhost","webdavurl","Virtualfoldersetting","Checkurl","showit","Dataitem","entityids","selectedid","showitem","itemPDBEntry","isPDBEntry","itemUniprotEntry","isUniprotEntry","entryname","molecule_type","entity_id","selectedValueChanged","stemel1","el1","cloneNode","stemel2","el2","newel","parent","parentNode","removeChild","appendChild","angular","bootstrap","hideitem","test","entry","Dataset","addDatasetFile","baseurl","showlist","pdbdataset","pdbdataitem","pdblinkset","submitdisabled2","createnewdataset","getFullYear","getMonth","getDate","datasetlist","unselectdataset","selectdataset","Id","submitdataset","Entries","removedataset","additem","confirm","Url","removeitem","itemtodelete","EntryIdCustomAttribute","element","Hideable","defaulthide","changeshowit","PdbIdCustomAttribute","PdbIdsCustomAttribute","bootstrapped","pdbids","split","pdbidsfilter","obj","pdbidsjson","JSON","stringify","myclone","elementclone","children","Sasclient","get","Viewpanel","viewfile","sourceurl","sourceformat","pdbentry","pdbredoentry","pdburl","pdblitemol","replacepdblitemol","loadfromredo","loadpdb","pdbviewer","parentnode","insertAdjacentHTML","Icopy","port","hrefid","copyclipboard","inputElement","select","execCommand","globalResources","providers","temporary","loading","loadederror","getParams","x","selected","include","provider","notinclude","import","prov","join","EncryptedSettings","aliases","SelectedTab","Simpletab","SimpleTabs","_DOMElement","tabsEl","activeTabIdx","call","querySelectorAll","changeTab","t","getAttribute","css","width","tabWidth","left","Tabs","selectVisualize","selectEdit","tabs","activeid","active","opentab","Uploaddirpanel","selectThisDir","Vfstorage","propertyName","defaultvalue","setItem","getBaseUrl","virtualfolderbaseurl","parseQueryString","str","ret","create","trim","param","parts","val","undefined","decodeURIComponent","Array","isArray","query","reduce","Ccp4control","posturl","Modulecontrol","HttpClient","enabled","withHeader","okcallback","failcallback","res","parse","enable","post","Modulesetting","Scipioncontrol","Virtuosocontrol","Aliastable","submitSettings","removeProvider","Clouddeployment","Dropbox","DropboxControl","accesstoken","hash","access_token","isAuthenticated","CLIENTIDENC","dbx","clientId","c","currentUrl","authurl","getAuthenticationUrl","e","initialize","type","securetoken","Genericcontrol","dropboxcontrol","heading","editing","filespath","knowtoken","dropboxauthurl","selectedProvider","selectSettings","myHeaders","clear","filesystempath","accessurl","addProvider","selectedDropbox","selectedFileSystem","selectedB2Drop","password","selectedWebDav","selectedOnedata","knownSecureToken","checked","Importprovider","importingSettings","confirmSettings","remoteurl","importProvider","remotesettingsurl","conflicts","oldnames","newnames","aliasestmp","oldname","newname","importSettings2","ConflictedAliases","NewNameAliases","SettingsSubmitted","SettingsSelected","SettingsRemoved","Storageprovider","showprovider","showimport","newProvider","Taskcontrol","tasks","descriptions","task","Description","Updating","starttask","task1","updatetask","setTimeout","Running","LocalUrl","reason","stoptask","resolve","reject"],"mappings":"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","file":"app-bundle.js","sourcesContent":["\nexport class App {\n  configureRouter(config, router) {\n    config.title = 'West-Life Virtual Folder Router';\n\n    config.map([\n      {route: ['', 'dashboard'], name: 'dashboard', moduleId: 'pages/virtualfolderhome', nav: true, title: 'Dashboard'},\n      {route: 'setting', name: 'setting', moduleId: 'pages/virtualfoldersetting', nav: true, title: 'Setting'},\n      {route: 'filemanager', name: 'filemanager', moduleId: 'pages/filemanager', nav: true, title: 'File Manager'},\n      {route: 'filepicker', name: 'filepicker', moduleId: 'pages/filepicker', nav: true, title: 'File Picker'}\n\n    ]);\n    config.mapUnknownRoutes('pages/virtualfoldersetting');\n    //config.fallbackRoute('setting');\n    this.router = router;\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 10/9/17.\n */\n\n\nlet _singleton = Symbol();\n\nexport class RedirectLogin {\n\n  constructor(rurl = \"/login?next=\" + window.location.pathname) {\n    this.redirectUrl = rurl;\n  }\n\n  handlelogin(){\n    //redirect to another url - presumably with login feature - should redirect back\n    window.location = this.redirectUrl;\n  }\n\n  maylogout() {\n    //show/hide login/logout button only\n    let loginb = document.getElementById(\"loginbutton\");\n    let logoutb = document.getElementById(\"logoutbutton\");\n    //removes style - by default style=display:none\n    if (logoutb && loginb) {\n      logoutb.removeAttribute(\"style\");\n      loginb.removeAttribute(\"style\");\n      loginb.className = \"w3-hide\";\n      logoutb.className = \"w3-sign\";\n    }\n  }\n\n}\n\nexport class ShowLoginButton {\n\n  constructor() {\n  }\n\n  handlelogin(){\n    //show/hide login/logout button only\n    let loginb = document.getElementById(\"loginbutton\");\n    let logoutb = document.getElementById(\"logoutbutton\");\n    //removes style - by default style=display:none\n    if (logoutb && loginb) {\n      logoutb.removeAttribute(\"style\");\n      loginb.removeAttribute(\"style\");\n      loginb.className = \"w3-sign\";\n      logoutb.className = \"w3-hide\";\n    }\n  }\n\n  maylogout() {\n    //show/hide login/logout button only\n    let loginb = document.getElementById(\"loginbutton\");\n    let logoutb = document.getElementById(\"logoutbutton\");\n    //removes style - by default style=display:none\n    if (logoutb && loginb) {\n\n      logoutb.removeAttribute(\"style\");\n      loginb.removeAttribute(\"style\");\n      loginb.className = \"w3-hide\";\n      logoutb.className = \"w3-sign\";\n    }\n  }\n\n}\n\n\nexport class HandleLogin {\n  contructor(senderid) {\n    this.senderid=senderid;\n  }\n}\n\nexport class MayLogout {\n  contructor(senderid) {\n    this.senderid=senderid;\n  }\n}\n","export default {\n  debug: true,\n  testing: true\n};\n","//Configure Bluebird Promises not to throw warnings about aurelia empty promises\nPromise.config({\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .plugin('aurelia-dialog')\n    .feature('resources')\n    .developmentLogging();\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 3/16/17.\n */\nimport {bindable} from 'aurelia-framework';\n\n/** Navitem component <navitem href=\"reference\">content</navitem> renders <a></a> with styling\n */\nexport class Navitem {\n  @bindable href;\n}\n","export class Advancedfilepicker {\n\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from '../filepicker/messages';\nimport {CheckedFile} from '../filepicker/messages';\nimport {HandleLogin} from '../behavior';\nimport {ShowLoginButton} from '../behavior';\n\nexport class App {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.ea = ea;\n    this.handler = new ShowLoginButton();\n    //this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file));\n    this.ea.subscribe(CheckedFile, msg => this.selectFile(msg.file));\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n  }\n\n  selectFile(file){\n    window.opener.postMessage(window.location.protocol+\"//\"+window.location.hostname+file.publicwebdavuri, \"*\");\n    window.close();\n  }\n\n}\n","export default {\n  debug: true,\n  testing: false\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .plugin('aurelia-dialog')\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","export class Viewpanel2 {\n\n}\n","/**\n * Created by Tomas Kulhanek on 4/4/17.\n */\n\n\nimport {bindable} from 'aurelia-framework';\nimport {HttpClient} from 'aurelia-fetch-client';\nimport {computedFrom} from 'aurelia-framework';\n\n/** Virtual Folder Autocomplete Search client web component to work with API at ebi.ac.uk\n *\n */\nexport class VfAutocompleteSearch {\n  @bindable value = \"\"; // value of input\n  @bindable placeholder = \"\";\n  @bindable size = \"40\";\n  @bindable submit;\n\n  static inject = [HttpClient];\n\n  constructor(httpclient) {\n    this.http = httpclient;\n    this.config = {\n      resultBoxAlign: 'left',\n      redirectOnClick: false,\n      searchUrl: '//www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select',\n      fields: 'value,num_pdb_entries,var_name',\n      group: 'group=true&group.field=category',\n      groupLimit: '25',\n      sort: 'category+asc,num_pdb_entries+desc',\n      additionalParams: 'rows=20000&json.nl=map&wt=json'\n    }\n  }\n\n  /*hides the suggestion by setting the binded property to false*/\n  hideSuggestions() {\n      this.showing=false;\n  }\n\n  /* check if blured to related element, then no hiding, otherwise hide*/\n  blurSuggestions(evt) {\n    if (evt.relatedTarget && evt.relatedTarget.className.startsWith('result-card-item')) return;\n    this.hideSuggestions();\n  }\n\n  /* show the suggestions by setting the binded proparty to true*/\n  showSuggestions() {\n    this.showing=true;\n  }\n\n  /* reset the value in input field and shows */\n  focusSuggestions() {\n    this.value=\"\";\n    this.showSuggestions();\n  }\n\n  /**\n   * Method to search via AJAX call for the suggestion items which will be shown\n   */\n  search(){\n    let term = this.value;\n    let config = this.config;\n    let url = `${config.searchUrl}?${config.additionalParams}&${config.group}&fl=${config.fields}&sort=${config.sort}&group.limit=${config.groupLimit}&q=value:${term}*~10`\n    return this.http\n      .fetch(url)\n      .then(response => response.json())\n      .then(data => {\n        //console.log(\"search response:\")\n        //console.log(data);\n        this.resultGroups= data.grouped.category.groups\n        //console.log(this.resultGroups);\n      })\n      .catch( err => {console.log('error search()');console.log(err)});\n  }\n\n  /* just compute if the results group is empty */\n @computedFrom('resultGroups')\n get resultGroupsEmpty() {\n   return this.showing && this.resultGroups && this.resultGroups.length == 0;\n }\n\n /**\n  * Method triggered when a key is pressed,\n  * enter = submit, esc= hide suggestion\n  * @param {event} DOM event holding key pressed */\n keypressed(evt){\n   let key = evt.keyCode;\n   if (key === 13) {\n     /*may not be updated with input field as debounce has 750 ms this.submit({item:this.value});\n      */\n     //console.log(\"keypressed(): submitting()\")\n     //this.hideSuggestions();\n     if (evt.originalTarget) this.submit({item: {Name:evt.originalTarget.value}}) //in Firefox\n     else if (evt.target) this.submit({item: {Name:evt.target.value}}) //in IE\n     this.hideSuggestions();\n   } else\n     if (key===27) this.hideSuggestions();\n   else\n     this.showSuggestions();\n\n   return true;\n }\n\n  /**\n   * Method triggered when a suggestion item was clicked,\n   * therefore taking it's value, submit and hide\n   * @param {clickvalue} value which was clicked and will be submitted */\n  clicked(clickvalue) {\n    //console.log(\"clicked(): submitting()\")\n    //console.log(clickvalue);\n    this.value = clickvalue.value;\n    this.submit({item:{Name:clickvalue.value,Type:clickvalue.var_name}});\n    this.hideSuggestions();\n  }\n\n  /**\n   * Method triggered by AU when a value in input field is changed,\n   * using debounce - it is triggered only after some delay (750ms) */\n  valueChanged(newValue,oldValue){\n    if (this.value && this.value.length>0) {\n      this.search();\n\n    }\n  }\n\n /**\n  * Method to search for more suggestions api call\n  * @param {filter} a name of the group to be filtered\n  */\n  searchMore(filter) {\n    let term = this.value;\n      let fqVal = filter;\n        let config=this.config;\n    let url = `${config.searchUrl}?${config.additionalParams}&${config.group}&fl=${config.fields}&sort=${config.sort}&group.limit=-1&q=value:${term}*~10&fq=var_name:${fqVal}`\n    return this.http\n    //.get(`${this.pdbSolrUrl}&group.limit=-1&q=value:${term}*~10&fq=var_name:${fqVal}`)\n      .fetch(url)\n      .then(response => response.json())\n      .then(data => {\n        this.resultGroups= data.grouped.category.groups\n      })\n      .catch( err => {console.log('error searchMore()'); console.log(err);});\n  }\n}\n","import {HttpClient, json} from 'aurelia-fetch-client';\nimport {Vfstorage} from \"../utils/vfstorage\";\n//import {Csrfheaderinterceptor} from '../components/csrfheaderinterceptor';\n/* Provides methods to return promise of data from REST Project api*/\n\nexport class ProjectApi {\n  static inject = [HttpClient];\n\n\n  constructor(httpclient) {\n    this.httpclient = httpclient;\n    //needs SSO credentials\n    this.metadataapiurl = \"api\";\n    this.userinfourl = this.metadataapiurl + \"/userinfo\";\n    this.fileserviceurl = this.metadataapiurl + \"/files\";\n    this.getpublicwebdavurl = \"/api/authproxy/get_signed_url/\";\n    this.dataseturl = this.metadataapiurl + \"/dataset\";\n    this.taskurl = this.metadataapiurl + \"/availabletasks\";\n    this.userprocessurl = this.metadataapiurl + \"/userprocess\";\n    //this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/files\";\n    this.settingsurl = this.metadataapiurl + \"/settings\";\n    this.providersurl = this.metadataapiurl + \"/providers\";\n    this.httpclient.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withBaseUrl('')\n        .withDefaults({\n          credentials: 'same-origin',\n          headers: {\n            'Accept': 'application/json'\n          }             \n          //          'X-Requested-With': 'Fetch'\n          // }          \n        })\n    });\n    this.putHeaders= new Headers();\n    this.putHeaders.append('Accept', 'application/json');\n    this.putHeaders.append('Content-Type', 'application/json');\n    this.emptyHeaders = new Headers();\n  }\n\n  //generic methods to fetch, serialize to json and log error\n  fetchJsonLog(url) {\n    return this.httpclient.fetch(url)\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(\"fetch on '\" + url + \"' returns error:\", error);\n        throw error;\n      });\n  }\n\n  //generic methods to fetch, (no json serialization) and log error\n  fetchTextLog(url) {\n    return this.httpclient.fetch(url,{headers:this.emptyHeaders})\n      .then(response => response.text())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(\"fetch on '\" + url + \"' returns error:\", error);\n        throw error;\n      });\n  }\n\n  head(url) {\n    return this.httpclient.fetch(url,{method:'head'})\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(\"head on '\" + url + \"' returns error:\", error);\n        throw error;\n      });\n  }\n\n  deleteJsonLog(url) {\n    return this.httpclient.fetch(url, {method: \"delete\"})\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(\"delete on '\" + url + \"' returns error:\", error);\n        throw error;\n      });\n  }\n\n  postJsonLogNoBody(url) {\n    return this.httpclient.fetch(url, {method: 'post'})\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(\"post on '\" + url + \"' returns error:\", error);\n        throw error;\n      });\n  }\n//text json serialization\n  postTextLogNoBody(url) {\n    return this.httpclient.fetch(url, {method: 'post'})\n      .then(data=> data.text())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(\"post on '\" + url + \"' returns error:\", error);\n        throw error;\n      });\n  }\n  \n  postJsonLog(url,datatosend) {\n    return this.httpclient.fetch(url, {method: 'post', body: json(datatosend)})\n      .then(response => response.json())\n      .then(data => {\n        return data;\n      })\n      .catch(error => {\n        console.log(\"post on '\" + url + \"' returns error:\", error);\n        throw error;\n      });\n  }\n  \n  putJsonLog(url,datatosend){\n    console.log(\"put on '\" + url + \"' test2\");\n    return this.httpclient.fetch(url, {method: 'PUT', mode:'cors', body: json(datatosend),credentials:'include',headers:this.putHeaders})\n      .then(response => response.json())      \n      .then(data => {\n        //console.log(\"putjsonlog\",data);\n        return data;\n      })\n      .catch(error => {\n        console.log(\"put on '\" + url + \"' returns error:\", error);\n        throw error;\n      });     \n  }\n\n  //specific methods to specific urls\n  getUserInfo() {\n    return this.fetchJsonLog(this.userinfourl);\n  }\n\n  getPublicWebDav() {\n    return this.fetchJsonLog(this.getpublicwebdavurl);\n  }\n\n  getFiles(path = \"\") {\n    return this.fetchJsonLog(this.fileserviceurl + path);\n  }\n\n  getProviders() {\n    return this.fetchJsonLog(this.providersurl);\n  }\n\n  putProvider(settings) {\n    return this.putJsonLog(this.fileserviceurl, settings);\n  }\n\n  deleteProvider(alias) {\n    return this.deleteJsonLog(this.fileserviceurl + \"/\" + alias);\n  }\n\n  getDataset(id = \"\") {\n    let context = (id === \"\") ? \"\" : \"/\" + id; //prexif slash before id\n    return this.fetchJsonLog(this.dataseturl + context);\n  }\n\n  addDataset(id = \"\", dataset) {\n    if (id > 0)\n      return this.putJsonLog(this.dataseturl + \"/\" + this.id, dataset);\n    else\n      return this.postJsonLog(this.dataseturl, dataset)\n  }\n\n  getExportedSettings(publickey, selectedaliases) {\n//use public key and selectedaliases to construct request with params \n    let queryurl = new URL(this.settingsurl,window.location.href);\n    let params = {PublicKey: publickey, SelectedAliases: selectedaliases};\n    Object.keys(params).forEach(key => queryurl.searchParams.append(key, params[key]));\n//now request client\n    return this.fetchTextLog(queryurl);\n//create selectedaliases\n  }\n\n  //    this.client.post(this.localsettingservice)\n  \n  getPublicKey() {\n    return this.postTextLogNoBody(this.settingsurl);\n  }\n\n  //json is made here\n  putSettings(importmessage) {\n    return this.putJsonLog(this.settingsurl,importmessage);\n  }\n\n\n  getTask() {\n    return this.fetchJsonLog(this.taskurl);\n  }\n\n  stopTask(taskName) {\n    return this.deleteJsonLog(this.userprocessurl + \"/\" + taskName);\n  }\n\n  //this.client.delete(this.userprocessurl+task.Name)\n\n  startTask(taskName) {\n    return this.postJsonLogNoBody(this.userprocessurl + \"/\" + taskName);\n  }\n\n  getFileHead(filepath) {\n    return this.head(this.fileserviceurl+'/'+filepath);\n  }\n}\n","import {ProjectApi} from './projectapi';\nimport {bindable} from 'aurelia-framework'\n\nexport class Sharedheader {\n  static inject = [ProjectApi];\n  @bindable router;\n\n  constructor(projectapi) {\n    this.pa = projectapi;\n    this.showuserinfo=false;\n  }\n\n  attached(){\n    console.log(\"Sharedheader\",this.router);\n    this.pa.getUserInfo().then(data => {\n      //console.log(data);\n      this.userinfo=data;\n      //vagrant user - no link\n      if (this.userinfo.username ==='vagrant') {\n        this.userinfo.AccountLink=\"\";\n        this.userinfo.LogoutLink=\"/logout\";\n        }\n      //west-life sso user - link to westlife sso page\n      else if (this.userinfo.username.endsWith(\"west-life.eu\")) {\n        this.userinfo.AccountLink=\"https://auth.west-life.eu/user/\"\n        this.userinfo.LogoutLink=\"/mellon/logout?ReturnTo=/\";\n      //ARIA user - link to structuralbiology\n      }\n      else {\n        this.userinfo.AccountLink = \"https://www.structuralbiology.eu/user\";\n        this.userinfo.LogoutLink=\"/logout\";\n      }\n      if (!this.userinfo.name) this.userinfo.name=this.userinfo.username;\n      this.showuserinfo=true;\n    })\n      .catch(error => {\n        console.log(\"no user info, disable showing it\");\n        this.showuserinfo=false;\n      })\n  }\n}\n","import {ProjectApi} from './projectapi';\n\nexport class Userinfo {\n  static inject = [ProjectApi];\n\n  constructor(projectapi) {\n    this.pa = projectapi;\n    this.showuserinfo=false;\n  }\n\n  attached(){\n    this.pa.getUserInfo().then(data => {\n        console.log(data);\n        if (data.username === \"\") {\n          console.log(\"no user info, disable showing it\");\n          this.showuserinfo=false;\n        } else {\n          this.userinfo = data;\n          this.showuserinfo = true;\n        }\n      })\n      .catch(error => {\n        console.log(\"no user info, disable showing it\");\n        this.showuserinfo=false;\n      })\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 2/17/17.\n */\n\nimport * as CodeMirror from \"codemirror\";\nimport \"codemirror/mode/clike/clike\";\nimport \"codemirror/mode/htmlmixed/htmlmixed\";\nimport \"codemirror/mode/javascript/javascript\";\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {HttpClient} from 'aurelia-fetch-client';\nimport {EditFile} from '../filepicker/messages';\nimport {bindable} from 'aurelia-framework';\nimport {Vfstorage} from '../utils/vfstorage';\n\n//import $ from 'jquery';\n\nexport class Fileeditor {\n  static inject = [Element,EventAggregator, HttpClient];\n  @bindable pid;\n\n  constructor(el,ea) {\n    this.el = el;\n    this.ea = ea;\n    this.client = new HttpClient();\n    this.client.configure(config => {\n      config\n        .rejectErrorResponses()\n        .withBaseUrl('')\n        .withDefaults({\n          credentials: 'same-origin'\n        })\n    });\n    this.ea.subscribe(EditFile, msg => this.selectFile(msg.file,msg.senderid));\n    this.isimage=false;\n    this.filename=\"\";\n  }\n\n  attached() {\n    let editor = this.el.querySelector(\".Codemirror\");\n    //prevent blured render if not shown before\n    //if (editor==null)\n    this.codemirror = CodeMirror.fromTextArea(this.cmTextarea, {\n      lineNumbers: true,\n      mode: \"text/x-less\",\n      lineWrapping: true\n    });\n    this.codemirror.refresh();\n  }\n\n  selectFile(file,senderid) {\n    this.disablenextbuttons=false;\n    this.offset = 0;\n    let that =this;\n    if (senderid!=this.pid) {\n      this.imageurl = file.webdavuri;\n      //visualizeimg is set & image extension is detected\n      //console.log(\"fileeditor.selectfile() visualizeimg: isimage:\")\n      //console.log(localStorage.getItem(\"visualizeimg\"));\n      //vfstorage returns string - should convert to boolean\n      this.isimage = (Vfstorage.getValue(\"visualizeimg\") == \"true\") &&\n      ((file.name.endsWith('.JPG'))||\n      (file.name.endsWith('.jpg'))||\n      (file.name.endsWith('.PNG'))||\n      (file.name.endsWith('.png'))||\n      (file.name.endsWith('.GIF'))||\n      (file.name.endsWith('.gif'))||\n      (file.name.endsWith('.BMP'))||\n      (file.name.endsWith('.bmp'))||\n      (file.name.endsWith('.SVG'))||\n      (file.name.endsWith('.svg')));\n\n      //console.log(\"fileeditor.selectfile() visualizeimg: isimage:\")\n      //console.log(this.isimage);\n      if (!this.isimage)\n        //fetch first 4 kb\n        this.client.fetch(file.webdavuri, {credentials: 'same-origin',headers:{'Range':'bytes='+this.offset+'-'+(this.offset+4095)}})\n          .then(response => response.text())\n          .then(data =>{\n            //console.log(\"fileeditor.selectfile() loading:\" + file.webdavuri);\n            //console.log(data);\n            that.codemirror.setValue(data);\n            that.codemirror.refresh();\n            that.filename=file.webdavuri;\n          }\n        ).catch(error => {\n          if (error.name ===\"TypeError\") {\n            //fetch for range header failed, so try to get full file\n            console.log('fetch on range rejected, trying without range');\n            this.client.fetch(file.webdavuri, {credentials: 'same-origin'})\n              .then(response => response.text())\n              .then(data => {\n                //console.log(\"fileeditor.selectfile() loading:\" + file.webdavuri);\n                //console.log(data);\n                that.codemirror.setValue(data);\n                that.codemirror.refresh();\n                that.filename = file.webdavuri;\n              });\n          }\n          else {\n            alert('Error retrieving content from ' + file.webdavuri);\n            console.log('Error:',error);\n          }\n        });\n    }\n  }\n  \n  fetchNext() {\n    this.offset+=4096;\n    this.client.fetch(this.filename, {credentials: 'same-origin',headers:{'Range':'bytes='+this.offset+'-'+(this.offset+4095)}})\n      .then(response => response.text())\n      .then(data =>{\n          //console.log(\"fileeditor.selectfile() loading:\" + this.file.webdavuri);\n          //console.log(data);\n          this.codemirror.replaceRange(data, CodeMirror.Pos(this.codemirror.lastLine()));\n          //this.codemirror.setValue(data);\n          this.codemirror.refresh();\n        }\n      ).catch(error => {\n        if (error.status === 416) {\n          //reached end of file\n          this.disablenextbuttons=true;\n        } else {\n          alert('Error retrieving content from ' + this.filename);\n          console.log(error);\n        }\n    });\n  }\n  \n  fetchRest() {\n    this.client.fetch(this.file.webdavuri, {credentials: 'same-origin'})\n      .then(response => response.text())\n      .then(data =>{\n          //console.log(\"fileeditor.selectfile() loading:\" + this.filename);\n          //console.log(data);\n          that.codemirror.setValue(data);\n          that.codemirror.refresh();\n        }\n      ).catch(error => {\n      alert('Error retrieving content from ' + this.filename);\n      console.log(error);\n    });\n    \n  }\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from '../filepicker/messages';\nimport {computedFrom} from 'aurelia-framework';\nimport {DialogService} from 'aurelia-dialog';\nimport {inject} from 'aurelia-framework';\nimport {Prompt} from './fmsettings';\nimport {HandleLogin,MayLogout,ShowLoginButton} from '../behavior';\n\n//@inject(DialogService)\n\nexport class App {\n  static inject = [EventAggregator,DialogService];\n\n  constructor(ea,dialogService) {\n    this.ea = ea;\n    this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file,msg.senderid));\n    //shows logout button by default\n    this.handler = new ShowLoginButton();\n    //if it detects that it is not logged in - e.g. 403 returned - shows Login button instead\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n    this.ea.subscribe(MayLogout, msg => this.handler.maylogout());\n    this.dialogService=dialogService;\n  }\n\n  selectFile(file,senderid){\n    //console.log(\"selectFile()\")\n    //console.log(file);\n    //console.log(senderid);\n    //window.opener.postMessage(window.location.protocol+\"//\"+window.location.hostname+file.webdavuri, \"*\");\n    //window.close();\n  }\n\n  closeviewer(){\n  }\n\n  setupFileManager(){\n    this.dialogService.open({viewModel: Prompt, model: 'File Manager Settings' }).then(response => {\n      //console.log(response);\n\n      if (!response.wasCancelled) {\n        //console.log('dialog OK');\n      } else {\n        //console.log('dialog cancelled');\n      }\n      //console.log(response.output);\n    });\n  }\n\n}\n","export default {\n  debug: true,\n  testing: false\n};\n","/**\n * Created by Tomas Kulhanek on 6/16/17.\n */\nimport {inject} from 'aurelia-framework';\nimport {DialogController} from 'aurelia-dialog';\nimport {Vfstorage} from '../utils/vfstorage';\n\n@inject(DialogController)\n\nexport class Prompt {\n\n  constructor(controller){\n    this.controller = controller;\n    this.answer = null;\n    controller.settings.centerHorizontalOnly = true;\n  }\n\n  activate(message) {\n\n    this.visualizepdb = Vfstorage.checkDefault(\"visualizepdb\",\"true\") == \"true\"; //localstorage stores string instead of bool - convert to bool\n    this.visualizeimg = Vfstorage.checkDefault(\"visualizeimg\",\"true\") == \"true\";\n    //console.log(\"active visualizepdb:\"+this.visualizepdb);\n    this.message = message;\n    this.log(\"activate.post\");\n  }\n\n  close(){\n    if (typeof(Storage) !== \"undefined\") {\n      Vfstorage.setValue(\"visualizepdb\",this.visualizepdb);\n      Vfstorage.setValue(\"visualizeimg\",this.visualizeimg);\n    }\n    this.log(\"close\");\n    this.controller.ok()\n  }\n\n  log(method){\n    console.log(\"Fmsettings.\"+method+\"(), visualizepdb, visualizeimg\")\n    console.log(this.visualizepdb);\n    console.log(localStorage.getItem(\"visualizepdb\"));\n    console.log(this.visualizeimg);\n    console.log(localStorage.getItem(\"visualizeimg\"));\n\n  }\n\n}\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .plugin('aurelia-dialog')\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 2/10/17.\n */\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile,VisualizeFile,EditFile,DatasetFile} from '../filepicker/messages';\nimport {SelectedTab} from '../tabs/messages';\nimport {bindable} from 'aurelia-framework';\n\nexport class Panel {\n    static inject = [EventAggregator];\n    @bindable pid;\n\n    constructor(ea) {\n        this.ea = ea;\n\n        this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file,msg.senderid));\n        this.ea.subscribe(SelectedTab, msg => this.selectTab(msg.tabid));\n        //generate unique id from time\n        //this.pid = new Date().valueOf();\n        this.selectedView=this.selectedVisual=this.selectedDataset=false;\n        this.selectedList=true;\n    }\n\n    bind(){\n      this.ids=[this.pid+'.list',this.pid+'.view',this.pid+'.visual',this.pid+'.analyse',this.pid+'.dataset']; //prefix uid to tab ids\n\n      this.selectedTab= this.ids[0];\n      this.paneltabs = [\n        { id: this.ids[0], label: 'File List'},\n        { id: this.ids[1], label: 'View/Edit'},\n        { id: this.ids[2], label: 'Visualize'},\n        { id: this.ids[3], label: 'Dataset'}\n      ];\n    }\n\n    selectTab(tabid){\n        //if uid belongs to mine - change tab, otherwise ignore this message\n        if (tabid.startsWith(this.pid)) {\n            this.selectedTab = tabid;\n            this.selectedList = this.selectedTab == this.ids[0];\n            this.selectedView = this.selectedTab == this.ids[1];\n            this.selectedVisual = this.selectedTab == this.ids[2];\n            this.selectedDataset = this.selectedTab == this.ids[3];\n        }\n    }\n\n    selectFile(file,senderid) {\n      //default action, visualize pdb, if localStorage.getItem(\"visualizepdb\") is defined then it needs to be true,\n      let showpdb = (file.webdavuri.endsWith('pdb') || file.webdavuri.endsWith('ent') || file.webdavuri.endsWith('cif')) ? (typeof(Storage) !== \"undefined\") ? localStorage.getItem(\"visualizepdb\") ? localStorage.getItem(\"visualizepdb\") === \"true\" : true : true : false;\n      if (senderid!=this.pid) {\n        if (this.selectedDataset) { //add to dataset\n          this.ea.publish(new DatasetFile(file,senderid));\n        }\n        else //visualize/show file\n        if (showpdb) {\n          //visualize\n          this.selectTab(this.ids[2]);\n          this.ea.publish(new VisualizeFile(file,senderid));\n        } else {\n          //edit/raw view\n          this.selectTab(this.ids[1]);\n          this.ea.publish(new EditFile(file,senderid));\n        }\n      }\n    }\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from './messages';\nimport {HandleLogin} from '../behavior';\nimport {RedirectLogin} from '../behavior';\n\nexport class App {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.ea = ea;\n    this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file));\n    this.handler = new RedirectLogin();\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n  }\n\n  selectFile(file){\n    window.opener.postMessage(window.location.protocol+\"//\"+window.location.host+file.publicwebdavuri, \"*\");\n    window.close();\n  }\n\n}\n","export default {\n  debug: true,\n  testing: false\n};\n","/**\n * created by Tomas Kulhanek on 9/28/16.\n */\n\nimport 'whatwg-fetch';\nimport {ProjectApi} from '../components/projectapi';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from './messages';\nimport {CheckedFile} from './messages';\nimport {HandleLogin,MayLogout} from '../behavior';\n\nimport {bindable} from 'aurelia-framework';\nimport {Vfstorage} from '../utils/vfstorage';\n\nimport {Pdbresource} from './pdbresource';\nimport {Uniprotresource} from './uniprotresource';\n\nexport class Filepanel {\n  static inject = [EventAggregator, ProjectApi, Pdbresource, Uniprotresource];\n  @bindable panelid;\n\n  constructor(ea, pa, pdbresource, uniprotresource) {\n    this.ea = ea;\n    this.pa = pa;\n    this.files = [];\n    this.path = \"\";\n    this.lastpath = this.path;\n    this.dynatable = {};\n    this.sorted = {none: 0, reverse: 1, byname: 2, bydate: 4, bysize: 8, byext: 16}\n    this.wassorted = this.sorted.none;\n    this.baseresources = [{name: \"PDB\", info: \"Protein Data Bank repository entries from ebi.ac.uk\", id: \"pdb\"}]\n    this.resources = [];\n    //this.ea.subscribe(PopulateResources, msg => this.populateResource(msg.resources,msg.senderid));\n    this.filescount = this.files.length + this.resources.length;\n    this.isPdb = this.isUniprot = false;\n    this.pdbresource = pdbresource;\n    this.uniprotresource = uniprotresource;\n    this.isFiles = true;\n    this.selectedResources = [];\n  }\n\n  bind() {\n    this.path = Vfstorage.getValue(\"filepanel\" + this.panelid, \"\");\n    if (this.path == \"\") this.resources = this.baseresources;\n    //localStorage && (localStorage.getItem(\"filepanel\" + this.panelid)) ? localStorage.getItem(\"filepanel\" + this.panelid) : \"\";\n    this.lastpath = \"\";\n  }\n\n  sortByX(sortflag, sortfunction) {\n    //console.log(\"Filepanel sort\");\n    //console.log(this.files);\n    if (this.path.length > 0) {//non root path\n      this.files.shift(); //take the first '..'\n    }\n\n    //sort by name if previously not this.sorted by name\n    if (!(this.wassorted & sortflag)) {\n      this.files.sort(sortfunction)\n      this.wassorted = sortflag;\n    } else {\n      //if previously reversed\n      if (this.wassorted & this.sorted.reverse) {\n        this.files.reverse(); //reverse again\n        this.wassorted = sortflag;\n      } else { //not reversed - reverse and set flag\n        this.files.reverse();\n        this.wassorted = this.wassorted | this.sorted.reverse;\n      }\n    }//sort(function(a,b){return a.name>b.name?-1:1;})\n    if (this.path.length > 0) {//non root path add the first '..'\n      this.addUpDir()\n    }\n    //this.wassorted = this.wassorted | sortflag;\n    //console.log(this.files);\n  }\n\n  addUpDir() {\n    this.files.unshift({name: \"..\", nicesize: \"UP-DIR\", date: \"\", available: true}); //up dir item\n  }\n\n  sortByName() {\n    this.sortByX(this.sorted.byname, function (a, b) {\n      return a.name > b.name ? 1 : -1;\n    })\n  }\n\n  sortBySize() {\n    this.sortByX(this.sorted.bysize, function (a, b) {\n      return a.size - b.size\n    })\n  }\n\n  sortByDate() {\n    this.sortByX(this.sorted.bydate, function (a, b) {\n      return a.date > b.date ? 1 : -1;\n    })\n  }\n\n  extension(filename) {\n    var re = /(?:\\.([^.]+))?$/;\n    return re.exec(filename)[1];\n  }\n\n  sortByExt() {\n    this.sortByX(this.sorted.byext, function (a, b) {\n      return a.ext > b.ext ? 1 : -1;\n    })\n  }\n\n  handleError(error) {\n    console.log(\"Filepanel error:\", error);\n    alert('Sorry. Backend service is not working temporarily. You may browse files from publicly accessible repositories only. If the problem persist, report it to system administrator.'+this.serviceurl+' HTTP status:'+error.statusCode+' '+error.statusText)\n  }\n  \n  //triggered after this object is placed to DOM\n  attached() {\n    //read the directory infos\n    this.pa.getFiles(this.path)\n      .then(data => {\n          this.populateFiles(data);\n        }) /* do not handle error if return message is empty, only log data, for debug purposes */\n      .catch(error => {\n        //this.handleError(error);\n      //handle 403 unauthorized\n      if (error.statusCode == 403) {\n        //try to login\n        this.ea.publish(new HandleLogin(this.panelid));\n      } else if (error.statusCode == 502 || error.statusCode == 503) {\n        this.handleError(error);\n      } else {\n        //try empty path\n        if (this.path && this.path.length > 0) {\n          this.path = \"\";\n          this.pa.getFiles(this.path)\n            .then(data => {\n                this.populateFiles(data);\n            }).catch(error => {\n            this.handleError(error);\n          });\n        }\n      }\n    });\n  }\n\n  //parse .NET encoded Date in JSON\n  dateTimeReviver(key, value) {\n    var a;\n    if (typeof value === 'string') {\n      a = /\\/Date\\(([\\d\\+]*)\\)\\//.exec(value);\n      if (a) {\n        return new Date(parseInt(a[1])).toLocaleDateString(navigator.language ? navigator.language : \"en-GB\");\n      }\n    }\n    return value;\n  }\n\n  //removes last subdirectory\n  cdup() {\n    this.lastpath = this.path;\n    let sepIndex = this.path.lastIndexOf('/');\n    this.path = this.path.substring(0, sepIndex);\n    if (this.path == \"\") this.resources = this.baseresources;\n  }\n\n  //adds subdirectory to the path\n  cddown(subdir) {\n    this.lastpath = this.path;\n    this.path += '/' + subdir;\n    this.resources = [];\n  }\n\n  cdroot() {\n    this.lastpath = this.path;\n    this.path = \"\";\n    this.resources = this.baseresources;\n    this.isFiles = true;\n    this.isUniprot = false;\n    this.isPdb = false;\n  }\n\n  //goes to the root\n  goroot() {\n    this.changefolder(\"/\");\n  }\n\n\n  //change folder, reads the folder content and updates the table structure\n  changefolder(folder) {\n    if (!this.lock) {\n      this.lock = true;\n      if (folder) {\n        if (folder == '..') this.cdup();\n        else if (folder == '/') this.cdroot();\n        else this.cddown(folder);\n      }\n      this.pa.getFiles(this.path)\n        .then(data => {\n            this.populateFiles(data);\n            this.lock = false;\n        }).catch(error => {\n        if (error.statusCode == 403) {\n          this.lock = false;\n          this.path = this.lastpath;\n          this.ea.publish(new HandleLogin(this.panelid));\n        } else {\n          console.log('Error');\n          console.log(error);\n          alert('Sorry, response: ' + error.statusCode + ':' + error.statusText + ' when trying to get: ' + this.serviceurl + this.path);\n          this.lock = false;\n          this.path = this.lastpath;\n        }\n      });\n    } //else doubleclick when the previous operation didn't finished\n  }\n\n  //refresh the file content\n  refresh() {\n    this.changefolder(); //changefolder with empty folder - just refresh\n  }\n\n  //parses response and fills file array with customization (DIRS instead of size number)\n  populateFiles(dataresponse) {\n    //console.log(\"filepanel.populateFiles()\")\n    Vfstorage.setValue(\"filepanel\" + this.panelid, this.path);\n    //it is assumed that first element is \".\" describing the content of current dir\n    if (dataresponse.length>0 && dataresponse[0].name === \".\") this.currentdir = dataresponse.shift(); \n    else this.currentdir = null;\n    //console.log(\"populateFiles currentdir:\",this.currentdir);\n    this.files = dataresponse;//JSON.parse(dataresponse);//,this.dateTimeReviver);//populate window list\n    this.filescount = this.files.length + this.resources.length;\n    let that = this;\n    this.files.forEach(function (item, index, arr) {\n      if (!arr[index].name && arr[index].alias) {\n        arr[index].name = arr[index].alias;\n        arr[index].attributes = 16;\n        arr[index].date = \"\";\n        arr[index].filetype = 8;\n      }\n      //console.log(arr[index]);\n      arr[index].ext = that.extension(arr[index].name); //may return undefined\n      arr[index].nicedate = that.dateTimeReviver(null, arr[index].date);\n      if (!arr[index].ext) arr[index].ext = \"\";\n      arr[index].available = !!(arr[index].filetype & 8); //available if the filetype attribute contains flag 8\n      if (arr[index].attributes & 16) arr[index].nicesize = \"DIR\";\n      else\n      //convert to 4GB or 30MB or 20kB or 100b\n        arr[index].nicesize = ~~(arr[index].size / 1000000000) > 0 ? ~~(arr[index].size / 1000000000) + \"GB\" : (~~(arr[index].size / 1000000) > 0 ? ~~(arr[index].size / 1000000) + \"MB\" : (~~(arr[index].size / 1000) > 0 ? ~~(arr[index].size / 1000) + \"kB\" : arr[index].size + \" b\"));\n    });\n    if (this.path.length > 0) {//non root path\n      this.addUpDir();\n    }\n\n  }\n\n  selectFile(file) {\n    //console.log(\"selectFile(\"+file+\") panelid:\"+this.panelid);\n    if (file.nicesize.endsWith && file.nicesize.endsWith('DIR')) this.changefolder(file.name);\n    else {\n\n      //HEAD the file - so it can be obtained - cached by metadata service, fix #45\n      //let fileurl = this.serviceurl + this.path + '/' + file.name\n      if (this.path) //path exists -standard file \n      this.pa.getFileHead(this.path + '/' + file.name)\n        .then(response => {\n            //console.log('file head'+fileurl);\n            //console.log(response);\n            this.ea.publish(new SelectedFile(file, this.panelid));\n          }\n        ).catch(error => {\n        console.log(\"Error when geting metadata information about file:\");\n        console.log(error);\n      });\n      else //path don't exist, probably resource\n        this.ea.publish(new SelectedFile(file, this.panelid));       \n      //console.log(\"SelectedFile\",file);\n      \n      //constructs public url\n      /*this.pa.getPublicWebDav()\n        .then(data => {\n            //let mypath2 = JSON.parse(data.response);\n            let mypath = data.signed_url;\n            mypath += this.path.startsWith('/') ? this.path.slice(1) : this.path;\n            file.publicwebdavuri = mypath + \"/\" + file.name;\n            this.ea.publish(new SelectedFile(file, this.panelid));\n        });\n        */\n    }\n  }\n\n  selectResource(resource) {\n    if (resource.id == \"\") {\n      this.goroot();\n      return;\n    }\n    if (resource.url) {\n      console.log(\"select resource\");\n      let file = resource;\n      //fix: blocked content from http - origin page at https\n      if (window.location.protocol == \"https:\" && file.url.startsWith(\"http:\")) file.url = file.url.replace(\"http:\", \"https:\");\n\n      file.webdavuri = file.url;\n      file.publicwebdavuri = file.url;\n      this.ea.publish(new SelectedFile(file, this.panelid));\n      return\n    }\n    this.isPdb = (resource.id == \"pdb\");\n    this.isUniprot = (resource.id == \"uniprot\");\n    this.isFiles = !(this.isPdb || this.isUniprot);\n    let that = this;\n    //console.log(that);\n    if (this.isPdb) this.resources = this.pdbresource.selectResource(resource, that);\n    if (this.isUniprot) this.resources = this.uniprotresource.selectResource(resource, that);\n    //this.files = [];\n    if (!this.isFiles) this.files = [];\n    this.filescount = this.files.length + this.resources.length;\n  }\n\n  checkResource(resource) {\n    //if (resource.id==\"\") {this.goroot(); return;}\n    if (resource.url) {\n      console.log(\"check resource\");\n      let file = resource;\n      //fix: blocked content from http - origin page at https\n      if (window.location.protocol == \"https:\" && file.url.startsWith(\"http:\")) file.url = file.url.replace(\"http:\", \"https:\");\n\n      file.webdavuri = file.url;\n      file.publicwebdavuri = file.url;\n      this.ea.publish(new CheckedFile(file, this.panelid));\n      return\n    }\n  }\n\n  appendResources(resources) {\n    //append resources to existing array\n    this.resources.push(...resources);\n    this.filescount = this.files.length + this.resources.length;\n  }\n\n//TODO introduce key based navigation - letter will highlight first file beginning on the letter pressed,\n// up, down left right keys will move cursor\n\n  keypressed(evt) {\n    let key = evt.keyCode;\n    console.log(\"keypressed:\" + key);\n    if (key === 13) {\n      /*may not be updated with input field as debounce has 750 ms this.submit({item:this.value});\n       */\n      //console.log(\"keypressed(): submitting()\")\n      //this.hideSuggestions();\n      if (evt.originalTarget) this.submit({item: {Name: evt.originalTarget.value}}) //in Firefox\n      else if (evt.target) this.submit({item: {Name: evt.target.value}}) //in IE\n      //this.hideSuggestions();\n    } else if (key === 27) this.escape();\n    return true;\n  }\n}\n\n\n\n\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class SelectedFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class CheckedFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class VisualizeFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class EditFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class DatasetFile {\n  constructor(file,senderid){\n    this.file = file;\n    this.senderid = senderid;\n  }\n}\n\nexport class PopulateResources {\n  constructor(resources,senderid){\n    this.resources = resources;\n    this.senderid=senderid;\n  }\n}\n","/**\n * Created by vagrant on 9/12/17.\n */\nimport {bindable} from 'aurelia-framework';\nimport {Pdbresource} from './pdbresource';\nexport class Pdbpanel {\n  @bindable panelid;\n  static inject = [Pdbresource];\n\n  constructor(pdbresource) {\n    this.resources=[];\n    this.currentpath=\"\";\n    this.id=\"pdb\";\n    this.impl=pdbresource;\n  }\n\n  attached(){\n    this.resources=this.impl.populateResource({name:this.currentpath,id:this.id});//select root\n  }\n\n  //distinguishes what to do\n  selectResource(resource){\n    if (resource.name==\"..\") {\n      if (this.currentpath.endsWith(\"*\")) this.resources=this.impl.populateResource({name:this.currentpath.slice(0,-2),id:this.id})\n      else this.resources=this.impl.populateResource({name:this.currentpath.slice(0,-1)+\"*\", id:this.id})\n    } else\n      this.resources=this.impl.populateResource(resource)\n  }\n\n\n}\n\n","/**\n * Created by Tomas Kulhanek on 9/13/17.\n */\n\n\nimport {HttpClient} from 'aurelia-fetch-client'; //fetch\n\nexport class Pdbresource {\n  //static inject = [HttpClient];\n\n  constructor() {\n    this.client=new HttpClient();\n    this.requesturlpdbid=\"//www.ebi.ac.uk/pdbe/search/pdb/select?rows=100&wt=json&sort=pdb_id+desc&q=pdb_id:\";\n    this.requesturlnums=\"//www.ebi.ac.uk/pdbe/search/pdb/select?rows=0&wt=json&sort=pdb_id+desc&q=pdb_id:\";\n    this.requesturlfiles=\"//www.ebi.ac.uk/pdbe/api/pdb/entry/files/\";\n    this.pdbredourl = \"//pdb-redo.eu/db/\";\n    this.pdbredosuffixes = [\"_final.pdb\",\"_final.mtz\",\"_besttls.pdb.gz\",\"_besttls.mtz.gz\",\"_scenes.tar.bz2\",\".zip\"]\n  }\n\n  static cdup(resource) {\n    //12* -> 1*\n    let myresource = {};\n    myresource.name= resource.link.endsWith(\"*\")? resource.link.slice(0,-2)+\"*\":resource.link.slice(0,-1)+\"*\";\n    myresource.id = resource.id;\n    myresource.link= myresource.name.slice(0,-2)+\"*\";\n    return myresource;\n  }\n\n  //distinguishes what to do\n  selectResource(resource,callback){\n    console.log(\"selectResource .. :\");\n    console.log(resource);\n\n    if (resource.name==\"..\") {\n      console.log(\"selectResource .. :\");\n      console.log(resource);\n      //go up one level\n      return this.populateResource(Pdbresource.cdup(resource),callback);\n      /*if (resource.link.endsWith(\"*\"))\n        return this.populateResource({name:resource.link,link:resource.link.slice(0,-2)+\"*\",id:resource.id})\n\n      else if (resource.link==\"PDB\" || resource.link==\"\")\n        return this.populateResource({name:resource.link,link:resource.link.slice(0,-1)+\"*\", id:resource.id})*/\n    } else\n      return this.populateResource(resource,callback)\n  }\n\n//populates level of virtual folders\n  populateResource(resource,callback) {\n    //console.log(\"populateResource():\");\n    //console.log(resource);\n    //console.log(this)\n    let resources = [];\n    let that = this;\n    \n    function fetchLog(url) {\n      return that.client.fetch(url, {headers:{}}) \n        .then(data => {return data});\n\n    }\n\n    //first level of pdb browsing generates 1* -9*\n    function push1_9() {\n      resources.push({name: \"..\", info: \"UP-DIR\", id: \"\"});\n      for (var i = 1; i < 10; i++) {\n        resources.push({name: i + \"*\", info: \"pdb entries begining with '\" + i + \"'\", id: resource.id});\n      }\n    }\n\n    //second and third level of browsing generates 10* -1z* and 5a0* -5az*\n    function push0_9a_z(prefix) {\n      {\n        resources.push({name: \"..\", info: \"UP-DIR\", id: resource.id,link:resource.name});\n\n        //let queryurl = that.requesturlpdbid+resource.name;\n\n        for (let i = 0; i <= 9; i++){\n\n          that.client.fetch(that.requesturlnums+ prefix + i + \"*\",{headers:{}})\n            .then(response => response.json())\n            .then(data => {\n              //console.log(data)\n              let resources2 = [];\n              if (data.response && data.response.numFound) {\n                resources2.push({name:data.responseHeader.params.q.slice(7),info:\"(\"+data.response.numFound+\")\",id:resource.id})\n              }\n              //do callback\n              callback.appendResources(resources2);\n            });\n        }\n          //resources.push({name: prefix + i + \"*\", info: \"\", id: resource.id})\n        for (let i = 'a'.charCodeAt(0); i <= 'z'.charCodeAt(0); i++) {\n\n          that.client.fetch(that.requesturlnums+ prefix + String.fromCharCode(i) + \"*\",{headers:{}})\n            .then(response => response.json())\n            .then(data => {\n              //console.log(data)\n              let resources2 = [];\n              if (data.response && data.response.numFound>0) {\n                resources2.push({name:data.responseHeader.params.q.slice(7),info:\"(\"+data.response.numFound+\")\",id:resource.id})\n              }\n              //do callback\n              callback.appendResources(resources2);\n            });\n        }\n      }\n    }\n\n    //generates last level e.g. 2hhd with\n    function check0_9a_z(prefix) {\n      {\n        console.log(\"check0_9a_z\");\n        resources.push({name: \"..\", info: \"UP-DIR\", id: resource.id,link:resource.name});\n        let queryurl = that.requesturlpdbid+resource.name;\n        that.client.fetch(queryurl,{headers:{}})\n          .then(response => response.json())\n          .then(data => {\n              //console.log(data)\n              let resources2 = [];\n              if (data.response && data.response.docs) {\n\n                  for (let item of data.response.docs) {\n                    item.id=resource.id;item.name= item.pdb_id; item.info = item.title;resources2.push(item);\n                  }\n              }\n              //do callback\n              callback.appendResources(resources2);\n            });\n      }\n    }\n\n    function getlisttodownload(pdbid){\n      console.log(\"getlisttodownload\");\n      resources.push({name: \"..\", info: \"UP-DIR\", id: resource.id,link:resource.name});\n      let queryurl = that.requesturlfiles+pdbid;\n      //get links to pdb files\n      that.client.fetch(queryurl,{headers:{}})\n        .then(response => response.json())\n        .then(data => {\n          console.log(data);\n          let resources2 = [];\n          Object.keys(data).forEach(key =>{ //traverse via pdb name e.g. \"2hhd\"\n            Object.keys(data[key]).forEach(key2 => { // traverse via \"PDB\",\"assembly\",\"validation\",\"SIFTS\",\"molecule\"\n              for (let item of data[key][key2].downloads) {\n                item.id = resource.id;\n                item.name = item.url.substr(item.url.lastIndexOf(\"/\")+1);\n                item.info = key2+\":\"+item.label;\n                resources2.push(item);\n              }\n            })\n          });\n          //loopNestedObj(data);\n          callback.appendResources(resources2);\n        });\n\n      //get link to pdb redo files\n      queryurl = that.pdbredourl+pdbid+\"/data.json\";\n\n      that.client.fetch(queryurl, {method:'head',headers:{}})\n        .then(response => {\n          console.log(response);\n          let resources2 = [];\n          for (let suffix of that.pdbredosuffixes) {\n                let item = {};\n                //all url except for (.zip) are /pdbid/pdbid.suffix\n                item.url=that.pdbredourl+pdbid+(suffix == \".zip\"? \"\": \"/\"+pdbid)+suffix;\n                item.id = resource.id;\n                item.name = item.url.substr(item.url.lastIndexOf(\"/\")+1);\n                item.info = \"PDB REDO files \"+suffix;\n                resources2.push(item);\n              }\n          callback.appendResources(resources2);\n        });\n\n      //TODO get links to BMRB files http://bmrb.cerm.unifi.it/search/simplesearch.php?dbname=PDB&pdbid=2hhd&show_bmrbid=on&output=html\n    }\n\n    if (resource.name == \"\" || resource.name == \"PDB\" || resource.name==\"*\") push1_9();\n\n    else if (resource.name.endsWith(\"*\")) {\n      if (resource.name.length<4) push0_9a_z(resource.name.slice(0, -1));\n      else check0_9a_z(resource.name.slice(0, -10))\n    } else getlisttodownload(resource.name);\n    //console.log(resources[1].name);\n    return resources;\n  }\n}\n","/**\n * Created by vagrant on 9/12/17.\n */\nimport {bindable} from 'aurelia-framework';\nexport class Uniprotpanel {\n  @bindable panelid;\n  constructor() {\n  }\n}\n\n","/**\n * Created by TomasKulhanek on 9/13/17.\n */\n\nexport class Uniprotresource {\n  constructor() {\n\n  }\n}\n","import {DialogService} from 'aurelia-dialog';\nimport {inject} from 'aurelia-framework';\nimport {Prompt} from '../filemanager2/fmsettings';\n\n@inject(DialogService)\n\nexport class Filemanager {\n\n  constructor(ds) {\n    this.dialogService=ds;\n  }\n  \n  setupFileManager(){\n    this.dialogService.open({viewModel: Prompt, model: 'File Manager Settings' }).then(response => {\n      //console.log(response);\n\n      if (!response.wasCancelled) {\n        //console.log('dialog OK');\n      } else {\n        //console.log('dialog cancelled');\n      }\n      //console.log(response.output);\n    });\n  }\n}\n","export class Filepicker {\n\n  constructor() {\n    this.popup;\n    this.target;\n    //receives message from popup window, define as arrow function due to eventlistener\n    this.receiveMessage = event =>\n    {\n      document.getElementById(this.target).innerHTML=event.data;\n      document.getElementById(this.target).setAttribute(\"href\",event.data);\n    }\n  }\n\n  attached(){\n    window.addEventListener(\"message\", this.receiveMessage, false);\n  }\n\n  detached() {\n    window.removeEventListener(\"message\", this.receiveMessage)\n  }\n\n  openfilepickerwindow(_target){\n    return this.openwindow(_target,\"filepickercomponent.html\")\n  }\n\n  openuploaddirpickerwindow(_target){\n    return this.openwindow(_target,\"uploaddirpickercomponent.html\")\n  }\n  //opens popup window in defined location\n  openwindow(_target,href) {\n    this.target=_target;\n    this.popup=window.open(href, 'newwindow', 'width=640, height=480');\n    return false;\n  }\n\n}\n","import {ProjectApi} from \"../components/projectapi\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\n//import {RedirectLogin,HandleLogin,MayLogout} from '../behavior';\n\nexport class Virtualfolderhome {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,projectapi){\n    this.ea = ea;\n    this.location = window.location.protocol;\n    this.islocalhost= this.location.startsWith('http:');\n    this.pa=projectapi;\n    this.webdavurl=\"\";\n    \n    this.popup;\n    this.target;\n    //receives message from popup window, define as arrow function due to eventlistener\n    this.receiveMessage = event =>\n    {\n      document.getElementById(this.target).innerHTML=event.data;\n      document.getElementById(this.target).setAttribute(\"href\",event.data);\n    }\n  }\n\n  attached(){\n    window.addEventListener(\"message\", this.receiveMessage, false);\n  }\n\n  detached() {\n    window.removeEventListener(\"message\", this.receiveMessage)\n  }\n\n\n  openuploaddirpickerwindow(_target){\n    return this.openwindow(_target,\"uploaddirpickercomponent.html\")\n  }\n  //opens popup window in defined location\n  openwindow(_target,href) {\n    this.target=_target;\n    this.popup=window.open(href, 'newwindow', 'width=640, height=480');\n    return false;\n  }\n  \n}\n","export class Virtualfoldersetting {\nconstructor(){\n  let location = window.location.protocol;\n  this.islocalhost= location.startsWith('http:');\n  console.log(\"Virtualfoldersetting() location\", location,\"islocalhost\",this.islocalhost);\n}\n}\n","/**\n * Created by Tomas Kulhanek on 5/19/17.\n */\nimport {bindable} from 'aurelia-framework';\nimport {HttpClient} from 'aurelia-fetch-client'; //fetch\n\n/** Checkurl component <checkurl url=\"some url\">content</checkurl>\n * checks the url provided in url attribute,\n * if the HEAD request returns HTTP 200, then the content inside the component is\n * added into the resulting DOM, otherwise no DOM is rendered and no further processing\n * performed -e.g. subsequent calls to the url etc.\n */\nexport class Checkurl {\n  static inject = [HttpClient];\n  @bindable failmessage=\"No data available for this structure.\";\n  @bindable url;\n  constructor(httpclient){\n    this.client = httpclient;\n    this.showit=false;\n    //this.message=\"\";\n  }\n\n  attached(){\n    //console.log(\"Checkurl component:\"+this.url+\" message:\"+this.failmessage);\n\n    this.client.fetch(this.url, {method: 'HEAD'})\n      .then(response => {\n        //console.log(\"checkurl response:\");\n        //console.log(response);\n        if (response.status===200) this.showit=true;\n        //this.message = this.failmessage;\n      })\n      .catch(error =>{\n        this.showit=false;\n        console.log('checkurl error:'+error);\n        //this.message = this.failmessage;\n      });\n  }\n\n}\n\n","/**\n * created by Tomas Kulhanek on 3/15/17.\n */\nimport {bindable} from 'aurelia-framework';\nimport {HttpClient} from 'aurelia-fetch-client'; //fetch\n\n/**\n * Dataitem is specifical integration of PDB, Uniprot or other type of item in a dataset\n * integrates pdb components of ebi.ac.uk\n */\nexport class Dataitem {\n\n  static inject = [HttpClient];\n  @bindable item = \"\";\n\n  constructor(httpclient) {\n    //console.log('dataitem()')\n    //console.log(this.item);\n    this.serviceurl = \"//www.ebi.ac.uk/pdbe/api/pdb/entry/molecules/\"\n    this.client = httpclient;\n\n    this.entityids = [1];\n    this.selectedid = this.entityids[0];\n    this.showitem = false;\n    let location = window.location.protocol;\n    //this.pdbred=\"cc\";\n//    this.httpsprotocol=location.startsWith('https'); //used to detect/hide buggy components\n  }\n\n  bind() {\n    //console.log(\"dataitem.bind()\");\n    //console.log(this.item);\n    this.itemPDBEntry = this.isPDBEntry();\n    //this.pdbredo = this.item[1]+this.item[2]; //2nd and 3rd character\n    //console.log(this.pdbredo);\n    //this.showitem = this.itemPDBEntry;\n    //this.showuniprotitem = !this.itemPDBEntry;\n    this.itemUniprotEntry = this.isUniprotEntry();\n    if (this.itemPDBEntry) {\n\n      this.client.fetch(this.serviceurl + this.item.Name)\n        .then(response => response.json())\n        .then(data => {\n\n          //console.log(\"ENTRY ID Fetch, data:\");\n          //console.log(data)\n          this.entityids=[];\n          for (var entryname in data) {  //data.2hhd data.4yg0 data.1cbs data.{ }   for (var ... in ...) { } //enumeration\n            for (let item of data[entryname]) { //data[{}] == data[2hhd] == data.2hhd, for (let ... of ...)  [ ]  //array\n              //only polypeptide molecules can be viewed by components\n              if (item.molecule_type.startsWith(\"polypeptide\"))\n                this.entityids.push(item.entity_id);\n            }\n          }\n          this.selectedid=this.entityids[0]; //first one\n\n        }).catch(error => {\n\n        console.log('Error dataitem().fetch() of \"'+this.serviceurl + this.item.Name+'\"');\n        console.log(error);\n      });\n    }\n\n  }\n\n  attached() {\n    //console.log(\"dataitem.attached()\");\n    //console.log(this.item);\n  }\n\n  selectedValueChanged() {\n    //create stem clones of element\n    if (!this.stemel1 && this.itemPDBEntry) {\n      this.stemel1 = this.el1.cloneNode(); //pure <pdb-topology\n      this.stemel2 = this.el2.cloneNode(); //pure <pdb-sequence\n    }\n\n    //replacing first element\n    let newel=this.stemel1.cloneNode();\n\n    //repleace old <pdb-topology with new pure <pdb-topology\n    let parent = this.el1.parentNode;\n    //remove the element - angular\n    parent.removeChild(this.el1);\n    //append the clean clone\n    newel.setAttribute(\"entity-id\",this.selectedid)\n    this.el1 = parent.appendChild(newel);\n    angular.bootstrap(newel, ['pdb.component.library']);\n\n    //replacing second element\n    newel=this.stemel2.cloneNode();\n\n    parent = this.el2.parentNode;\n    //remove the element - angular\n    parent.removeChild(this.el2);\n    //append the clean clone\n    newel.setAttribute(\"entity-id\",this.selectedid)\n\n    this.el2 =parent.appendChild(newel);\n    angular.bootstrap(newel, ['pdb.component.library']);\n  }\n\n  hideitem() {\n      this.showitem = !this.showitem;\n  }\n\n  isPDBEntry() {\n    //console.log(\"dataitem.ispdbentry()\")\n    //console.log(this.item.Type===\"pdb_id\");\n    //console.log(/^[0-9][A-Za-z0-9]{3}$/.test(this.item.Name));\n    return (this.item.Type===\"pdb_id\") || (/^[0-9][A-Za-z0-9]{3}$/.test(this.item.Name));\n  }\n\n  isUniprotEntry(entry) {\n    return (this.item.Type===\"uniprot_accession\") || (/^[A-Z][0-9][A-Z0-9]{4}[A-Z0-9]*$/.test(this.item.Name));\n  }\n\n}\n","/**\n * created by Tomas Kulhanek on 2/21/17.\n */\n\nimport 'whatwg-fetch';\n//import {HttpClient} from \"aurelia-http-client\";\nimport {ProjectApi} from \"../components/projectapi\";\nimport {bindable} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {DatasetFile} from '../filepicker/messages';\nimport {Vfstorage} from '../utils/vfstorage';\n\n//Model view controller\n//Model view viewmodel\n/** Dataset handles ViewModel of dataset view, performs AJAX call to dataset service,\n * holds dataset structure and includes dataitems\n *\n */\nexport class Dataset {\n  static inject = [ProjectApi,EventAggregator];\n  @bindable panelid;\n\n  constructor (pa,ea) {\n    this.pa = pa;\n    \n    this.ea = ea;\n    this.ea.subscribe(DatasetFile, msg => this.addDatasetFile(msg.file,msg.senderid));\n\n    this.showitem=true;\n    this.baseurl =\n//    this.dataseturl=Vfstorage.getBaseUrl()+\"/metadataservice/dataset\";\n    this.showlist=true;\n    this.pdbdataset = []; //structure could be {name:\"2hhd\", type:\"pdb|uniprot|file|dir\",url:\"https://pdbe.org/2hhd.pdb\",notes:\"\"}\n    this.pdbdataitem = \"\";\n    this.pdblinkset = [];\n    this.pdbdataitem = \"\";\n    this.submitdisabled2 = true;\n    this.id=0;\n  }\n\n  createnewdataset(){\n    this.pdbdataset = [];\n    this.pdbdataitem = \"\";\n    this.pdblinkset = [];\n    this.pdbdataitem = \"\";\n    this.submitdisabled2 = true;\n    let date = new Date();\n    this.name=\"dataset-\"+date.getFullYear()+\".\"+(date.getMonth()+1)+\".\"+date.getDate();\n    this.id = 0;\n    this.showlist=false;\n  }\n\n\n  //@computedFrom('submitdisabled2')\n  //TODO check,test to trigger only when pdbdataset is changed\n  get canSubmit() {\n    //console.log(\"disabled? \"+this.pdbdataset.length);\n    if (this.pdbdataset.length>0)\n      return true;\n    else\n      return false;\n  }\n\n  attached(){\n    this.pa.getDataset().then(data=>\n    {\n      this.datasetlist = data;\n    })\n  }\n\n  unselectdataset(item){\n    this.showlist=true;\n  }\n\n  selectdataset(item){\n    //console.log(\"selectdataset()\");\n    //console.log(item)\n    this.pa.getDataset(item.Id).then(data=>\n    {\n      this.submitdataset=data;\n      this.pdbdataset = this.submitdataset.Entries;\n      this.name = this.submitdataset.Name;\n      this.id = this.submitdataset.Id;\n      this.showlist = false;\n    })\n  }\n\n  removedataset(item){\n    alert(\"Remove dataset not yet implemented.\");\n    //console.log(item)\n  }\n\n  additem(item){\n    //console.log(\"additem()\");\n    //console.log(item);\n    this.pdbdataset.unshift(item);\n    //console.log(this.pdbdataset);\n    //this.canSubmit = this.pdbdataset.length>0?true:false;\n  }\n\n  addDatasetFile(file,senderid) {\n    if (senderid!== this.panelid) {\n      //console.log(\"dataset.adddatasetfile()\");\n      //console.log(file);\n      if (window.confirm(\"The file \" + file.name + \" will be added to dataset.\")) {\n        let item = {Name: file.name, Url: file.publicwebdavuri, Type: \"file\"}\n        this.pdbdataset.unshift(item);\n      }\n    }\n  }\n\n  removeitem(itemtodelete){\n    this.pdbdataset = this.pdbdataset.filter(item => item!== itemtodelete);\n  }\n\n\n  //model-view -viewmodel\n  hideitem() {\n    this.showitem = ! this.showitem;\n  }\n\n\n  submit(){\n    //console.log(\"submitting data:\");\n    this.submitdataset = {};\n    this.submitdataset.Id = this.id;\n    this.submitdataset.Name = this.name;\n    this.submitdataset.Entries = this.pdbdataset;\n    //this.submitdataset.Urls =\n    //console.log(this.submitdataset);\n    //console.log(JSON.stringify(this.submitdataset));\n    //PUT = UPDATE, POST = create new\n    \n      this.pa.addDataset(\"/\"+this.id,this.submitdataset)\n        .then(data =>{\n          this.showlist=true;\n          if (this.id === 0) this.datasetlist.push({Id:data.Id, Name:data.Name});\n          this.showlist=true;\n        })\n        .catch(error =>{\n          alert('Sorry. Dataset not submitted  at '+this.serviceurl+' error:'+error.response+\" status:\"+error.statusText)\n        });\n  }\n}\n","/**\n * Created by Nurul on 3/10/17.\n */\n\nexport class EntryIdCustomAttribute {\n  static inject = [Element]\n\n  constructor (element) {\n    this.element = element;\n  }\n\n  /* set's DOM atribute to the binded value.\n   valueChanged() is triggered by Aurelia,\n   when the value is bind - before attached()\n   this.value\n   */\n  valueChanged(newValue,oldValue){\n    this.element.setAttribute('entry-id',this.value);\n  }\n\n  /* bootstrap the pdb component library just from the element */\n  attached(){\n    angular.bootstrap(this.element, ['pdb.component.library']);\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 3/16/17.\n */\nimport {bindable} from 'aurelia-framework';\n\n/** Hideable component <hideable>content</hideable> renders additional title bar, when clicked\n * it is hidden/shown by aurelia show.bind feature\n */\nexport class Hideable {\n  @bindable title;\n  @bindable defaulthide=false;\n  constructor(){\n    this.showit=true;\n  }\n\n  bind(){\n    if (this.defaulthide) {\n      this.showit=false;\n    }\n  }\n\n  changeshowit(){\n    this.showit=!this.showit;\n  }\n}\n","/**\n * * Created by Tomas Kulhanek on 2/27/17.\n */\n\n/** adds functionality into pdb-id attribute, if used, then\n * it is integrated with ebi.ac.uk PDB components - which use\n * this attribute torender specific content\n *\n */\nexport class PdbIdCustomAttribute {\n  static inject = [Element]\n\n  constructor (element) {\n    this.element = element;\n  }\n\n  /* set's DOM atribute to the binded value.\n   valueChanged() is triggered by Aurelia,\n   when the value is bind - before attached()\n   this.value\n   */\n  valueChanged(newValue,oldValue){\n   //console.log('valueChanged() element:'+this.element.tagName+\" newvalue:\"+newValue+' this.value:'+this.value+' current.attribute.pdb-id:'+ this.element.getAttribute('pdb-id'));\n    // <pdb-redo pdb-id=\"item\"></pdb-redo> -> valueChange()\n   this.element.setAttribute('pdb-id',this.value);\n   //  <pdb-redo pdb-id=\"2sc3\">\n\n   //console.log(this.element.getAttribute('pdb-id'));\n  }\n\n\n\n  /* bootstrap the pdb component library just from the element */\n  attached(){\n    //console.log('attached element with custom attribute pdb-id:')\n    //console.log(this.element.getAttribute('pdb-id'));\n    angular.bootstrap(this.element, ['pdb.component.library']);\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 2/27/17.\n */\n\n/**\n * Custom atrribute pdb-ids contains comma separated set of pdb-id in string,\n * it is used to integrate with ebi.ac.uk PDB components using pdb-ids\n */\nexport class PdbIdsCustomAttribute {\n  static inject = [Element]\n\n  constructor (element) {\n    //console.log('pdbids()');\n    this.element = element;\n    this.bootstrapped=false;\n  }\n\n  /* set's DOM atribute to the binded value.\n     valueChanged() is triggered by Aurelia,\n     when the value is bind - before attached()\n  */\n  valueChanged(newValue,oldValue) {\n    //console.log('pdbids.valueChanged() element:'+this.element.tagName+\" newvalue:\"+newValue+' this.value:'+this.value+' current.attribute.pdb-ids:'+ this.element.getAttribute('pdb-ids'));\n    //console.log(this.value); // pdb-ids separated by coma -\n    // \"2hhd,1r6a,4yg0\"\n    if (this.value.length>0) {\n\n      this.pdbids = this.value.split(',');\n      // [ 2hhd, 1r6a, 4yg0 ] -> array()\n      //filter pdbids, uniprot and other entries are not included\n      this.pdbidsfilter = this.pdbids.filter(function (obj) {\n        return /^[0-9][A-Za-z0-9]{3}$/.test(obj);\n      });\n\n      this.pdbidsjson = JSON.stringify(this.pdbidsfilter);\n      // \"[ \"2hhd\", \"1r6a\", \"4yg0\" ]\"\n      if (this.pdbids.length > 0) {        //bootstrap only if something is in an array\n        if (this.bootstrapped) { //replace the angularized element with clean clone\n          //create clone from stem clone\n          var myclone = this.elementclone.cloneNode();\n          //console.log('angular element');\n          //console.log(this.element);\n          this.parent = this.element.parentNode;\n          //remove the element - angular\n          this.parent.removeChild(this.element);\n          //append the clean clone\n          this.parent.appendChild(myclone);\n          this.element = this.parent.children[0];\n        } else {\n          this.elementclone = this.element.cloneNode(); //stem clone\n\n        }\n        this.element.setAttribute('pdb-ids', this.pdbidsjson);\n        angular.bootstrap(this.element, ['pdb.component.library']);\n        this.bootstrapped = true;\n      }\n    }\n  }\n\n}\n\n","/**\n * created by Tomas Kulhanek on 2/27/17.\n */\n\nexport class Sasclient {\n\n  constructor(httpclient){\n    this.client = httpclient;\n    this.config = {\n      resultBoxAlign: 'left',\n      redirectOnClick: false,\n      searchUrl: '//www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select',\n      fields: 'value,num_pdb_entries,var_name',\n      group: 'group=true&group.field=category',\n      groupLimit: '25',\n      sort: 'category+asc,num_pdb_entries+desc',\n      searchParams: 'rows=20000&json.nl=map&wt=json'\n    }\n  }\n\n  search(term){\n    //http://www.ebi.ac.uk/pdbe/search/pdb/select?fl=pdb_id,organism_synonyms,number_of_bound_entities,+number_of_protein_chains,experimental_method,+experiment_data_available,expression_host_sci_name,+citation_year,+entry_organism_scientific_name,number_of_RNA_chains,number_of_DNA_chains,sample_preparation_method,emdb_id&group=true&group.field=pdb_id&group.limit=100&rows=1000&wt=json&q=pdb_id:(1cbs)\n    //http://www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select?rows=20000&json.nl=map&wt=json&group=true&group.field=category&fl=value,num_pdb_entries,var_name&sort=category+asc,num_pdb_entries+desc&group.limit=25&q=value:2hh*~10\n    //http://www.ebi.ac.uk/pdbe/search/pdb-autocomplete/select?rows=20000&json.nl=map&wt=json&fl=value,num_pdb_entries,var_name&group=true&group.field=category&sort=category+asc,num_pdb_entries+desc&group.limit=25&q=value:2hh*~10\n    let url = this.config.searchUrl+\"?\"+this.config.searchParams+\"&fl=\"+this.config.fields+ \"&\"+this.config.group+\"&sort=\"+this.config.sort+\"&group.limit=\"+this.config.groupLimit+\"&q=value:\"+term+\"*~10\";\n\n    this.client.get(url)\n      .then(data => {\n        if (data.response) {\n\n          return data.response.grouped.category.groups\n        }\n      }).catch(error => {\n\n      console.log('Error');\n      console.log(error);\n    });\n  }\n\n  searchMore(term) {\n\n  }\n\n}\n","\n/**\n * Created by Tomas Kulhanek on 11/29/16.\n */\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {VisualizeFile} from '../filepicker/messages';\nimport {bindable} from 'aurelia-framework';\n\n/**\n * integrates pdb-lite-mol component into panel\n */\nexport class  Viewpanel {\n    static inject = [Element,EventAggregator];\n    @bindable pid;\n\n    constructor(el,ea) {\n        this.element = el;\n        this.ea = ea;\n      this.ea.subscribe(VisualizeFile, msg => this.viewfile(msg.file,msg.senderid));\n        //this.uid = new Date().valueOf().toString();\n        this.sourceurl=\"\";\n        this.sourceformat=\"pdb\";\n      this.pdbentry = \"\";\n      this.pdbredoentry=\"\";\n      this.pdburl= \"\";\n    }\n\n    attached() {\n      //bootstrap only if angular is defined - prevent error in offline mode\n      if (typeof(angular) != 'undefined') angular.bootstrap(this.element.querySelector('#pdbviewer'), ['pdb.component.library']);\n    }\n\n    viewfile(file,senderid) {\n      //view files from second panel\n        if (senderid!=this.pid) {\n          //console.log(\"viewfile \" + file.webdavuri);\n          this.pdburl=file.webdavuri;\n          let sourceformat='pdb'\n          if (this.pdburl.endsWith('cif')) sourceformat=\"mmcif\";\n          let pdblitemol = '<pdb-lite-mol load-ed-maps=\"true\" source-url=\"' + this.pdburl + '\" pdb-id=\"\\'\\'\" source-format='+sourceformat+'></pdb-lite-mol>';\n          this.replacepdblitemol(pdblitemol);\n        }\n    }\n\n  loadfromredo() {\n    //http://pdb-redo.eu/db/1r6a/1r6a_final.pdb;jsessionid=C2F739E5913AEA9460EDA0B9F024C471\n    this.pdburl = \"//pdb-redo.eu/db/\"+this.pdbredoentry+\"/\"+this.pdbredoentry+\"_final.pdb\";//'http://www.cmbi.ru.nl/pdb_redo/'+this.pdbredoentry.substring(1,3)+'/'+this.pdbredoentry+'/'+this.pdbredoentry+'_final.pdb';\n    var pdblitemol = '<pdb-lite-mol load-ed-maps=\"true\" source-url=\"' + this.pdburl + '\" pdb-id=\"\\'\\'\" source-format=\"pdb\"></pdb-lite-mol>';\n    this.replacepdblitemol(pdblitemol);\n  }\n\n\n  loadpdb() {\n    //console.log(\"loadpdb \"+this.pdbentry);\n    this.pdburl=this.pdbentry;\n    var pdblitemol = '<pdb-lite-mol load-ed-maps=\"true\" pdb-id=\"\\''+this.pdbentry+'\\'\"></pdb-lite-mol>'\n    this.replacepdblitemol(pdblitemol);\n  }\n\n  replacepdblitemol(pdblitemol) {\n      //remove pdblitemol\n      var pdbviewer = this.element.querySelector('#pdbviewer');\n      var parentnode = this.element.querySelector('#pdbwrapper');\n      parentnode.removeChild(pdbviewer);\n      //create pdblitemol\n      parentnode.insertAdjacentHTML('afterbegin', '<div style=\"position:relative;height:400px;width:800px;\" id=\"pdbviewer\">'+pdblitemol+'</div>');\n\n      //call angular bootstrap\n      angular.bootstrap(this.element.querySelector('#pdbviewer'), ['pdb.component.library']);\n    }\n\n}\n","import {bindable} from 'aurelia-framework';\n/** Icopy - <icopy href=\"link-reference\"></icopy>\n * element to create a link icon which on click will copy the url into the clipboard\n * using the browser capability document.execCommand(\"copy\")\n */\n\nexport class Icopy {\n  @bindable href;\n\n  attached() {\n    //set value of referenced input\n    // href is relative - thus adding protocol and hostname, port\n    let port = (window.location.port == \"\" || window.location.port==\"80\" || window.location.port == \"443\")? \"\" :\":\"+window.location.port;\n    this.hrefid.value = window.location.protocol+ '//'+window.location.hostname+port+this.href;\n  }\n\n  copyclipboard() {\n    let inputElement = this.hrefid;\n    inputElement.select();\n    document.execCommand(\"copy\");\n    console.log(inputElement.value);\n    alert(\"Copied the url to clipboard: \" + inputElement.value);\n  }\n}\n","export function configure(config) {\n  //config.globalResources([]);\n  config.globalResources([\n    './irep.html',\n    './irepdemo.html',\n    './iadmin.html',\n    './istaff.html',\n    './ifile.html',\n    './ilink.html',\n    './icopy',\n    './ifolder.html',\n    './idata.html',\n    './iproject.html',\n    './itable.html',\n    './ispincog.html',\n    './idelete.html',\n    './inext.html',\n    './icopyicon.html',\n    './icogs.html'\n  ]);\n\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {HandleLogin, MayLogout,RedirectLogin} from '../behavior';\n//import {HttpClient} from 'aurelia-http-client';\nimport {ProjectApi} from \"../components/projectapi\";\nimport {Vfstorage} from \"../utils/vfstorage\";\n\nexport class App {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,pa) {\n    this.ea=ea;\n    //this.client=httpclient;\n    this.pa = pa;\n    this.providers=[{alias:\"Loading available providers ...\",temporary:true}];\n    this.loading =true;\n    this.loadederror = false;\n    this.handler = new RedirectLogin();\n    //if it detects that it is not logged in - e.g. 403 returned - shows Login button instead\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n    this.ea.subscribe(MayLogout, msg => this.handler.maylogout());\n    \n  }\n  \n  attached() {\n    this.params=Vfstorage.getParams(window.location.search.substring(1));\n    this.publickey = this.params.PublicKey;\n    //gets the status of the b2drop connection\n    this.pa.getFiles()\n      .then(data => {\n        this.loading =false;\n        this.loadederror = false;\n        this.ea.publish(new MayLogout(this.panelid));\n        this.providers = data.map(x => {x.selected=false; return x; });\n      })\n      .catch(error =>{\n        console.log(\"aliastable.attached() error:\");\n        console.log(error);\n        //handle 403 unauthorized\n        this.loading =false;\n        this.loadederror = true;\n        if (error.statusCode === 403) {\n          this.ea.publish(new HandleLogin(this.panelid));\n        } else\n          alert('Sorry. Backend service is not working temporarily. Wait a moment. If the problem persist, report it to system administrator. '+this.serviceurl+' HTTP status:'+error.statusCode+' '+error.statusText)\n      });\n  }\n\n  include(provider) {\n    provider.selected = true;\n    //console.log(\"syncsetting. include()\",provider);\n  }\n  \n  notinclude(provider) {\n    provider.selected = false;\n    //console.log(\"syncsetting. notinclude()\",provider);\n  }\n\n  import() {\n    let selectedaliases = this.providers.filter( prov => prov.selected).map(prov => prov.alias).join(';');\n    //console.log('syncsetting, import:',selectedaliases);\n    if (selectedaliases.length===0) return; //nothing is selected return\n    this.pa.getExportedSettings(this.publickey, selectedaliases)\n      .then(response =>{\n        //console.log(\"SyncSetting.app import settings encrypteddata:\",response);\n        let message = {EncryptedSettings:response,aliases:selectedaliases};\n        window.opener.postMessage(JSON.stringify(message), \"*\");\n        window.close();\n      })\n      .catch(error => alert(\"Sorry, error occured \"+error));\n  }\n\n}\n","export default {\n  debug: true,\n  testing: false\n};\n","import environment from './environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class SelectedTab {\n  constructor(tabid){\n    this.tabid = tabid;\n  }\n}\n","export class Simpletab {\n\n}\n","import { inject, bindable, DOM, computedFrom } from 'aurelia-framework';\n\n@inject(DOM.Element)\nexport class SimpleTabs {\n\n  constructor(_DOMElement) {\n    this.element = _DOMElement;\n    this.tabsEl = [];\n    this.activeTabIdx = 0;\n  }\n\n  @computedFrom('tabsEl')\n  get tabsHeaders() {\n    return this.tabsEl.map(t => {\n      return {\n        name: t.getAttribute('name') || 'tab',\n        css: { width: `${this.tabWidth}%` }\n      }\n    });\n  }\n\n  @computedFrom('tabsEl', 'activeTabIdx')\n  get slideCss() {\n    let width = `${this.tabWidth}%`;\n    return {\n      width,\n      left: `calc(${this.activeTabIdx} * ${width})`\n    }\n  }\n\n  get tabWidth() {\n    return (100 / ((this.tabsEl||{}).length || 0));\n  }\n\n  attached() {\n    if(!this.element) return;\n    this.tabsEl = [].slice.call(this.element.querySelectorAll('simple-tab'))\n    this.changeTab(0);\n  }\n\n  changeTab(index) {\n    this.activeTabIdx = index;\n    this.tabsEl.forEach((t, i) => t.setAttribute('data-active', i === index))\n  }\n\n}\n","import {bindable, inject} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedTab} from './messages';\nimport {VisualizeFile,EditFile} from '../filepicker/messages';\n//import $ from 'jquery';\n//import {tabs} from 'jquery-ui';\n\n/**\n * <tabs></tabs>\n * adds tabs functionality into application filepanel\n */\nexport class Tabs {\n    @bindable tabs;\n    static inject = [Element,EventAggregator];\n\n\n    constructor(el,ea) {\n        this.id = el.id;\n        this.element= el;\n        this.ea=ea;\n        this.ea.subscribe(VisualizeFile, msg => this.selectVisualize(msg.file,msg.senderid));\n        this.ea.subscribe(EditFile, msg => this.selectEdit(msg.file,msg.senderid));\n    }\n\n    bind() {\n      console.log(\"tabs.atached() tabs: \"+this.tabs);\n      this.activeid=this.tabs[0];\n      this.activeid.active = true;\n      //this.tabs[]\n    }\n\n    selectVisualize(file,senderid){\n      //just switch the tab\n      console.log(\"selectVisualize senderid:\"+senderid+ \" this.id:\"+this.id)\n      if (!this.activeid.id.startsWith(senderid)) { //TODO presumes active.id = \"left.list\" \"left.view\" .. has suffix with senderid\n        this.activeid.active = false;\n\n        this.activeid=this.tabs[2];\n        //new active tab is active\n        this.activeid.active=true;\n      }\n    }\n\n    selectEdit(file,senderid) {\n      console.log(\"selectEdit senderid:\"+senderid+ \" this.id:\"+this.id)\n      console.log(this.tabs);\n      console.log(this.activeid);\n      if (!this.activeid.id.startsWith(senderid)) { //TODO presumes active.id = \"left.list\" \"left.view\" .. has suffix with senderid\n        this.activeid.active = false;\n\n        this.activeid=this.tabs[1];\n        //new active tab is active\n        this.activeid.active=true;\n      }\n\n    }\n\n    opentab(tabid){\n      //old active tab is not active anymore\n      this.activeid.active = false;\n\n      this.activeid=tabid;\n      //new active tab is active\n      this.activeid.active=true;\n        //console.log(\"Tabs selected:\"+this.activeid);\n        this.ea.publish(new SelectedTab(this.activeid.id));\n    }\n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from '../filepicker/messages';\nimport {HandleLogin} from '../behavior';\nimport {RedirectLogin} from '../behavior';\n\n\nexport class App {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.ea = ea;\n    this.ea.subscribe(SelectedFile, msg => this.selectFile(msg.file));\n    this.handler = new RedirectLogin();\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n\n  }\n\n  selectFile(file){\n    window.opener.postMessage(window.location.protocol+\"//\"+window.location.host+file.publicwebdavuri, \"*\");\n    window.close();\n  }\n\n}\n","import environment from '../environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * created by Tomas Kulhanek on 4/11/17.\n */\n\n//import {HttpClient} from 'aurelia-http-client';\nimport {ProjectApi} from \"../components/projectapi\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SelectedFile} from '../filepicker/messages';\nimport {bindable} from 'aurelia-framework';\nimport {Filepanel} from '../filepicker/filepanel';\n\nexport class Uploaddirpanel extends Filepanel {\n  static inject = [EventAggregator, ProjectApi];\n  @bindable panelid;\n\n  constructor(ea, pa) {\n    super(ea,pa)\n  }\n\n  selectFile(file){\n    //console.log(\"filepanel tableid:\"+this.panelid);\n    if (!file.size || (file.size.endsWith && file.size.endsWith('DIR'))) this.changefolder(file.name);\n  }\n\n\n  selectThisDir() {\n    //console.log(\"selected:\"+this.currentdir);\n    //publish only if the currentdir is set (metadata exists)\n    if (this.currentdir)\n      this.ea.publish(new SelectedFile(this.currentdir, this.panelid));\n    /*let myfile= {};\n    myfile.name = this.path;\n    this.pa.getPublicWebDav()\n      .then(data => {\n          let mypath = data.signed_url;\n          mypath+= this.path.startsWith('/')?this.path.slice(1):this.path;\n          let mydir = {};\n          mydir.webdavuri = mypath;\n          this.ea.publish(new SelectedFile(mydir, this.panelid));\n      });*/\n    \n  }\n}\n","/**\n * Created by vagrant on 6/30/17.\n */\n\nexport class Vfstorage{\n\n  constructor() {}\n\n  /**check existence of localstorage property, if undefined set to the value\n   *\n   * @param propertyName\n   * @param defaultvalue\n   * @returns {string}\n   */\n  static checkDefault(propertyName,defaultvalue){\n    return (typeof(Storage) !== \"undefined\")?\n      (localStorage.getItem(propertyName)!==\"undefined\")? this.getValue(propertyName): this.setValue(propertyName,defaultvalue)\n      :defaultvalue;\n  }\n\n  /**gets value, if storage is not supported by browser then default value string \"true\"\n   *\n   * @param propertyName\n   * @param defaultvalue\n   * @returns {string}\n   */\n  static getValue(propertyName,defaultvalue=\"true\"){\n    return (typeof(Storage) !== \"undefined\") ? (localStorage.getItem(propertyName)?localStorage.getItem(propertyName):defaultvalue): defaultvalue;  }\n\n  /** sets value to the property into localStorage,\n   * if not supported by browser, does nothing\n   *\n   * @param propertyName\n   * @param value\n   * @returns {*}\n   */\n  static setValue(propertyName,value){\n    return (typeof(Storage) !== \"undefined\") ? localStorage.setItem(propertyName,value):value;\n  }\n\n  /**returns base url set in global variable virtualfolderbaseurl e.g. 'https://portal.west-life.eu'\n   *\n   * @returns {string}\n   */\n\n  static getBaseUrl(){\n    //console.log(\"vfstorage.getbaseurl\");\n    //console.log((\"virtualfolderbaseurl\" in window));\n    return (\"virtualfolderbaseurl\" in window) ? virtualfolderbaseurl : window.location.protocol+\"//\"+window.location.host;\n  }\n\n  static parseQueryString(str) {\n    var ret = Object.create(null);\n\n    if (typeof str !== 'string') {\n      return ret;\n    }\n\n    str = str.trim().replace(/^(\\?|#|&)/, '');\n\n    if (!str) {\n      return ret;\n    }\n\n    str.split('&').forEach(function (param) {\n      var parts = param.replace(/\\+/g, ' ').split('=');\n      // Firefox (pre 40) decodes `%3D` to `=`\n      // https://github.com/sindresorhus/query-string/pull/37\n      var key = parts.shift();\n      var val = parts.length > 0 ? parts.join('=') : undefined;\n\n      key = decodeURIComponent(key);\n\n      // missing `=` should be `null`:\n      // http://w3.org/TR/2012/WD-url-20120524/#collect-url-parameters\n      val = val === undefined ? null : decodeURIComponent(val);\n\n      if (ret[key] === undefined) {\n        ret[key] = val;\n      } else if (Array.isArray(ret[key])) {\n        ret[key].push(val);\n      } else {\n        ret[key] = [ret[key], val];\n      }\n    });\n\n    return ret;\n  }\n\n  static getParams = query => {\n    if (!query) {\n      return {};\n    }\n\n    return (/^[?#]/.test(query) ? query.slice(1) : query)\n      .split('&')\n      .reduce((params, param) => {\n        let [key, value] = param.split('=');\n        params[key] = value ? decodeURIComponent(value.replace(/\\+/g, ' ')) : '';\n        return params;\n      }, {});\n  };\n}\n","\nexport class App {\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\nimport {Modulecontrol} from \"./modulecontrol\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Ccp4control extends Modulecontrol{\n//  @bindable classin = \"w3-sand\";\n  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor(){\n    super();\n    this.posturl=\"/metadataservice/sbservice/ccp4suite\";\n    this.url=\"/metadataservice/sbservice/ccp4suite\";\n  }\n\n\n}\n","import environment from '../environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\n\n//import {HttpClient} from 'aurelia-http-client';\nimport {ProjectApi} from \"../components/projectapi\";\nimport {Vfstorage} from '../utils/vfstorage';\n//import {bindable} from 'aurelia-framework';\n\n\nexport class Modulecontrol{\n//  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor () {\n    this.client=new HttpClient();\n    this.url=window.location.href;\n    this.baseurl=Vfstorage.getBaseUrl()\n    this.enabled=false;\n    this.client.configure(config=> {\n      config.withHeader('Accept', 'application/json');\n      config.withHeader('Content-Type', 'application/json');\n    });\n\n  }\n\n  attached(){\n    //console.log(\"attached() url:\"+this.url);\n    this.client.get(this.baseurl+this.url)\n      .then(response => this.okcallback(response))\n      .catch(error => this.failcallback(error))\n  }\n\n  okcallback(response){\n    //console.log(\"okcallback()\");\n    var res= JSON.parse(response.response);\n    //console.log(res.enabled);\n    this.enabled= res.enabled;\n  }\n\n  failcallback(error){\n    this.enabled=false;\n    console.log('Sorry, error when connecting backend web service at '+this.url+' error:'+error.response+\" status:\"+error.statusText);\n  }\n\n  enable(){\n    this.client.post(this.baseurl+this.url)\n      .then(response => this.okcallback(response))\n      .catch(error => this.failcallback(error))\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\n\nexport class Modulesetting {\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\nimport {Modulecontrol} from \"./modulecontrol\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Scipioncontrol extends Modulecontrol{\n  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor(){\n   super();\n   this.url=\"/virtualfolder/api/sbservice/scipion\";\n   this.posturl=\"/virtualfolder/api/sbservice/scipion\";\n }\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/16/17.\n */\nimport {Modulecontrol} from \"./modulecontrol\";\nimport {bindable} from 'aurelia-framework';\n\nexport class Virtuosocontrol extends Modulecontrol {\n//  @bindable classin = \"w3-sand\";\n  @bindable classin = \"w3-card-4 w3-sand w3-padding w3-margin w3-round\";\n  constructor(){\n    super();\n    this.url=\"/virtualfolder/api/sbservice/virtuoso\";\n  }\n\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/6/17.\n */\n//import {HttpClient} from 'aurelia-http-client';\nimport{ProjectApi} from \"../components/projectapi\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSubmitted} from './messages';\nimport {Vfstorage} from '../utils/vfstorage';\nimport {HandleLogin,MayLogout} from '../behavior';\nimport {Dataitem} from \"../pdbcomponents/dataitem\";\n\n//let client = new HttpClient();\n\n/**\n * Aliastable component gets the currently registered aliases for file providers\n * and shows them in a table, allows delete the alias or initiate dialog to create one.\n */\nexport class Aliastable {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,pa){\n    this.ea=ea;\n    //this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/files\";\n    this.ea.subscribe(SettingsSubmitted, msg => this.submitSettings(msg.settings) );\n    //this.client=httpclient;\n    this.pa=pa;\n    this.providers=[{alias:\"Loading available providers ...\",temporary:true}];\n  }\n\n  attached() {\n    \n    this.pa.getFiles()\n      .then(data => {\n        this.ea.publish(new MayLogout(this.panelid));\n        this.providers = data;\n        \n      })\n      .catch(error =>{\n        if (error.statusCode === 403) {\n            this.ea.publish(new HandleLogin(this.panelid));\n          } else\n        alert('Sorry. Backend service is not working temporarily. Wait a moment. If the problem persist, report it to system administrator. HTTP status:'+error.statusCode+' '+error.statusText)\n      });\n  }\n\n  submitSettings(settings) {\n     this.providers = settings;\n  }\n\n  removeProvider(settings){\n    //console.log(\"removeProvider() \"+alias);\n    if (!confirm('Do you really want to delete the provider with alias \"'+settings.alias+'\" ?'))\n      return;\n    this.pa.deleteProvider(settings.alias)\n      .then(data =>{\n          this.providers = (data);\n      })\n      .catch(error =>{\n        alert('Sorry. Settings not deleted. error:'+error.response+\" status:\"+error.statusText)\n      });\n  }\n  \n  \n}\n","import {EventAggregator} from 'aurelia-event-aggregator';\n\nimport {HandleLogin,MayLogout,RedirectLogin} from '../behavior';\n\n\nexport class App {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.ea = ea;\n    let location = window.location.protocol;\n    this.islocalhost= location.startsWith('http:');\n    this.handler = new RedirectLogin();\n    this.ea.subscribe(HandleLogin, msg => this.handler.handlelogin());\n    this.ea.subscribe(MayLogout, msg => this.handler.maylogout());\n\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 5/24/17.\n */\n\nexport class Clouddeployment {\n}\n","/**\n * Created by Tomas Kulhanek on 1/10/17.\n */\n/**\n * Created by Tomas Kulhanek on 1/5/17.\n */\n\n\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSelected} from './messages';\nimport {Vfstorage} from '../utils/vfstorage';\nimport 'dropbox';\n\n//let client = new HttpClient();\n\nexport class DropboxControl {\n\n  static inject = [EventAggregator];\n\n  constructor(ea){\n    //this.dbx = dropbox;\n    // Parses the url and gets the access token if it is in the urls hash\n    this.ea= ea;\n    this.accesstoken=Vfstorage.parseQueryString(window.location.hash).access_token;\n    this.isAuthenticated = !!this.accesstoken;\n    //console.log('dropboxcontrol() accesstoken:'+this.accesstoken);\n\n    //instantiate dropboxclient - needed for getting URL to redirect\n    this.CLIENTIDENC = \"o\\\"csb%'{{{ze'ya\";\n    try {\n      var Dropbox = require(\"dropbox\");\n      //console.log(mdb)\n      var dbx = new Dropbox({\n        clientId: this.CLIENTIDENC.split('').map(function (c) {\n          return String.fromCharCode(23 ^ c.charCodeAt());\n        }).join(\"\")\n      });\n      var currentUrl = window.location.href;\n      //console.log('dropboxcontrol() current url:' + currentUrl);\n      this.authurl = dbx.getAuthenticationUrl(currentUrl);\n      //console.log('dropboxcontrol() auth url:' + this.authurl);\n      //console.log(this.dropBoxAuthUrl);\n    } catch(e){\n      console.log(\"Dropboxcontrol() exception:\")\n      console.log(e)\n    }\n\n    this.id=\"Dropbox\";\n\n\n  }\n  \n  initialize(){\n    if (this.isAuthenticated) {\n      var settings = {};\n      settings.type=this.id;\n      //settings.alias = this.alias;\n      settings.securetoken = this.accesstoken;\n      //else settings.username = this.username;\n      //if (this.password) settings.securetoken = this.password;\n      this.ea.publish(new SettingsSelected(settings));\n    }\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/5/17.\n */\n//import {HttpClient,json} from 'aurelia-fetch-client';\nimport {ProjectApi} from \"../components/projectapi\";\nimport {computedFrom} from 'aurelia-framework';\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSubmitted} from './messages';\nimport {DropboxControl} from './dropboxcontrol';\nimport {SettingsSelected} from './messages';\nimport {Vfstorage} from \"../utils/vfstorage\";\nimport {Dataitem} from \"../pdbcomponents/dataitem\";\n\nexport class Genericcontrol {\n\n  static inject = [EventAggregator, ProjectApi,DropboxControl];\n\n\n  constructor(ea,pa,dropboxcontrol) {\n    this.heading=\"File Provider\";\n    this.ea= ea;\n    this.dropboxcontrol=dropboxcontrol;\n    this.editing=true;\n    //this.providerspath = \"providers\";\n    this.filespath = \"files\";\n    this.knowtoken=false;\n    this.dropboxauthurl = \"\";\n    this.providers = [];\n    this.selectedProvider=\"\";\n    //this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/\";\n    //console.log('genericcontrol()');\n    //this.client=httpclient;\n    this.pa =pa;\n\n    this.ea.subscribe(SettingsSelected, msg => this.selectSettings(msg.settings) )\n    this.myHeaders = new Headers();\n    this.myHeaders.append('Accept', 'application/json');\n    this.myHeaders.append('Content-Type', 'application/json');\n\n  }\n\n  @computedFrom('selectedProvider')\n  get selectedDropbox() {\n    return this.selectedProvider==this.dropboxcontrol.id;\n  }\n\n  @computedFrom('selectedProvider')\n  get selectedB2Drop() {\n    return this.selectedProvider=='B2Drop';\n  }\n\n  @computedFrom('selectedProvider')\n  get selectedFileSystem() {\n    return this.selectedProvider=='FileSystem';\n  }\n  @computedFrom('selectedProvider')\n  get selectedWebDav() {\n    return this.selectedProvider=='WebDav';\n  }\n\n  @computedFrom('selectedProvider')\n  get selectedOnedata() {\n    return this.selectedProvider=='Onedata';\n  }\n\n  get knowntoken(){\n    if (this.knownSecureToken) return this.knownSecureToken.checked;\n  }\n\n  clear(){\n    this.selectedProvider=\"\";\n    this.username=\"\";\n    this.securetoken=\"\";\n    this.filesystempath=\"\";\n    this.alias=\"\";\n    this.accessurl=\"\";\n  }\n\n  attached() {\n    //console.log('genericcontrol.attached()');\n    //console.log(\"dialogstate:\"+this.dialogstate);\n    //attach parent with the instance\n    //this.bindingContext.genericcontrol = this;\n    //gets the status of the b2drop connection\n    this.dropboxauthurl = this.dropboxcontrol.authurl;\n    this.pa.getProviders()\n      .then(data=>{\n        if (data) {\n          this.providers = data;\n        }\n      }).catch(error => {\n      //handle 403 unauthorized\n      if (error.statusCode === 403) {\n        //try to login\n        window.location = \"/login?next=\" + window.location.pathname;\n        //window.location =\n      } else {\n        console.log('Error', error);\n        //alert('Sorry, response: ' + error.statusCode + ':' + error.statusText + ' when trying to get: ' + this.serviceurl);\n      }\n    });\n    /*this.client.fetch(this.serviceurl+this.providerspath,{headers:this.myHeaders,credentials:'include'})\n      .then(response => response.json())\n      .then(data=> {\n        //console.log(\"data response\");\n        //console.log(data);\n        if (data) {\n          this.providers = data;\n        }\n      }).catch(error => {\n      //handle 403 unauthorized\n      if (error.statusCode == 403) {\n        //try to login\n        console.log(\"genericcontrol.attached() redirecting\");\n        window.location = \"/login?next=\" + window.location.pathname;\n        //window.location =\n      } else {\n        console.log('Error');\n        console.log(error);\n        //alert('Sorry, response: ' + error.statusCode + ':' + error.statusText + ' when trying to get: ' + this.serviceurl);\n      }\n    });\n    */\n    this.dropboxcontrol.initialize();\n  }\n\n  addProvider() {\n     let settings = {};\n     settings.type=this.selectedProvider;\n     settings.alias = this.alias;\n     if (this.selectedDropbox) settings.securetoken = this.securetoken;\n     if (this.selectedFileSystem) settings.securetoken = this.filesystempath;\n     if (this.selectedB2Drop) {\n       settings.securetoken = this.password;\n       settings.username = this.username;\n     } else if (this.selectedWebDav){\n       settings.accessurl=this.accessurl;\n       settings.securetoken = this.password;\n       settings.username = this.username;\n     } else if (this.selectedOnedata) {\n       // OneProvider host&port\n       settings.accessurl=this.accessurl;\n       // Access token\n       settings.securetoken = this.securetoken;\n     }\n     //console.log(\"addProvider() debug:\",this, this.pa,settings);\n    this.pa.putProvider(settings)\n      .then(data => {\n        //console.log(\"addProvider() data returned\",data);\n        this.ea.publish(new SettingsSubmitted(data));\n        this.clear();\n        \n      })\n      .catch(error => {\n        console.log(error);\n        alert('Sorry. Settings not submitted  at '+this.serviceurl+' error:'+error.response+\" status:\"+error.statusText)\n      });\n    return true;\n  }\n\n  selectSettings(settings){\n    this.selectedProvider=settings.type;\n    this.alias=settings.alias;\n    this.securetoken=settings.securetoken;\n    if (!!this.securetoken) { this.editing=false; this.knownSecureToken.checked=true; }\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 1/6/17.\n */\n//import {HttpClient} from 'aurelia-http-client';\nimport {ProjectApi} from \"../components/projectapi\";\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSubmitted} from './messages';\nimport {Vfstorage} from '../utils/vfstorage';\nimport {Aliastable} from \"./aliastable\";\n\n//let client = new HttpClient();\n\n/**\n * Importprovider component implements workflow to transfer providers from one virtualfodler to another\n */\nexport class Importprovider {\n  static inject = [EventAggregator,ProjectApi];\n\n  constructor(ea,pa){\n    this.importingSettings=false;\n    this.ea=ea;\n    this.publickey = undefined;\n    //this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/files\";\n    //this.client=httpclient;\n    this.pa=pa;\n\n    //this.localsettingservice=Vfstorage.getBaseUrl()+\"/metadataservice/settings\";\n    //receives message from popup window, define as arrow function due to eventlistener\n    this.receiveMessage = event =>\n    {\n      console.log(\"Aliastable() received message:\",event.data);\n      this.confirmSettings(event.data);\n    };\n    this.remoteurl=\"https://portal.west-life.eu/virtualfolder/\";\n  }\n\n  attached() {\n    //adds listener for \n    window.addEventListener(\"message\", this.receiveMessage, false);\n    //1. get public key from this VF instance\n    this.pa.getPublicKey()\n      .then(data => {\n        console.log(\"getPublicKey()\",data);\n        this.publickey = data;\n    })\n    .catch(error => {\n      alert('Sorry error when generating keys for import:' + error.response + \" status:\" + error.statusText)\n    });\n  }\n\n  submitSettings(settings) {\n    this.providers = settings;\n  }\n  \n  importProvider(){\n    //2. open popup window with public key to remote public VC\n    //this.remoteurl= window.prompt(\"Enter URL of West-Life Virtual Volder instance:( https://[yourdomain]/virtualfolder/)\",\"https://portal.west-life.eu/virtualfolder/\");\n    let remotesettingsurl = new URL(this.remoteurl+'syncsettingcomponent.html');\n    let params= {PublicKey:this.publickey};\n    Object.keys(params).forEach(key => remotesettingsurl.searchParams.append(key, params[key]));\n    this.openwindow(remotesettingsurl);\n  }\n\n\n  detached() {\n    window.removeEventListener(\"message\", this.receiveMessage)\n  }\n\n  //opens popup window in defined location\n  openwindow(href) {\n    this.popup=window.open(href, 'newwindow', 'width=640, height=480');\n    return false;\n  }\n\n  confirmSettings(data){\n    //3. popup will return encrypted blob with settings and selected aliases, check aliases with existing one and suggest rename - e.g. automatic one\n    //let message = {EncryptedSettings:data.response,aliases:selectedaliases};\n    this.message = JSON.parse(data);\n    this.conflicts = {oldnames:this.message.aliases,newnames:this.message.aliases};\n    this.aliasestmp = this.message.aliases.split(\";\");\n    this.aliases = this.aliasestmp.map(item => {return {oldname:item,newname:item} });\n    this.importingSettings=true;\n  }\n  \n  importSettings2(){\n    this.importingSettings=false;\n    //console.log(\"importSettings2() aliases:\",this.aliases);\n    \n    this.conflicts = {oldnames:this.aliases.map(item => item.oldname).join(';'),newnames:this.aliases.map(item=>item.newname).join(';')};\n    //console.log(\"importSettings2() conflicts:\",this.conflicts);\n    \n//4. import the encrypted settings into this VF instance\n    //    public class ImportSettings : IReturnVoid\n    //     {\n    //         public string PublicKey{ get; set; }\n    //         public string EncryptedSettings{ get; set; }\n    //         public string ConflictedAliases{ get; set; }\n    //         public string NewNameAliases{ get; set; }        \n    //     }\n    //let conflicts = this.resolveConflicts(message.aliases);    \n    let importmessage = {PublicKey:this.publickey,EncryptedSettings:this.message.EncryptedSettings,ConflictedAliases:this.conflicts.oldnames,NewNameAliases:this.conflicts.newnames};\n    //console.log(\"importSettings\",importmessage);\n    this.pa.putSettings(importmessage)\n    //this.client.put(this.localsettingservice,importmessage)\n      .then(data => {\n        //console.log(\"importSettings2() data:\",data);\n        this.ea.publish(new SettingsSubmitted(data));\n      });\n\n  }\n  \n}\n","import environment from '../environment';\n\n//Configure Bluebird Promises.\nPromise.config({\n  longStackTraces: environment.debug,\n  warnings: {\n    wForgottenReturn: false\n  }\n});\n\nexport function configure(aurelia) {\n  aurelia.use\n    .standardConfiguration()\n    .feature('resources');\n\n  if (environment.debug) {\n    aurelia.use.developmentLogging();\n  }\n\n  if (environment.testing) {\n    aurelia.use.plugin('aurelia-testing');\n  }\n\n  aurelia.start().then(() => aurelia.setRoot());\n}\n","/**\n * Created by Tomas Kulhanek on 1/9/17.\n */\n\nexport class SettingsSubmitted {\n  constructor(settings){\n    this.settings = settings;\n  }\n}\n\nexport class SettingsSelected {\n  constructor(settings){\n    this.settings = settings;\n  }\n}\n\nexport class SettingsRemoved {\n  constructor(settings){\n    this.settings = settings;\n  }\n}\n","/**\n * Created by Tomas Kulhanek on 5/28/17.\n */\nimport {EventAggregator} from 'aurelia-event-aggregator';\nimport {SettingsSubmitted, SettingsSelected} from './messages';\n\n\nexport class Storageprovider {\n  static inject = [EventAggregator];\n\n  constructor(ea) {\n    this.showprovider = false;\n    this.showimport = false;\n    ea.subscribe(SettingsSubmitted, msg => this.submitSettings(msg.settings) )\n    ea.subscribe(SettingsSelected, msg => this.selectSettings(msg.settings) )\n  }\n\n  newProvider(){\n    this.showprovider = true;\n    this.showimport=false;\n  }\n\n  importProvider(){\n    this.showprovider = false;\n    this.showimport=true;\n  }\n\n  submitSettings(settings){\n    //console.log('addProvider: not yet implemented');\n    this.showprovider = false;\n    //get provider info from subcomponent\n  }\n\n  selectSettings(settings){\n    //console.log('addProvider: not yet implemented');\n    this.showprovider = true;\n    //get provider info from subcomponent\n  }\n\n}\n","/**\n * Created by Tomas Kulhanek on 7/21/17.\n */\n//import {HttpClient} from 'aurelia-http-client';\nimport {ProjectApi} from \"../components/projectapi\";\nimport {Vfstorage} from '../utils/vfstorage';\n\n/**\n * taskcontrol component gets available tasks and their status (running/not running)\n * may initiate to start/stop them and shows link to them\n */\nexport class Taskcontrol {\n  static inject = [ProjectApi];\n\n  constructor(pa){\n    //this.serviceurl = Vfstorage.getBaseUrl()+\"/metadataservice/availabletasks\";\n    //this.userprocessurl = Vfstorage.getBaseUrl()+\"/metadataservice/userprocess/\";\n//    this.client=httpclient;\n    this.pa=pa;\n    this.tasks = [];\n    this.descriptions=[];\n    this.descriptions[\"jupyter\"]=\"Jupyter notebook web application instance\";\n    this.descriptions[\"notebook\"]=\"Jupyter notebook web application instance\";\n    this.descriptions[\"lab\"]=\"Jupyter lab web application instance\";\n    this.descriptions[\"scipion\"]=\"Scipion Cryo-em web application instance\";\n  }\n\n  attached() {\n    //gets the status of the b2drop connection\n    this.pa.getTask()\n    //this.client.get(this.serviceurl)\n      .then(data => {\n        if (data) {\n          this.tasks = data;\n          let that=this;\n          this.tasks.forEach(function(task){\n            task.Description = that.descriptions[task.Name] || \"\";\n            task.Updating=false;\n          })\n        }\n      });\n  }\n\n  starttask(task1) {\n    var task = task1;\n    task.Updating=true;\n    this.updatetask(task).then((msg) => {\n      //sleep(2000); //sleep 2 seconds - just that the server has time to reload\n      setTimeout( () => {\n          task.Updating = false;\n          task.Running = true;\n          task.LocalUrl = msg;\n          console.log(\"task.LocalUrl:\" + task.LocalUrl);\n        }, 2000);}\n      )\n    .catch((reason) => {\n        task.Updating=false;\n        console.log('start failed');\n        console.log(reason)\n      })\n  }\n\n  stoptask(task1){\n    var task = task1;\n    task.Updating=true;\n    this.updatetask(task).then((msg) => {\n      //sleep(2000); //sleep 2 seconds - just that the server has time to reload\n      setTimeout( () => {\n        task.Updating = false;\n        task.Running = false;\n      }, 2000)\n    })\n      .catch((reason) => {\n        task.Updating=false;\n        console.log('stop failed');\n        console.log(reason)\n      })\n  }\n\n  updatetask(task){\n    return new Promise((resolve, reject) => {\n      if (task.Running) {//will try to stop\n        this.pa.stopTask(task.Name)\n         //this.client.delete(this.userprocessurl+task.Name)\n           .then(data =>{\n             resolve('Deleted')\n         })\n           .catch(error=>{\n             reject(error)\n           })\n      } else {\n        this.pa.startTask(task.Name)\n         //this.client.post(this.userprocessurl+task.Name)\n           .then(data=>{\n             resolve(data.LocalUrl)\n           }\n         )\n           .catch(error=>{\n             reject(error)\n           })\n      }\n    })\n  }\n\n}\n"],"sourceRoot":"../src"}