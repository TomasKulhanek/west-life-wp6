<html>
<head>

    <!--#include virtual="/heads.html" -->
    <script type="text/javascript" src="https://js.live.net/v7.0/OneDrive.js"></script>

</head>

<body class="w3-container">

<!--#include virtual="/header.html" -->

<script type="text/javascript">
    function launchOneDrivePicker(){
        console.log("launchonedrivepicker()");
        var odOptions = {
            clientId: "11d98a42-4395-4494-8bdc-b5e3e83fe1d1",
            action: "share | download | query",
            multiSelect: true,
            openInNewWindow: true,
            advanced: {},
            success: function(files) { console.log("success"); console.log(files)/* success handler */ },
            cancel: function() { console.log("canceled");/* cancel handler */ },
            error: function(e) { console.log("error"); console.log(e); allert("error accessing ONEDRIVE:"+e.message)/* error handler */ }
        }

        OneDrive.open(odOptions);
    }

    function Step1GetAuthCode(){
        var clientid= "11d98a42-4395-4494-8bdc-b5e3e83fe1d1";
        var scope="onedrive.readwrite offline_access";
        var redirecturi="http://localhost/testonedrive.html";
        $.get( "https://login.live.com/oauth20_authorize.srf?client_id={"+clientid+"}&scope={"+scope+"}&response_type=code&redirect_uri={"+redirecturi+"}",
            function( data ) {
            //$( ".result" ).html( data );
            //alert( "Load was performed." );
        });
    }

</script>
<button onClick="launchOneDrivePicker()">Open from OneDrive</button>
<!-- content -->
<!--#include virtual="/footer.html" -->

</body>
</html>
